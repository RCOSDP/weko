{#
  # This file is part of WEKO3.
  # Copyright (C) 2017 National Institute of Informatics.
  #
  # WEKO3 is free software; you can redistribute it
  # and/or modify it under the terms of the GNU General Public License as
  # published by the Free Software Foundation; either version 2 of the
  # License, or (at your option) any later version.
  #
  # WEKO3 is distributed in the hope that it will be
  # useful, but WITHOUT ANY WARRANTY; without even the implied warranty of
  # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
  # General Public License for more details.
  #
  # You should have received a copy of the GNU General Public License
  # along with WEKO3; if not, write to the
  # Free Software Foundation, Inc., 59 Temple Place, Suite 330, Boston,
  # MA 02111-1307, USA.
  #}
  
  <style>
    table { width: auto; margin: 20px auto; border-collapse: collapse; table-layout: auto; }
    th, td { padding: 10px; border: 1px solid #ccc; text-align: left; vertical-align: top; white-space: nowrap; }
    .checkbox-group { display: flex; flex-wrap: wrap; gap: 10px; }
    .checkbox-group label { width: 22%; }
    .single-checkbox-group label { display: block; }
    .checkbox-label { display: block; margin: 5px 0; }
    .see-more { cursor: pointer; text-decoration: underline; }
    .text-hidden { overflow: hidden; white-space: nowrap; text-overflow: ellipsis; max-width: 200px; display: inline-block; vertical-align: top; }
    .year-group { margin-bottom: 20px; }
    .year-group h3 { background-color: #f5f5f5; padding: 10px; margin: 0; border-bottom: 1px solid #ccc; }
  </style>
  
  <div id="search">
    <div id="search_res">
      <div class="panel panel-default">
        <div role="navigation" style="display: flex; flex-direction: column; width: 300px;">
          <input type="button" id="btn_todo1" value="{{_('アイテム出力')}}" style="margin-bottom: 10px; width: 50%; text-align: left;" />
          <input type="text" style="margin-bottom: 10px; width: 150%; text-align: left;" placeholder="入力してエンターキーを押して検索" />
          <span><strong>{{username}} | {{affiliation}}</strong></span>
        </div>
  
        <div id="search-result-body" class="panel-body">
          <div id="index_item_list">
            <div class="form-inline flow-root">
              <div class="pull-left">
                <div class="form-group">
                  <input type="checkbox" value="すべてチェック" />
                  <a href="javascript:void(0)" class="btn btn-primary">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-folder-plus" viewBox="0 0 16 16">
                      <path d="m.5 3 .04.87a2 2 0 0 0-.342 1.311l.637 7A2 2 0 0 0 2.826 14H9v-1H2.826a1 1 0 0 1-.995-.91l-.637-7A1 1 0 0 1 2.19 4h11.62a1 1 0 0 1 .996 1.09L14.54 8h1.005l.256-2.819A2 2 0 0 0 13.81 3H9.828a2 2 0 0 1-1.414-.586l-.828-.828A2 2 0 0 0 6.172 1H2.5a2 2 0 0 0-2 2m5.672-1a1 1 0 0 1 .707.293L7.586 3H2.19q-.362.002-.683.12L1.5 2.98a1 1 0 0 1 1-.98z" />
                      <path d="M13.5 9a.5.5 0 0 1 .5.5V11h1.5a.5.5 0 1 1 0 1H14v1.5a.5.5 0 1 1-1 0V12h-1.5a.5.5 0 0 1 0-1H13V9.5a.5.5 0 0 1 .5-.5" />
                    </svg>
                  </a>
                </div>
              </div>
  
              <div class="pull-right">
                <div class="form-group">
                  <a href="javascript:void(0)" class="btn btn-primary" id="groupYearicon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-diagram-3" viewBox="0 0 16 16">
                      <path fill-rule="evenodd" d="M6 3.5A1.5 1.5 0 0 1 7.5 2h1A1.5 1.5 0 0 1 10 3.5v1A1.5 1.5 0 0 1 8.5 6v1H14a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-1 0V8h-5v.5a.5.5 0 0 1-1 0V8h-5v.5a.5.5 0 0 1-1 0v-1A.5.5 0 0 1 2 7h5.5V6A1.5 1.5 0 0 1 6 4.5zM8.5 5a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5zM0 11.5A1.5 1.5 0 0 1 1.5 10h1A1.5 1.5 0 0 1 4 11.5v1A1.5 1.5 0 0 1 2.5 14h-1A1.5 1.5 0 0 1 0 12.5zm1.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm4.5.5A1.5 1.5 0 0 1 7.5 10h1a1.5 1.5 0 0 1 1.5 1.5v1A1.5 1.5 0 0 1 8.5 14h-1A1.5 1.5 0 0 1 6 12.5zm1.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm4.5.5a1.5 1.5 0 0 1 1.5-1.5h1a1.5 1.5 0 0 1 1.5 1.5v1a1.5 1.5 0 0 1-1.5 1.5h-1a1.5 1.5 0 0 1-1.5-1.5zm1.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5z" />
                    </svg>
                  </a>
                  <a id="toggleButton" class="btn btn-primary" data-toggle="dropdown" href="javascript:void(0)" aria-expanded="false">{{_('絞込み表示')}}<strong class="caret"></strong></a>
                  <select class="form-control" id="sort_item">
                    <option value="1" selected="selected">{{_('出版年月')}}</option>
                    <option value="2">{{_('タイトル')}}</option>
                    <option value="3">{{_('アクセス数')}}</option>
                    <option value="4">{{_('ダウンロード数')}}</option>
                  </select>
                  <select class="form-control" id="sort_order">
                    <option value="1">asc</option>
                    <option value="2">desc</option>
                  </select>
                  <select class="form-control" id="items_per_page">
                    <option value="2">2</option>
                    <option value="5">5</option>
                    <option value="10">10</option>
                  </select>
                </div>
              </div>
              <div style="clear: both;"></div>
              <div id="content" style="display: none;">
                <div class="row row-4">
                  <div class="panel panel-default">
                    <div class="panel-body">
                      <!-- 保存・リセット結果メッセージ -->
                      <div id="savaResult-success" class="alert alert-success">
                        Successfully saved default conditions.<br>
                        Successfully reset default conditions.
                      </div>
                      <div id="savaResult-fail" class="alert alert-danger">
                        Failed to save default conditions.<br>
                        Failed to reset default conditions.
                      </div>
  
                      <!-- 絞込み条件 -->
                      <div class="container testimonial-group">
                        <div class="row row-4">
                          <table>
                            <tr>
                              <th>リソースタイプ</th>
                              <td>
                                <div class="checkbox-group">
                                  <label><input type="checkbox"> conference paper</label>
                                  <label><input type="checkbox"> data paper</label>
                                  <label><input type="checkbox"> departmental bulletin paper</label>
                                  <label><input type="checkbox"> editorial</label>
                                  <label><input type="checkbox"> journal</label>
                                  <label><input type="checkbox"> journal article</label>
                                  <label><input type="checkbox"> newspaper</label>
                                  <label><input type="checkbox"> review article</label>
                                  <!-- <label><input type="checkbox"> other periodical</label>
                                      <label><input type="checkbox"> software paper</label>
                                      <label><input type="checkbox"> article</label>
                                      <label><input type="checkbox"> book</label>
                                      <label><input type="checkbox"> book part</label>
                                      <label><input type="checkbox"> cartographic material</label>
                                      <label><input type="checkbox"> map</label>
                                      <label><input type="checkbox"> conference output</label>
                                      <label><input type="checkbox"> conference presentation</label>
                                      <label><input type="checkbox"> conference proceedings</label>
                                      <label><input type="checkbox"> conference poster</label>
                                      <label><input type="checkbox"> aggregated data</label>
                                      <label><input type="checkbox"> clinical trial data</label>
                                      <label><input type="checkbox"> compiled data</label>
                                      <label><input type="checkbox"> dataset</label>
                                      <label><input type="checkbox"> encoded data</label>
                                      <label><input type="checkbox"> experimental data</label>
                                      <label><input type="checkbox"> genomic data</label>
                                      <label><input type="checkbox"> geospatial data</label>
                                      <label><input type="checkbox"> laboratory notebook</label>
                                      <label><input type="checkbox"> measurement and test data</label>
                                      <label><input type="checkbox"> observational data</label>
                                      <label><input type="checkbox"> recorded data</label>
                                      <label><input type="checkbox"> simulation data</label>
                                      <label><input type="checkbox"> survey data</label>
                                      <label><input type="checkbox"> image</label>
                                      <label><input type="checkbox"> still image</label>
                                      <label><input type="checkbox"> moving image</label>
                                      <label><input type="checkbox"> video</label>
                                      <label><input type="checkbox"> lecture</label>
                                      <label><input type="checkbox"> design patent</label>
                                      <label><input type="checkbox"> patent</label>
                                      <label><input type="checkbox"> PCT application</label>
                                      <label><input type="checkbox"> plant patent</label>
                                      <label><input type="checkbox"> plant variety protection</label>
                                      <label><input type="checkbox"> software patent</label>
                                      <label><input type="checkbox"> trademark</label>
                                      <label><input type="checkbox"> utility model</label>
                                      <label><input type="checkbox"> report</label>
                                      <label><input type="checkbox"> research report</label>
                                      <label><input type="checkbox"> technical report</label>
                                      <label><input type="checkbox"> policy report</label>
                                      <label><input type="checkbox"> working paper</label>
                                      <label><input type="checkbox"> data management plan</label>
                                      <label><input type="checkbox"> sound</label>
                                      <label><input type="checkbox"> thesis</label>
                                      <label><input type="checkbox"> bachelor thesis</label>
                                      <label><input type="checkbox"> master thesis</label>
                                      <label><input type="checkbox"> doctoral thesis</label>
                                      <label><input type="checkbox"> commentary</label>
                                      <label><input type="checkbox"> design</label>
                                      <label><input type="checkbox"> industrial design</label>
                                      <label><input type="checkbox"> interactive resource</label>
                                      <label><input type="checkbox"> layout design</label>
                                      <label><input type="checkbox"> learning object</label>
                                      <label><input type="checkbox"> manuscript</label>
                                      <label><input type="checkbox"> musical notation</label>
                                      <label><input type="checkbox"> peer review</label>
                                      <label><input type="checkbox"> research proposal</label>
                                      <label><input type="checkbox"> research protocol</label>
                                      <label><input type="checkbox"> software</label>
                                      <label><input type="checkbox"> source code</label>
                                      <label><input type="checkbox"> technical documentation</label>
                                      <label><input type="checkbox"> transcription</label>
                                      <label><input type="checkbox"> workflow</label>
                                      <label><input type="checkbox"> other</label> -->
                                </div>
                              </td>
                            </tr>
                            <tr>
                              <th>査読</th>
                              <td>
                                <label><input type="checkbox" name="reading" value="あり"> あり</label>
                                <label><input type="checkbox" name="reading" value="なし"> なし</label>
                              </td>
                            </tr>
                            <tr>
                              <th>論文への関連</th>
                              <td>
                                <label><input type="checkbox" name="related_to_paper" value="あり"> あり</label>
                                <label><input type="checkbox" name="related_to_paper" value="なし"> なし</label>
                              </td>
                            </tr>
                            <tr>
                              <th>根拠データへの関連</th>
                              <td>
                                <label><input type="checkbox" name="related_to_data" value="あり"> あり</label>
                                <label><input type="checkbox" name="related_to_data" value="なし"> なし</label>
                              </td>
                            </tr>
                            <tr>
                              <th>資金別情報 - 助成機関名</th>
                              <td>
                                <div class="single-checkbox-group">
                                  <label class="checkbox-label">
                                    <input type="checkbox">
                                    <span class="text-hidden">test1test1test1test1test1test1test1test1</span>
                                    <span class="see-more" onclick="showFullText(this)">...see more</span>
                                  </label>
                                  <label class="checkbox-label"><input type="checkbox"> test2test2test2test2</label>
                                  <label class="checkbox-label"><input type="checkbox"> test3test3test3</label>
                                  <label class="checkbox-label">
                                    <input type="checkbox">
                                    <span class="text-hidden">test4test4test4test4test4test4test4test4test4</span>
                                    <span class="see-more" onclick="showFullText(this)">...see more</span>
                                  </label>
                                </div>
                              </td>
                            </tr>
                            <tr>
                              <th>資金別情報 - 研究課題名</th>
                              <td>
                                <div class="single-checkbox-group">
                                  <label class="checkbox-label">
                                    <input type="checkbox">
                                    <span class="text-hidden">test1test1test1test1test1test1</span>
                                    <span class="see-more" onclick="showFullText(this)">...see more</span>
                                  </label>
                                  <label class="checkbox-label"><input type="checkbox"> test2test2test2test2</label>
                                  <label class="checkbox-label"><input type="checkbox"> test3test3test3</label>
                                  <label class="checkbox-label">
                                    <input type="checkbox">
                                    <span class="text-hidden">test4test4test4test4test4test4test4test4test4</span>
                                    <span class="see-more" onclick="showFullText(this)">...see more</span>
                                  </label>
                                </div>
                              </td>
                            </tr>
                            <tr>
                              <th>本文ファイル</th>
                              <td>
                                <label><input type="checkbox" name="file_present" value="あり"> あり</label>
                                <label><input type="checkbox" name="file_present" value="なし"> なし</label>
                              </td>
                            </tr>
                            <tr>
                              <th>お気に入り</th>
                              <td>
                                <label><input type="checkbox" name="file_present" value="あり"> あり</label>
                                <label><input type="checkbox" name="file_present" value="なし"> なし</label>
                              </td>
                            </tr>
                          </table>
  
                        </div>
                      </div>
  
                      <!-- 絞込みボタン、クリアボタン、保存ボタン、リセットボタン -->
                      <div class="col-xs-1 col-xs-offset-3">
                        <button id="detail-search-btn" type="button" class="btn btn-primary"
                          onclick="location.reload();" style="float:right;">
                          <span class="glyphicon glyphicon-search"></span>
                          {{_('絞込')}}&nbsp
                        </button>
                      </div>
                      <div class="col-xs-1">
                        <button id="clear-search-btn" type="button" class="btn btn-default"
                           onclick="location.reload();">
                          <span class="glyphicon glyphicon-remove"></span>
                          {{_('クリア')}}&nbsp
                        </button>
                      </div>
                      <div class="col-xs-1">
                        <button id="clear-search-btn" type="button" class="btn btn-primary"
                           onclick="location.reload();" style="float:right;">
                          <span class="glyphicon glyphicon-save"></span>
                          {{_('保存')}}&nbsp
                        </button>
                      </div>
                      <div class="col-xs-1">
                        <button id="clear-search-btn" type="button" class="btn btn-default"
                           onclick="location.reload();">
                          <span class="glyphicon glyphicon-remove"></span>
                          {{_('リセット')}}&nbsp
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
  
              <div class="panel-group m-top-5">
                <div class="row row-10">
                  <div class="col-xs-12 col-md-12">
                    <div class="panel panel-default panel-default-2">
                      <div class="panel-body" style="display: flex; flex-direction: column; align-items: left;">
                        <div id="itemListContainer">
                          <table class="table table-striped table-bordered" style="table-layout: auto;">
                            {% for workspaceitem in workspaceItemList %}
                            <tr>
                              <td style="text-align: center; vertical-align: top;">
                                <div class="favorite-mount-point" data-type="1" data-item-recid="{{ workspaceitem.recid }}"
                                  data-favorite-sts="{{ workspaceitem.favoriteSts | tojson }}"></div>
                                <br>
                                <div class="read-mount-point" data-type="2" data-item-recid="{{ workspaceitem.recid }}"
                                  data-read-sts="{{ workspaceitem.readSts | tojson }}"></div>
                                <br>
                                <input type="checkbox" value="" /><br><br>
                              </td>
                              <td style="width: auto;">
                                <strong><a href="/records/{{ workspaceitem.recid }}">{{ workspaceitem.title }} -- recid: {{ workspaceitem.recid}}</a></strong><br><br>
                                {% if workspaceitem.authorlist is not none and workspaceitem.authorlist|length > 0 %}
                                <span>{{ workspaceitem.authorlist | join(', ') }}</span><br><br>
                                {% endif %}
                                <span>{{ workspaceitem.magazineName }}／{{ workspaceitem.conferenceName}}</span><span> </span>
                                <span>{{ workspaceitem.volume }}（{{ workspaceitem.issue }}）</span><span> </span>
                                <span>{{ workspaceitem.funderName }} | {{ workspaceitem.awardTitle }}</span><span> </span>
                                <br><br>
                                <span>{{ workspaceitem.publicationDate }}</span><span> </span>
                                {% if workspaceitem.relation|length > 0 %}
                                <span><a href="javascript:void(0)" class="relatedButton"><strong>関連</strong></a></span><span> </span>
                                {% endif %}
                                {% if workspaceitem.fileSts %}
                                <span>本文ファイル ({{ workspaceitem.fileCnt }})： 公開（{{ workspaceitem.publicCnt }}）、エンバーゴ（{{ workspaceitem.embargoedCnt }}）、 制限公開（{{ workspaceitem.restrictedPublicationCnt }}）</span><span> </span>
                                {% else %}
                                <span>本文ファイル (0)</span><span> </span>
                                {% endif %}
                                <br>
                                <div class="relatedInfo" style="display: none;">
                                  {% for relatedItem in workspaceitem.relation %}
                                  <span>{{ relatedItem.relationType }} {{ relatedItem.relationTitle }}、<a>{{ relatedItem.relationUrl }}</a></span><br>
                                  {% endfor %}
                                </div>
                              </td>
                              <td style="text-align: center; vertical-align: top;">
                                <span><a href="{{workspaceitem.doi}}">DOI</a></span><br><br>
                                <span><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-eye-fill" viewBox="0 0 16 16">
                                    <path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0" />
                                    <path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8m8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7" />
                                  </svg>{{workspaceitem.accessCnt}}</span><br><br>
                                <span><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-file-earmark" viewBox="0 0 16 16">
                                    <path d="M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5zm-3 0A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4.5z" />
                                  </svg>{{workspaceitem.downloadCnt}}</span>
                              </td>
                              <td style="text-align: center; vertical-align: top;">
                                <span style="border: 1px solid #000; padding: 5px; border-radius: 4px;">{{workspaceitem.resourceType}}</span><br><br>
                                <span>{{workspaceitem.itemStatus}}</span><br><br>
                                <span>
                                  {% if workspaceitem.fbEmailSts %}
                                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-envelope" viewBox="0 0 16 16">
                                    <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1zm13 2.383-4.708 2.825L15 11.105zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741M1 11.105l4.708-2.897L1 5.383z" />
                                  </svg>
                                  {% else %}
                                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-envelope-dash" viewBox="0 0 16 16">
                                    <path d="M2 2a2 2 0 0 0-2 2v8.01A2 2 0 0 0 2 14h5.5a.5.5 0 0 0 0-1H2a1 1 0 0 1-.966-.741l5.64-3.471L8 9.583l7-4.2V8.5a.5.5 0 0 0 1 0V4a2 2 0 0 0-2-2zm3.708 6.208L1 11.105V5.383zM1 4.217V4a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v.217l-7 4.2z" />
                                    <path d="M16 12.5a3.5 3.5 0 1 1-7 0 3.5 3.5 0 0 1 7 0m-5.5 0a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 0-1h-3a.5.5 0 0 0-.5.5" />
                                  </svg>
                                  {% endif %}
                                </span><br><br>
                              </td>
                              <td style="text-align: center; vertical-align: top;">
                                <a href="javascript:void(0)" class="edit-item" data-item-id="">
                                  <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
                                    <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z" />
                                    <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z" />
                                  </svg>
                                </a>
                              </td>
                            </tr>
                            {% endfor %}
                          </table>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="text-center">
                  <ul class="pagination"></ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  
    <script>
      const button2 = document.getElementById('toggleButton');
      const content2 = document.getElementById('content');
      button2.addEventListener('click', function () {
        if (content2.classList.contains('expanded')) {
          content2.classList.remove('expanded');
          content2.style.display = 'none';
        } else {
          content2.classList.add('expanded');
          content2.style.display = 'block';
        }
      });
  
      function showFullText(element) {
        const textSpan = element.previousElementSibling;
        if (textSpan.classList.contains('text-hidden')) {
          textSpan.classList.remove('text-hidden');
          element.textContent = '非表示';
        } else {
          textSpan.classList.add('text-hidden');
          element.textContent = '詳細表示';
        }
      }
    </script>