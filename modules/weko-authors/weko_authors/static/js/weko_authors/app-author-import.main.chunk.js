(this["webpackJsonpapp-author-import"]=this["webpackJsonpapp-author-import"]||[]).push([[0],{464:function(e,t,a){},474:function(e,t,a){"use strict";a.r(t);a(241),a(260);var n=a(3),c=a.n(n),r=a(65),s=a.n(r),l=a(16),i=a(31),o=a(47),d=a(48),u=a(50),m=a(49),j=(a(464),a(465),document.getElementById("select").value),b=document.getElementById("import").value,h=document.getElementById("result").value,p=document.getElementById("download").value,x=document.getElementById("no").value,O=document.getElementById("weko_id").value,v=document.getElementById("name").value,f=document.getElementById("select_file").value,g=document.getElementById("selected_file_name").value,_=document.getElementById("next").value,y=document.getElementById("summary").value,k=document.getElementById("total").value,N=document.getElementById("new_creator").value,w=document.getElementById("update_creator").value,I=document.getElementById("delete_creator").value,E=document.getElementById("check_error").value,C=document.getElementById("mail_address").value,S=document.getElementById("check_result").value,P=document.getElementById("start_date").value,B=document.getElementById("end_date").value,T=document.getElementById("status").value,D=document.getElementById("to_do").value,M=document.getElementById("pending").value,R=document.getElementById("success").value,L=document.getElementById("failure").value,U=document.getElementById("register_success").value,Y=document.getElementById("update_success").value,F=document.getElementById("delete_success").value,A=document.getElementById("error").value,J=document.getElementById("warning").value,G=document.getElementById("register").value,H=document.getElementById("update").value,q=document.getElementById("deleted").value,z=document.getElementById("internal_server_error").value,K=document.getElementById("celery_not_run").value,Q=document.getElementById("not_available_error").value,V=document.getElementById("not_available_error_another").value,W=document.getElementById("import_fail_error").value,X=document.getElementById("delete_author_link").value,Z=JSON.parse(document.getElementById("import_authors_entrypoints").value),$=0,ee=1,te=2,ae=[{tab_key:"select",tab_name:j,step:$},{tab_key:"import",tab_name:b,step:ee},{tab_key:"result",tab_name:h,step:te}],ne=0,ce=1,re=2,se=3,le="import_author_task_id",ie=c.a.createContext({}),oe=function(e){return e&&(t=e.map((function(e){var t=e.familyName&&e.firstName?", ":"";return e.familyName+t+e.firstName})))?t.filter((function(e){return null!=e&&""!==e})):[];var t},de=function(e,t,a){var n="object"!==typeof e?JSON.parse(e):e,c="";if(a){var r="";for(var s in n[0])r+=s+"\t";c+=(r=r.slice(0,-1))+"\r\n"}for(var l=0;l<n.length;l++){var i="";for(var o in n[l])i+='"'+n[l][o]+'"\t';c+=(i=i.slice(0,-1))+"\r\n"}if(""!==c){var d=t.replace(/ /g,"_")+".tsv",u=new Blob([c],{type:"text/tsv"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(u,d);else{var m=window.URL.createObjectURL(u),j=document.createElement("a");j.style.display="none",j.href=m,j.download=d,document.body.appendChild(j),j.click(),document.body.removeChild(j),window.URL.revokeObjectURL(m)}}else alert("Invalid data")},ue=a(0),me=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,t,[e])).getLastString=function(e,t){return e.split(t).pop()},a.onChangeFile=function(e){var t=e.target.files[0],n=a.getLastString(e.target.value,"\\");if("tsv"!==a.getLastString(n,"."))return!1;a.setState({fileName:n});var c=new FileReader;c.onload=function(){a.setState({file:c.result})},c.readAsDataURL(t)},a.onCheckImportFile=Object(i.a)(Object(l.a)().mark((function e(){var t,n,c,r,s,i,o,d;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.context,n=t.setImportData,c=t.setErrorMessage,r=a.state,s=r.fileName,i=r.file){e.next=4;break}return e.abrupt("return");case 4:return a.setState({isChecking:!0}),e.prev=5,e.next=8,fetch(Z.check_import_file,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_name:s,file:i})});case 8:return o=e.sent,e.next=11,o.json();case 11:(d=e.sent).error?c(d.error):n(d),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),c(z);case 18:a.setState({isChecking:!1});case 19:case"end":return e.stop()}}),e,null,[[5,15]])}))),a.state={file:null,fileName:"",isChecking:!1},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.fileName,n=t.file,c=t.isChecking,r=this.context.importStatus;return Object(ue.jsx)("div",{className:"col-sm-12",children:Object(ue.jsx)("div",{className:"row",children:Object(ue.jsxs)("div",{className:"col-sm-12",children:[Object(ue.jsxs)("div",{className:"row",children:[Object(ue.jsx)("div",{className:"col-md-2 col-cd",children:Object(ue.jsx)("label",{children:f})}),Object(ue.jsxs)("div",{className:"col-md-8",children:[Object(ue.jsxs)("div",{children:[Object(ue.jsx)("button",{className:"btn btn-primary",disabled:r===re,onClick:function(){e.inputFileElement.click()},children:f}),Object(ue.jsx)("input",{type:"file",className:"hide",ref:function(t){return e.inputFileElement=t},accept:".tsv,.csv",onChange:this.onChangeFile})]}),Object(ue.jsx)("div",{className:"block-placeholder",children:a?Object(ue.jsx)("p",{className:"active",children:a}):Object(ue.jsx)("p",{children:g})})]})]}),Object(ue.jsx)("div",{className:"row",children:Object(ue.jsx)("div",{className:"col-md-2",children:Object(ue.jsxs)("button",{className:"btn btn-primary",disabled:!n||r===re||c,onClick:this.onCheckImportFile,children:[c?Object(ue.jsx)("div",{className:"loading"}):Object(ue.jsx)("span",{className:"glyphicon glyphicon-download-alt icon"}),_]})})})]})})})}}])}(c.a.Component);me.contextType=ie;var je=me,be=(a(467),a(95)),he=a.n(be),pe=(a(468),function(e){function t(){var e;Object(o.a)(this,t);for(var a=arguments.length,n=new Array(a),c=0;c<a;c++)n[c]=arguments[c];return(e=Object(u.a)(this,t,[].concat(n))).handlePageChange=function(){var t=Object(i.a)(Object(l.a)().mark((function t(a){var n,c,r,s,i,o;return Object(l.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.context,c=n.setRecords,r=n.setErrorMessage,s=n.setCurrentPage,a){t.next=3;break}return t.abrupt("return");case 3:return t.prev=3,t.next=6,fetch("".concat(Z.check_pagination,"?page_number=").concat(a),{method:"GET",headers:{"Content-Type":"application/json"}});case 6:return i=t.sent,t.next=9,i.json();case 9:(o=t.sent).error?r(o.error):(s(a),c(o),window.scrollTo(0,0)),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(3),r(z);case 16:case"end":return t.stop()}}),t,null,[[3,13]])})));return function(e){return t.apply(this,arguments)}}(),e.handleDownload=Object(i.a)(Object(l.a)().mark((function t(){var a,n,c,r,s,i,o;return Object(l.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.context,n=a.setErrorMessage,c=a.maxPage,t.prev=1,t.next=4,fetch(Z.check_file_download,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({max_page:c})});case 4:if(!(r=t.sent).ok){t.next=15;break}return t.next=8,r.blob();case 8:s=t.sent,i=window.URL.createObjectURL(s),(o=document.createElement("a")).href=i,o.download="Creator_Check_"+he()().format("YYYYMMDDhhmm")+".tsv",o.click(),window.URL.revokeObjectURL(i);case 15:t.next=20;break;case 17:t.prev=17,t.t0=t.catch(1),n(z);case 20:case"end":return t.stop()}}),t,null,[[1,17]])}))),e.summaryDataImport=function(e){return{numTotal:e.num_total,numNews:e.num_new,numUpdates:e.num_update,numDeleteds:e.num_delete,numErrors:e.num_error}},e.renderTableItem=function(t){var a=e.context.currentPage;return t.map((function(e,t){return Object(ue.jsxs)("tr",{children:[Object(ue.jsx)("td",{children:t+1+100*(a-1)}),Object(ue.jsx)("td",{children:e.pk_id}),Object(ue.jsx)("td",{children:e.fullname.map((function(e){return Object(ue.jsx)("span",{className:"newline",children:e},t)}))}),Object(ue.jsx)("td",{children:e.emailInfo?e.emailInfo.map((function(e,t){return Object(ue.jsx)("span",{className:"newline",children:e.email},t)})):Object(ue.jsx)(ue.Fragment,{})}),Object(ue.jsxs)("td",{children:[e.errors?e.errors.map((function(e){return Object(ue.jsx)("div",{dangerouslySetInnerHTML:{__html:A+": "+e}})})):"new"===e.status?G:"update"===e.status?H:"deleted"===e.status?q:"",e.warnings&&e.warnings.map((function(e){return Object(ue.jsx)("div",{dangerouslySetInnerHTML:{__html:J+": "+e}})}))]})]},t)}))},e.onImport=Object(i.a)(Object(l.a)().mark((function t(){var a,n,c,r,s,i,o,d,u,m;return Object(l.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.context,n=a.setErrorMessage,c=a.setTaskData,r=a.maxPage,s=a.setResultSummary,i="",t.prev=2,o=localStorage.getItem(le),t.next=6,fetch(Z.import,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({group_task_id:o,max_page:r})});case 6:return d=t.sent,t.next=9,d.json();case 9:(u=t.sent).data?(m=u.records,u.data.tasks.forEach((function(e,t){m.forEach((function(e){e.fullname=oe(e.authorNameInfo)})),e.fullname=m[t].fullname,e.type=m[t].status})),s(u.count,0,0,u.count),c(u.data.group_task_id,u.data.tasks)):u.is_available||(i=u.celery_not_run?K:u.continue_data?Q:V),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(2),console.log(t.t0),i=z;case 17:n(i);case 18:case"end":return t.stop()}}),t,null,[[2,13]])}))),e}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.context,t=e.records,a=e.importStatus,n=e.counts,c=e.currentPage,r=e.maxPage,s=this.summaryDataImport(n),l=s.numTotal,i=s.numNews,o=s.numUpdates,d=s.numDeleteds,u=s.numErrors;return Object(ue.jsx)("div",{className:"check-component",children:Object(ue.jsxs)("div",{className:"row",children:[Object(ue.jsx)("div",{className:"col-md-12 text-center",children:Object(ue.jsxs)("button",{className:"btn btn-primary",onClick:this.onImport,disabled:a!==ce,children:[a===re?Object(ue.jsx)("div",{className:"loading"}):Object(ue.jsx)("span",{className:"glyphicon glyphicon-download-alt icon"}),b]})}),Object(ue.jsx)("div",{className:"col-md-12 text-center",children:Object(ue.jsxs)("div",{className:"row block-summary",children:[Object(ue.jsxs)("div",{className:"col-lg-2 col-md-3 col-sm-3",children:[Object(ue.jsx)("h3",{children:Object(ue.jsx)("b",{children:y})}),Object(ue.jsxs)("div",{className:"flex-box",children:[Object(ue.jsxs)("div",{children:[k,":"]}),Object(ue.jsx)("div",{children:l})]}),Object(ue.jsxs)("div",{className:"flex-box",children:[Object(ue.jsxs)("div",{children:[N,":"]}),Object(ue.jsx)("div",{children:i})]}),Object(ue.jsxs)("div",{className:"flex-box",children:[Object(ue.jsxs)("div",{children:[w,":"]}),Object(ue.jsx)("div",{children:o})]}),Object(ue.jsxs)("div",{className:"flex-box",children:[Object(ue.jsxs)("div",{children:[I,":"]}),Object(ue.jsx)("div",{children:d})]}),Object(ue.jsxs)("div",{className:"flex-box",children:[Object(ue.jsxs)("div",{children:[E,":"]}),Object(ue.jsx)("div",{children:u})]})]}),Object(ue.jsx)("div",{className:"col-lg-10 col-md-9 text-align-right",children:Object(ue.jsxs)("button",{className:"btn btn-primary",onClick:this.handleDownload,children:[Object(ue.jsx)("span",{className:"glyphicon glyphicon-cloud-download icon"}),p]})})]})}),Object(ue.jsx)("div",{className:"col-md-12 m-t-20",children:Object(ue.jsxs)("table",{className:"table table-striped table-bordered",children:[Object(ue.jsx)("thead",{children:Object(ue.jsxs)("tr",{children:[Object(ue.jsx)("th",{children:x}),Object(ue.jsx)("th",{children:O}),Object(ue.jsx)("th",{children:Object(ue.jsx)("p",{className:"table-title-170",children:v})}),Object(ue.jsx)("th",{children:Object(ue.jsx)("p",{className:"table-title-170",children:C})}),Object(ue.jsx)("th",{children:Object(ue.jsx)("p",{className:"table-title-100",children:S})})]})}),Object(ue.jsx)("tbody",{children:this.renderTableItem(t)})]})}),Object(ue.jsx)(xe,{currentPage:c,totalPages:r,onPageChange:this.handlePageChange})]})})}}])}(c.a.Component));pe.contextType=ie;var xe=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,t,arguments)}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){for(var e=this.props,t=e.currentPage,a=e.totalPages,n=e.onPageChange,c=[],r=Math.max(1,t-5),s=Math.min(a,t+4),l=r;l<=s;l++)c.push(l);return Object(ue.jsx)("div",{className:"col-sm-12 col-md-12 alignCenter",children:Object(ue.jsxs)("ul",{className:"pagination",children:[Object(ue.jsx)("li",{className:"page-item ".concat(1===t?"disabled":""),children:Object(ue.jsx)("a",{onClick:function(){return n(t-1)},className:"page-link",children:"<"})}),c.map((function(e){return Object(ue.jsx)("li",{className:"page-item ".concat(e===t?"active":""),children:Object(ue.jsx)("a",{onClick:function(){return n(e)},className:"page-link",children:e})},e)})),Object(ue.jsx)("li",{className:"page-item ".concat(t===a?"disabled":""),children:Object(ue.jsx)("a",{onClick:function(){return n(t+1)},className:"page-link",children:">"})})]})})}}])}(c.a.Component),Oe=pe,ve=a(66),fe=function(e){function t(){var e;Object(o.a)(this,t);for(var a=arguments.length,n=new Array(a),c=0;c<a;c++)n[c]=arguments[c];return(e=Object(u.a)(this,t,[].concat(n))).prepareDisplayStatus=function(e,t,a){var n="";switch(e){case"PENDING":n=D;break;case"SUCCESS":n=function(e){var t="";switch(e){case"new":t=U;break;case"update":t=Y;break;case"deleted":t=F}return t}(t);break;case"FAILURE":n=A+": "+("delete_author_link"===a?X:W)}return n},e.handleDownload=Object(i.a)(Object(l.a)().mark((function t(){var a,n,c,r,s,i;return Object(l.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.context.tasks,n=a.map((function(t,a){return Object(ve.a)(Object(ve.a)(Object(ve.a)(Object(ve.a)(Object(ve.a)(Object(ve.a)({},x,a+1),P,t.start_date?t.start_date:""),B,t.end_date?t.end_date:""),O,t.record_id||""),v,t.fullname.join("\n")),T,e.prepareDisplayStatus(t.status,t.type,t.error_id))})),t.prev=2,t.next=5,fetch(Z.result_download,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({json:n})});case 5:if("Dont need to create result file"!==(c=t.sent).Result||!n){t.next=10;break}de(n,"Creator_List_Download_"+he()().format("YYYYDDMM"),!0),t.next=20;break;case 10:if(!c.ok){t.next=20;break}return t.next=13,c.blob();case 13:r=t.sent,s=window.URL.createObjectURL(r),(i=document.createElement("a")).href=s,i.download="Creator_List_Download_"+he()().format("YYYYMMDDhhmm")+".tsv",i.click(),window.URL.revokeObjectURL(s);case 20:t.next=25;break;case 22:t.prev=22,t.t0=t.catch(2),console.log(t.t0);case 25:case"end":return t.stop()}}),t,null,[[2,22]])}))),e.handlePageChange=function(){var t=Object(i.a)(Object(l.a)().mark((function t(a){var n,c,r;return Object(l.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.context,c=n.maxPage,n.setErrorMessage,r=n.setCurrentPage,a){t.next=3;break}return t.abrupt("return");case 3:if(!(a<1||a>c)){t.next=5;break}return t.abrupt("return");case 5:r(a);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.renderTableItem=function(t){var a=e.context.currentPage,n=100*(a-1),c=100*a;return(t=t.slice(n,c)).map((function(t,a){return Object(ue.jsxs)("tr",{children:[Object(ue.jsx)("td",{children:n+a+1}),Object(ue.jsx)("td",{children:t.start_date?t.start_date:""}),Object(ue.jsx)("td",{children:t.end_date?t.end_date:""}),Object(ue.jsx)("td",{children:t.record_id||""}),Object(ue.jsx)("td",{children:t.fullname.map((function(e){return Object(ue.jsx)("span",{className:"newline",children:e},a)}))}),Object(ue.jsx)("td",{children:e.prepareDisplayStatus(t.status,t.type,t.error_id)})]},a)}))},e}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.context,t=e.tasks,a=e.recordNames,n=e.importStatus,c=e.currentPage,r=e.maxPage,s=e.total,l=e.success,i=e.failure,o=e.pending;return Object(ue.jsxs)("div",{className:"result_container row",children:[Object(ue.jsx)("div",{className:"col-md-12 text-center",children:Object(ue.jsxs)("div",{className:"row block-summary",children:[Object(ue.jsxs)("div",{className:"col-lg-2 col-md-3 col-sm-3",children:[Object(ue.jsx)("h3",{children:Object(ue.jsx)("b",{children:y})}),Object(ue.jsxs)("div",{className:"flex-box",children:[Object(ue.jsxs)("div",{children:[k,":"]}),Object(ue.jsx)("div",{children:s})]}),Object(ue.jsxs)("div",{className:"flex-box",children:[Object(ue.jsxs)("div",{children:[R,":"]}),Object(ue.jsx)("div",{children:l})]}),Object(ue.jsxs)("div",{className:"flex-box",children:[Object(ue.jsxs)("div",{children:[L,":"]}),Object(ue.jsx)("div",{children:i})]}),Object(ue.jsxs)("div",{className:"flex-box",children:[Object(ue.jsxs)("div",{children:[M,":"]}),Object(ue.jsx)("div",{children:o})]})]}),Object(ue.jsx)("div",{className:"col-md-12 text-align-right",children:Object(ue.jsxs)("button",{className:"btn btn-primary",onClick:this.handleDownload,disabled:n===re,children:[Object(ue.jsx)("span",{className:"glyphicon glyphicon-cloud-download icon"}),p]})})]})}),Object(ue.jsxs)("div",{className:"col-md-12 m-t-20",children:[Object(ue.jsxs)("table",{className:"table table-striped table-bordered",children:[Object(ue.jsx)("thead",{children:Object(ue.jsxs)("tr",{children:[Object(ue.jsx)("th",{children:x}),Object(ue.jsx)("th",{className:"start_date",children:Object(ue.jsx)("p",{className:"t_head",children:P})}),Object(ue.jsx)("th",{className:"end_date",children:Object(ue.jsx)("p",{className:"t_head ",children:B})}),Object(ue.jsx)("th",{children:O}),Object(ue.jsx)("th",{children:Object(ue.jsx)("p",{className:"table-title-170",children:v})}),Object(ue.jsx)("th",{children:Object(ue.jsx)("p",{className:"table-title-100",children:T})})]})}),Object(ue.jsx)("tbody",{children:this.renderTableItem(t,a)})]}),Object(ue.jsx)(ge,{currentPage:c,totalPages:r,onPageChange:this.handlePageChange})]})]})}}])}(c.a.Component);fe.contextType=ie;var ge=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,t,arguments)}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){for(var e=this.props,t=e.currentPage,a=e.totalPages,n=e.onPageChange,c=[],r=Math.max(1,t-5),s=Math.min(a,t+4),l=r;l<=s;l++)c.push(l);return Object(ue.jsx)("div",{className:"col-sm-12 col-md-12 alignCenter",children:Object(ue.jsxs)("ul",{className:"pagination",children:[Object(ue.jsx)("li",{className:"page-item ".concat(1===t?"disabled":""),children:Object(ue.jsx)("a",{onClick:function(){return n(t-1)},className:"page-link",children:"<"})}),c.map((function(e){return Object(ue.jsx)("li",{className:"page-item ".concat(e===t?"active":""),children:Object(ue.jsx)("a",{onClick:function(){return n(e)},className:"page-link",children:e})},e)})),Object(ue.jsx)("li",{className:"page-item ".concat(t===a?"disabled":""),children:Object(ue.jsx)("a",{onClick:function(){return n(t+1)},className:"page-link",children:">"})})]})})}}])}(c.a.Component),_e=je,ye=Oe,ke=fe,Ne=a(477),we=function(e){var t=e.type,a=void 0===t?"danger":t,n=e.msg,c=void 0===n?"":n,r=e.onClose;return""!==c?Object(ue.jsx)(Ne.a,{variant:a,onClose:r,className:"opacity1",dismissible:!0,children:Object(ue.jsx)("div",{dangerouslySetInnerHTML:{__html:c}})}):""},Ie=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,t,[e])).componentDidMount=function(){a.isImportAvailable()},a.setStep=function(e){a.setState({step:e})},a.setRecords=function(e){e.forEach((function(e){e.fullname=oe(e.authorNameInfo)})),a.setState({records:e})},a.setCurrentPage=function(e){a.setState({currentPage:e})},a.setResultSummary=function(e,t,n,c){a.setState({total:e,success:t,failure:n,pending:c})},a.onChangeTab=function(e){a.state.step>=ae.filter((function(t){return t.tab_key===e}))[0].step&&a.setState({tab:e})},a.setErrorMessage=function(e){a.setState({errorMsg:e})},a.setImportData=function(e){var t=e.counts||{},n=e.max_page,c=(e=e.list_import_data).filter((function(e){return!e.errors||0===e.errors.length})).length>0;e.forEach((function(e){e.fullname=oe(e.authorNameInfo)})),a.setState({tab:"import",records:e,counts:t,maxPage:n,importStatus:c?ce:ne,step:ee,errorMsg:""})},a.setTaskData=function(e,t){localStorage.setItem(le,e),a.setState({tasks:t,tab:"result",step:te,currentPage:1,maxPage:Math.ceil(t.length/100),importStatus:re,task_ids:t.map((function(e){return e.task_id}))}),a.onCheckImportStatus()},a.isImportAvailable=Object(i.a)(Object(l.a)().mark((function e(){var t,n,c,r,s,i;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!1,n="",e.prev=2,c=Z.is_import_available,(r=localStorage.getItem(le))&&(c+="?group_task_id="+r),e.next=8,fetch(c,{method:"GET"});case 8:return s=e.sent,e.next=11,s.json();case 11:(i=e.sent).is_available?t=!0:i.celery_not_run?n=K:i.continue_data?(n=Q,i.continue_data.records.forEach((function(e){e.fullname=oe(e.authorNameInfo)})),i.continue_data.tasks.forEach((function(e,t){e.fullname=i.continue_data.records[t].fullname,e.type=i.continue_data.records[t].status})),a.setState({records:i.continue_data.records}),a.setTaskData(i.continue_data.group_task_id,i.continue_data.tasks)):n=V,e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),console.log(e.t0),n=z;case 19:return a.setErrorMessage(n),e.abrupt("return",t);case 21:case"end":return e.stop()}}),e,null,[[2,15]])}))),a.onCheckImportStatus=Object(i.a)(Object(l.a)().mark((function e(){return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){var t=setInterval(Object(i.a)(Object(l.a)().mark((function n(){var c,r,s,i,o,d,u,m,j,b,h,p,x;return Object(l.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=a.state,r=c.tasks,s=c.task_ids,i=c.total,o="",d=!0,n.prev=3,n.next=6,fetch(Z.check_import_status,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tasks:s})});case 6:return u=n.sent,n.next=9,u.json();case 9:(m=n.sent)?(j=m.tasks,b=j.map((function(e){var t=r.filter((function(t){return t.task_id===e.task_id})),a=!!(t&&t.length>0)&&t[0];return a&&(a.status=e.status,a.start_date=e.start_date,a.end_date=e.end_date,a.error_id=e.error_id,"PENDING"===e.status&&(d=!1)),a})),m.over_max&&("PENDING"===(h=m.over_max.status)?d=!1:"FAILURE"===h&&(o=W)),p=m.summary,x=i-(m.summary.success_count+m.summary.failure_count),a.setResultSummary(i,p.success_count,p.failure_count,x),a.setState({tasks:b,importStatus:d?se:re})):o=z,n.next=17;break;case 13:n.prev=13,n.t0=n.catch(3),console.log(n.t0),o=z;case 17:(o||d)&&(a.setErrorMessage(o),e(!d),clearInterval(t));case 18:case"end":return n.stop()}}),n,null,[[3,13]])}))),1e3)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),a.state={tab:"select",step:$,errorMsg:"",tasks:[],task_ids:[],records:[],counts:{},currentPage:1,maxPage:0,importStatus:ne,isShowMessage:!1,total:0,success:0,failure:0,pending:0,setStep:a.setStep,onChangeTab:a.onChangeTab,setErrorMessage:a.setErrorMessage,isImportAvailable:a.isImportAvailable,setImportData:a.setImportData,setRecords:a.setRecords,setTaskData:a.setTaskData,setCurrentPage:a.setCurrentPage,setResultSummary:a.setResultSummary},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.tab,n=t.errorMsg;return Object(ue.jsxs)(ie.Provider,{value:this.state,children:[Object(ue.jsx)(we,{type:"danger",msg:n,onClose:function(){return e.setState({errorMsg:""})}}),Object(ue.jsx)("div",{className:"row",children:Object(ue.jsxs)("div",{className:"col-sm-12",children:[Object(ue.jsx)("ul",{className:"nav nav-tabs",children:ae.map((function(t,n){return Object(ue.jsx)("li",{className:"".concat(t.tab_key===a?"active":""," nav-item"),onClick:function(){return e.onChangeTab(t.tab_key)},children:Object(ue.jsx)("a",{className:"".concat(t.tab_key===a?"active":""," nav-link cursor-pointer"),children:t.tab_name})},n)}))}),Object(ue.jsxs)("div",{className:"tab-content",children:[Object(ue.jsx)("div",{className:"".concat(a===ae[0].tab_key?"":"hide"),children:Object(ue.jsx)(_e,{})}),Object(ue.jsx)("div",{className:"".concat(a===ae[1].tab_key?"":"hide"),children:Object(ue.jsx)(ye,{})}),Object(ue.jsx)("div",{className:"".concat(a===ae[2].tab_key?"":"hide"),children:Object(ue.jsx)(ke,{})})]})]})})]})}}])}(c.a.Component);s.a.render(Object(ue.jsx)(c.a.StrictMode,{children:Object(ue.jsx)(Ie,{})}),document.getElementById("app-author-import"))}},[[474,1,2]]]);
//# sourceMappingURL=main.54ad2528.chunk.js.map