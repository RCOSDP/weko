GLOB sdist-make: /code/modules/weko-items-ui/setup.py
c1 create: /code/modules/weko-items-ui/.tox/c1
c1 installdeps: pytest>=3, pytest-cov, -rrequirements.txt
c1 inst: /code/modules/weko-items-ui/.tox/.tmp/package/1/weko-items-ui-0.1.0.dev20170000.zip
c1 installed: alabaster==0.7.13,alembic==0.9.6,amqp==2.6.1,angular-gettext-babel==0.3,aniso8601==8.0.0,arrow==0.12.1,asn1crypto==0.23.0,attrs==17.4.0,b2handle==1.1.2,Babel==2.5.1,bagit==1.7.0,beautifulsoup4==4.9.3,bibtexparser==1.0.1,billiard==3.6.3.0,binaryornot==0.4.4,bleach==3.1.0,blinker==1.4,boto3==1.7.84,botocore==1.10.84,cachelib==0.1,cachetools==4.2.4,cchardet==2.1.1,celery==4.4.7,certifi==2017.11.5,cffi==1.11.2,chardet==3.0.4,citeproc-py==0.5.1,citeproc-py-styles==0.1.2,click==8.0.4,cookiecutter==1.6.0,counter-robots==2018.6,coverage==6.2,cryptography==2.1.4,datacite==1.0.1,DateTime==4.9,decorator==4.1.2,defusedxml==0.5.0,dictdiffer==0.7.0,dnspython==2.2.1,docutils==0.18.1,dojson==1.3.2,elasticsearch==6.1.1,elasticsearch-dsl==6.4.0,elementpath==1.0.6,email-validator==1.0.5,entrypoints==0.2.3,feedgen==0.7.0,Flask==1.0.4,Flask-Admin==1.5.3,Flask-Alembic==2.0.1,Flask-Assets==0.12,Flask-BabelEx==0.9.4,Flask-Breadcrumbs==0.5.0,Flask-Caching==1.3.3,Flask-CeleryExt==0.3.4,Flask-Collect==1.2.2,Flask-Cors==3.0.3,Flask-DebugToolbar==0.11.0,Flask-IIIF==0.6.1,Flask-KVSession==0.6.2,Flask-Limiter==1.1.0,Flask-Login==0.4.1,Flask-Mail==0.9.1,flask-marshmallow==0.14.0,Flask-Menu==0.6.0,Flask-OAuthlib==0.9.5,Flask-Plugins==1.6.1,Flask-Principal==0.4.0,Flask-RESTful==0.3.8,Flask-Security==3.0.0,flask-shell-ipython==0.4.1,Flask-Sitemap==0.1.0,Flask-SQLAlchemy==2.3.2,flask-talisman==0.4.1,Flask-WTF==0.14.3,-e git+https://github.com/RCOSDP/pyfpdf.git@f9b032148283d535cabc7789858081c80de36fef#egg=fpdf,frozendict==2.3.6,fs==0.5.4,ftfy==4.4.3,future==0.16.0,github3.py==1.1.0,html5lib==1.0.1,idna==2.6,iiif-prezi==0.3.0,imagesize==1.4.1,importlib-metadata==4.8.3,importlib-resources==5.4.0,infinity==1.4,iniconfig==1.1.1,intervals==0.8.0,invenio-access==1.1.0,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=invenio_accounts&subdirectory=modules/invenio-accounts,invenio-admin==1.1.2,invenio-app==1.1.0,invenio-assets==1.0.0,invenio-base==1.0.2,invenio-cache==1.0.0,invenio-celery==1.1.3,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=invenio_communities&subdirectory=modules/invenio-communities,invenio-config==1.0.0,invenio-csl-rest==1.0.0a1,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=invenio_db&subdirectory=modules/invenio-db,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=invenio_deposit&subdirectory=modules/invenio-deposit,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=invenio_files_rest&subdirectory=modules/invenio-files-rest,invenio-formatter==1.0.0b3,invenio-i18n==1.0.0,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=invenio_iiif&subdirectory=modules/invenio-iiif,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=invenio_indexer&subdirectory=modules/invenio-indexer,invenio-jsonschemas==1.0.0,invenio-logging==1.0.0b3,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=invenio_mail&subdirectory=modules/invenio-mail,invenio-marc21==1.0.0a8,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=invenio_oaiharvester&subdirectory=modules/invenio-oaiharvester,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=invenio_oaiserver&subdirectory=modules/invenio-oaiserver,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=invenio_oauth2server&subdirectory=modules/invenio-oauth2server,invenio-oauthclient==1.0.0,invenio-pidrelations==1.0.0a4,invenio-pidstore==1.0.0,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=invenio_previewer&subdirectory=modules/invenio-previewer,invenio-query-parser==0.6.0,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=invenio_queues&subdirectory=modules/invenio-queues,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=invenio_records&subdirectory=modules/invenio-records,invenio-records-files==1.0.0a10,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=invenio_records_rest&subdirectory=modules/invenio-records-rest,invenio-records-ui==1.0.0,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=invenio_resourcesyncclient&subdirectory=modules/invenio-resourcesyncclient,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=invenio_resourcesyncserver&subdirectory=modules/invenio-resourcesyncserver,invenio-rest==1.1.2,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=invenio_s3&subdirectory=modules/invenio-s3,invenio-search==1.1.0,invenio-search-ui==1.0.0a9,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=invenio_stats&subdirectory=modules/invenio-stats,invenio-theme==1.0.0b4,ipaddress==1.0.19,ipython==6.2.1,ipython-genutils==0.2.0,itsdangerous==0.24,jedi==0.11.0,Jinja2==2.10,jinja2-cli==0.6.0,jinja2-time==0.2.0,jmespath==0.10.0,jsmin==2.2.2,jsonpatch==1.21,jsonpath-ng==1.5.2,jsonpointer==1.14,jsonref==0.1,jsonresolver==0.2.1,jsonschema==2.6.0,jupyter-client==5.2.2,jupyter-core==4.4.0,kombu==4.6.10,limits==1.2.1,lxml==4.1.1,Mako==1.0.7,MarkupSafe==1.1.1,marshmallow==2.20.1,marshmallow-sqlalchemy==0.23.1,maxminddb==1.5.2,maxminddb-geolite2==2017.803,mistune==0.8.3,mock==3.0.5,more-itertools==8.10.0,msgpack==0.6.2,nbconvert==5.3.1,nbformat==4.4.0,netaddr==0.8.0,node-semver==0.1.1,numpy==1.16.1,oauthlib==2.1.0,ordereddict==1.1,packaging==21.3,pandocfilters==1.4.2,parso==0.1.0,passlib==1.7.1,pexpect==4.3.0,pickleshare==0.7.4,Pillow==5.4.1,pluggy==0.13.1,ply==3.11,poyo==0.4.1,prompt-toolkit==1.0.15,psycopg2==2.7.3.2,ptyprocess==0.5.2,py==1.11.0,pycparser==2.18,Pygments==2.2.0,PyJWT==1.5.3,PyLD==2.0.3,pyparsing==3.0.9,-e git+https://github.com/RCOSDP/PyPDF2.git@fefc684a3a74aff6f99e5dff24f9b4dd1c95169d#egg=PyPDF2,pyPEG2==2.15.2,pytest==6.1.2,pytest-cov==4.0.0,pytest-mock==3.6.1,python-dateutil==2.6.1,python-editor==1.0.3,python-geoip==1.2,pytz==2017.3,pyzmq==17.0.0,redis==2.10.6,requests==2.18.4,requests-oauthlib==1.1.0,resync==1.0.9,s3fs==0.1.6,s3transfer==0.1.13,Sickle==0.6.4,simplegeneric==0.8.1,simplejson==3.12.0,simplekv==0.11.2,six==1.12.0,snowballstemmer==2.2.0,soupsieve==2.3.2.post1,speaklater==1.3,Sphinx==1.8.4,sphinxcontrib-serializinghtml==1.1.5,sphinxcontrib-websupport==1.2.4,SQLAlchemy==1.2.19,SQLAlchemy-Continuum==1.3.6,SQLAlchemy-Utils==0.35.0,testpath==0.3.1,toml==0.10.2,tomli==1.2.3,tornado==4.5.3,traitlets==4.3.2,typing_extensions==4.1.1,ua-parser==0.7.3,uritemplate==4.1.1,uritools==2.1.0,urllib3==1.22,validators==0.12.0,vine==1.3.0,Wand==0.6.1,wcwidth==0.1.7,webargs==5.5.2,webassets==0.12.1,webencodings==0.5.1,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=weko_accounts&subdirectory=modules/weko-accounts,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=weko_admin&subdirectory=modules/weko-admin,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=weko_authors&subdirectory=modules/weko-authors,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=weko_bulkupdate&subdirectory=modules/weko-bulkupdate,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=weko_deposit&subdirectory=modules/weko-deposit,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=weko_gridlayout&subdirectory=modules/weko-gridlayout,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=weko_groups&subdirectory=modules/weko-groups,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=weko_handle&subdirectory=modules/weko-handle,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=weko_index_tree&subdirectory=modules/weko-index-tree,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=weko_indextree_journal&subdirectory=modules/weko-indextree-journal,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=weko_items_autofill&subdirectory=modules/weko-items-autofill,weko-items-ui @ file:///code/modules/weko-items-ui/.tox/.tmp/package/1/weko-items-ui-0.1.0.dev20170000.zip,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=weko_itemtypes_ui&subdirectory=modules/weko-itemtypes-ui,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=weko_logging&subdirectory=modules/weko-logging,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=weko_records&subdirectory=modules/weko-records,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=weko_records_ui&subdirectory=modules/weko-records-ui,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=weko_redis&subdirectory=modules/weko-redis,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=weko_schema_ui&subdirectory=modules/weko-schema-ui,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=weko_search_ui&subdirectory=modules/weko-search-ui,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=weko_sitemap&subdirectory=modules/weko-sitemap,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=weko_theme&subdirectory=modules/weko-theme,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=weko_user_profiles&subdirectory=modules/weko-user-profiles,-e git+https://github.com/RCOSDP/weko.git@76430b4c7fb0c43f0e7c651235e280a7adbcc333#egg=weko_workflow&subdirectory=modules/weko-workflow,Werkzeug==0.15.2,whichcraft==0.4.1,WTForms==2.1,WTForms-Alchemy==0.16.5,WTForms-Components==0.10.3,xmlschema==0.9.30,xmltodict==0.12.0,zipp==3.6.0,zope.interface==5.5.2
c1 run-test-pre: PYTHONHASHSEED='1818791073'
c1 run-test: commands[0] | pytest --cov=weko_items_ui tests -v --cov-branch --cov-report=xml --cov-report=term --basetemp=/code/modules/weko-items-ui/.tox/c1/tmp
============================= test session starts ==============================
platform linux -- Python 3.6.15, pytest-6.1.2, py-1.11.0, pluggy-0.13.1 -- /code/modules/weko-items-ui/.tox/c1/bin/python
cachedir: .tox/c1/.pytest_cache
rootdir: /code/modules/weko-items-ui
plugins: cov-4.0.0, celery-4.4.7, mock-3.6.1
collecting ... collected 285 items

tests/test_api.py::test_item_login PASSED                                [  0%]
tests/test_permissions.py::test_edit_permission_factory PASSED           [  0%]
tests/test_utils.py::test_get_list_username PASSED                       [  1%]
tests/test_utils.py::test_get_list_email PASSED                          [  1%]
tests/test_utils.py::test_get_user_info_by_username PASSED               [  1%]
tests/test_utils.py::test_get_user_info_by_username_nouser PASSED        [  2%]
tests/test_utils.py::test_get_user_info_by_username_exception PASSED     [  2%]
tests/test_utils.py::test_validate_user PASSED                           [  2%]
tests/test_utils.py::test_validate_user_nodb PASSED                      [  3%]
tests/test_utils.py::test_get_user_info_by_email PASSED                  [  3%]
tests/test_utils.py::test_get_user_info_by_email_nodb PASSED             [  3%]
tests/test_utils.py::test_get_user_information PASSED                    [  4%]
tests/test_utils.py::test_get_user_information_nodb PASSED               [  4%]
tests/test_utils.py::test_get_user_permission PASSED                     [  4%]
tests/test_utils.py::test_get_current_user PASSED                        [  5%]
tests/test_utils.py::test_find_hidden_items PASSED                       [  5%]
tests/test_utils.py::test_get_permission_record PASSED                   [  5%]
tests/test_utils.py::test_parse_ranking_results PASSED                   [  6%]
tests/test_utils.py::test_parse_ranking_new_items PASSED                 [  6%]
tests/test_utils.py::test_parse_ranking_record PASSED                    [  7%]
tests/test_utils.py::test_validate_form_input_data PASSED                [  7%]
tests/test_utils.py::test_parse_node_str_to_json_schema PASSED           [  7%]
tests/test_utils.py::test_update_json_schema_with_required_items PASSED  [  8%]
tests/test_utils.py::test_update_json_schema_by_activity_id FAILED       [  8%]
tests/test_utils.py::test_update_schema_form_by_activity_id FAILED       [  8%]
tests/test_utils.py::test_recursive_prepare_either_required_list PASSED  [  9%]
tests/test_utils.py::test_recursive_update_schema_form_with_condition PASSED [  9%]
tests/test_utils.py::test_package_export_file PASSED                     [  9%]
tests/test_utils.py::test_make_stats_file FAILED                         [ 10%]
tests/test_utils.py::test_make_stats_file_issue33432 FAILED              [ 10%]
tests/test_utils.py::test_make_stats_file_issue36234 PASSED              [ 10%]
tests/test_utils.py::test_get_list_file_by_record_id ERROR               [ 11%]
tests/test_utils.py::test_write_bibtex_files FAILED                      [ 11%]
tests/test_utils.py::test_write_files PASSED                             [ 11%]
tests/test_utils.py::test_check_item_type_name PASSED                    [ 12%]
tests/test_utils.py::test_export_items PASSED                            [ 12%]
tests/test_utils.py::test_export_items_issue32943 PASSED                 [ 12%]
tests/test_utils.py::test__get_max_export_items PASSED                   [ 13%]
tests/test_utils.py::test__export_item PASSED                            [ 13%]
tests/test_utils.py::test__custom_export_metadata PASSED                 [ 14%]
tests/test_utils.py::test_get_new_items_by_date FAILED                   [ 14%]
tests/test_utils.py::test_update_schema_remove_hidden_item FAILED        [ 14%]
tests/test_utils.py::test_get_files_from_metadata PASSED                 [ 15%]
tests/test_utils.py::test_to_files_js PASSED                             [ 15%]
tests/test_utils.py::test_update_sub_items_by_user_role PASSED           [ 15%]
tests/test_utils.py::test_remove_excluded_items_in_json_schema PASSED    [ 16%]
tests/test_utils.py::test_get_excluded_sub_items PASSED                  [ 16%]
tests/test_utils.py::test_get_current_user_role PASSED                   [ 16%]
tests/test_utils.py::test_is_need_to_show_agreement_page[0-True] PASSED  [ 17%]
tests/test_utils.py::test_is_need_to_show_agreement_page[1-True] PASSED  [ 17%]
tests/test_utils.py::test_is_need_to_show_agreement_page[2-True] PASSED  [ 17%]
tests/test_utils.py::test_is_need_to_show_agreement_page[3-True] PASSED  [ 18%]
tests/test_utils.py::test_is_need_to_show_agreement_page[4-True] PASSED  [ 18%]
tests/test_utils.py::test_is_need_to_show_agreement_page[5-True] PASSED  [ 18%]
tests/test_utils.py::test_is_need_to_show_agreement_page[6-True] PASSED  [ 19%]
tests/test_utils.py::test_is_need_to_show_agreement_page[7-True] PASSED  [ 19%]
tests/test_utils.py::test_update_index_tree_for_record ERROR             [ 20%]
tests/test_utils.py::test_validate_user_mail PASSED                      [ 20%]
tests/test_utils.py::test_check_approval_email PASSED                    [ 20%]
tests/test_utils.py::test_check_approval_email_in_flow PASSED            [ 21%]
tests/test_utils.py::test_update_action_handler PASSED                   [ 21%]
tests/test_utils.py::test_validate_user_mail_and_index PASSED            [ 21%]
tests/test_utils.py::test_recursive_form PASSED                          [ 22%]
tests/test_utils.py::test_set_multi_language_name PASSED                 [ 22%]
tests/test_utils.py::test_get_data_authors_prefix_settings PASSED        [ 22%]
tests/test_utils.py::test_get_data_authors_affiliation_settings PASSED   [ 23%]
tests/test_utils.py::test_hide_meta_data_for_role[0-True] PASSED         [ 23%]
tests/test_utils.py::test_hide_meta_data_for_role[1-False] PASSED        [ 23%]
tests/test_utils.py::test_hide_meta_data_for_role[2-False] PASSED        [ 24%]
tests/test_utils.py::test_hide_meta_data_for_role[3-False] PASSED        [ 24%]
tests/test_utils.py::test_hide_meta_data_for_role[4-False] PASSED        [ 24%]
tests/test_utils.py::test_hide_meta_data_for_role[5-True] PASSED         [ 25%]
tests/test_utils.py::test_hide_meta_data_for_role[6-False] PASSED        [ 25%]
tests/test_utils.py::test_hide_meta_data_for_role[7-True] PASSED         [ 25%]
tests/test_utils.py::test_get_ignore_item_from_mapping PASSED            [ 26%]
tests/test_utils.py::test_get_mapping_name_item_type_by_key PASSED       [ 26%]
tests/test_utils.py::test_get_mapping_name_item_type_by_sub_key PASSED   [ 27%]
tests/test_utils.py::test_get_hide_list_by_schema_form PASSED            [ 27%]
tests/test_utils.py::test_get_hide_parent_keys PASSED                    [ 27%]
tests/test_utils.py::test_get_hide_parent_and_sub_keys PASSED            [ 28%]
tests/test_utils.py::test_get_item_from_option PASSED                    [ 28%]
tests/test_utils.py::test_get_options_list PASSED                        [ 28%]
tests/test_utils.py::test_get_options_and_order_list PASSED              [ 29%]
tests/test_utils.py::test_hide_table_row PASSED                          [ 29%]
tests/test_utils.py::test_is_schema_include_key PASSED                   [ 29%]
tests/test_utils.py::test_isExistKeyInDict PASSED                        [ 30%]
tests/test_utils.py::test_set_validation_message PASSED                  [ 30%]
tests/test_utils.py::test_translate_validation_message PASSED            [ 30%]
tests/test_utils.py::test_get_workflow_by_item_type_id PASSED            [ 31%]
tests/test_utils.py::test_validate_bibtex FAILED                         [ 31%]
tests/test_utils.py::test_make_bibtex_data FAILED                        [ 31%]
tests/test_utils.py::test_translate_schema_form PASSED                   [ 32%]
tests/test_utils.py::test_get_ranking FAILED                             [ 32%]
tests/test_utils.py::test___sanitize_string PASSED                       [ 32%]
tests/test_utils.py::test_sanitize_input_data PASSED                     [ 33%]
tests/test_utils.py::test_save_title PASSED                              [ 33%]
tests/test_utils.py::test_get_key_title_in_item_type_mapping PASSED      [ 34%]
tests/test_utils.py::test_get_title_in_request PASSED                    [ 34%]
tests/test_utils.py::test_hide_form_items PASSED                         [ 34%]
tests/test_utils.py::test_hide_thumbnail PASSED                          [ 35%]
tests/test_utils.py::test_get_ignore_item PASSED                         [ 35%]
tests/test_utils.py::test_make_stats_file_with_permission FAILED         [ 35%]
tests/test_utils.py::test_make_stats_file_with_permission_issue33432 FAILED [ 36%]
tests/test_utils.py::test_check_item_is_being_edit PASSED                [ 36%]
tests/test_utils.py::test_check_item_is_deleted PASSED                   [ 36%]
tests/test_utils.py::test_permission_ranking PASSED                      [ 37%]
tests/test_utils.py::test_has_permission_edit_item PASSED                [ 37%]
tests/test_utils.py::test_has_permission_edit_item2 PASSED               [ 37%]
tests/test_utils.py::test_has_permission_edit_item3 PASSED               [ 38%]
tests/test_views.py::test_index_acl_nologin PASSED                       [ 38%]
tests/test_views.py::test_index_acl[0-302] PASSED                        [ 38%]
tests/test_views.py::test_index_acl[1-302] PASSED                        [ 39%]
tests/test_views.py::test_index_acl[2-302] PASSED                        [ 39%]
tests/test_views.py::test_index_acl[3-302] PASSED                        [ 40%]
tests/test_views.py::test_index_acl[4-403] PASSED                        [ 40%]
tests/test_views.py::test_index_acl[5-403] PASSED                        [ 40%]
tests/test_views.py::test_index_acl[6-302] PASSED                        [ 41%]
tests/test_views.py::test_index_acl[7-403] PASSED                        [ 41%]
tests/test_views.py::test_index[0-200] PASSED                            [ 41%]
tests/test_views.py::test_index_noitemtype PASSED                        [ 42%]
tests/test_views.py::test_index_exception PASSED                         [ 42%]
tests/test_views.py::test_iframe_index_acl_nologin PASSED                [ 42%]
tests/test_views.py::test_iframe_index_acl[0-200] PASSED                 [ 43%]
tests/test_views.py::test_iframe_index_acl[1-200] PASSED                 [ 43%]
tests/test_views.py::test_iframe_index_acl[2-200] PASSED                 [ 43%]
tests/test_views.py::test_iframe_index_acl[3-200] PASSED                 [ 44%]
tests/test_views.py::test_iframe_index_acl[4-403] PASSED                 [ 44%]
tests/test_views.py::test_iframe_index_acl[5-403] PASSED                 [ 44%]
tests/test_views.py::test_iframe_index_acl[6-200] PASSED                 [ 45%]
tests/test_views.py::test_iframe_index_acl[7-403] PASSED                 [ 45%]
tests/test_views.py::test_iframe_index_noitemtypeid[0-404] PASSED        [ 45%]
tests/test_views.py::test_iframe_index[0-200] PASSED                     [ 46%]
tests/test_views.py::test_iframe_index_exception PASSED                  [ 46%]
tests/test_views.py::test_iframe_save_model_nologin PASSED               [ 47%]
tests/test_views.py::test_iframe_save_model_acl[0-200] PASSED            [ 47%]
tests/test_views.py::test_iframe_save_model_acl[1-200] PASSED            [ 47%]
tests/test_views.py::test_iframe_save_model_acl[2-200] PASSED            [ 48%]
tests/test_views.py::test_iframe_save_model_acl[3-200] PASSED            [ 48%]
tests/test_views.py::test_iframe_save_model_acl[4-200] PASSED            [ 48%]
tests/test_views.py::test_iframe_save_model_acl[5-200] PASSED            [ 49%]
tests/test_views.py::test_iframe_save_model_acl[6-200] PASSED            [ 49%]
tests/test_views.py::test_iframe_save_model_acl[7-200] PASSED            [ 49%]
tests/test_views.py::test_iframe_save_model_error[0-200] PASSED          [ 50%]
tests/test_views.py::test_iframe_save_model[0-200] PASSED                [ 50%]
tests/test_views.py::test_iframe_success PASSED                          [ 50%]
tests/test_views.py::test_iframe_error PASSED                            [ 51%]
tests/test_views.py::test_get_json_schema_acl_nologin PASSED             [ 51%]
tests/test_views.py::test_get_json_schema_acl[0-200] PASSED              [ 51%]
tests/test_views.py::test_get_json_schema_acl[1-200] PASSED              [ 52%]
tests/test_views.py::test_get_json_schema_acl[2-200] PASSED              [ 52%]
tests/test_views.py::test_get_json_schema_acl[3-200] PASSED              [ 52%]
tests/test_views.py::test_get_json_schema_acl[4-200] PASSED              [ 53%]
tests/test_views.py::test_get_json_schema_acl[5-200] PASSED              [ 53%]
tests/test_views.py::test_get_json_schema_acl[6-200] PASSED              [ 54%]
tests/test_views.py::test_get_json_schema_acl[7-200] PASSED              [ 54%]
tests/test_views.py::test_get_json_schema[0-200] FAILED                  [ 54%]
tests/test_views.py::test_get_schema_form_acl_nologin PASSED             [ 55%]
tests/test_views.py::test_get_schema_form_acl[0-200] PASSED              [ 55%]
tests/test_views.py::test_get_schema_form_acl[1-200] PASSED              [ 55%]
tests/test_views.py::test_get_schema_form_acl[2-200] PASSED              [ 56%]
tests/test_views.py::test_get_schema_form_acl[3-200] PASSED              [ 56%]
tests/test_views.py::test_get_schema_form_acl[4-200] PASSED              [ 56%]
tests/test_views.py::test_get_schema_form_acl[5-200] PASSED              [ 57%]
tests/test_views.py::test_get_schema_form_acl[6-200] PASSED              [ 57%]
tests/test_views.py::test_get_schema_form_acl[7-200] PASSED              [ 57%]
tests/test_views.py::test_get_schema_form[0-200] PASSED                  [ 58%]
tests/test_views.py::test_items_index_acl_nologin PASSED                 [ 58%]
tests/test_views.py::test_items_index_acl[0-200] PASSED                  [ 58%]
tests/test_views.py::test_items_index_acl[1-200] PASSED                  [ 59%]
tests/test_views.py::test_items_index_acl[2-200] PASSED                  [ 59%]
tests/test_views.py::test_items_index_acl[3-200] PASSED                  [ 60%]
tests/test_views.py::test_items_index_acl[4-403] PASSED                  [ 60%]
tests/test_views.py::test_items_index_acl[5-403] PASSED                  [ 60%]
tests/test_views.py::test_items_index_acl[6-200] PASSED                  [ 61%]
tests/test_views.py::test_items_index_acl[7-403] PASSED                  [ 61%]
tests/test_views.py::test_iframe_items_index_acl_nologin PASSED          [ 61%]
tests/test_views.py::test_iframe_items_index_acl[0-302] PASSED           [ 62%]
tests/test_views.py::test_iframe_items_index_acl[1-302] PASSED           [ 62%]
tests/test_views.py::test_iframe_items_index_acl[2-302] PASSED           [ 62%]
tests/test_views.py::test_iframe_items_index_acl[3-302] PASSED           [ 63%]
tests/test_views.py::test_iframe_items_index_acl[4-302] PASSED           [ 63%]
tests/test_views.py::test_iframe_items_index_acl[5-302] PASSED           [ 63%]
tests/test_views.py::test_iframe_items_index_acl[6-302] PASSED           [ 64%]
tests/test_views.py::test_iframe_items_index_acl[7-302] PASSED           [ 64%]
tests/test_views.py::test_test_iframe_items_index PASSED                 [ 64%]
tests/test_views.py::test_default_view_method PASSED                     [ 65%]
tests/test_views.py::test_to_links_js PASSED                             [ 65%]
tests/test_views.py::test_index_upload_acl_nologin PASSED                [ 65%]
tests/test_views.py::test_index_upload_acl[0-200] PASSED                 [ 66%]
tests/test_views.py::test_index_upload_acl[1-200] PASSED                 [ 66%]
tests/test_views.py::test_index_upload_acl[2-200] PASSED                 [ 67%]
tests/test_views.py::test_index_upload_acl[3-200] PASSED                 [ 67%]
tests/test_views.py::test_index_upload_acl[4-200] PASSED                 [ 67%]
tests/test_views.py::test_index_upload_acl[5-200] PASSED                 [ 68%]
tests/test_views.py::test_index_upload_acl[6-200] PASSED                 [ 68%]
tests/test_views.py::test_index_upload_acl[7-200] PASSED                 [ 68%]
tests/test_views.py::test_get_search_data_acl PASSED                     [ 69%]
tests/test_views.py::test_get_search_data PASSED                         [ 69%]
tests/test_views.py::test_validate_user_email_and_index_login[0-200] PASSED [ 69%]
tests/test_views.py::test_validate_user_email_and_index_login[1-200] PASSED [ 70%]
tests/test_views.py::test_validate_user_email_and_index_login[2-200] PASSED [ 70%]
tests/test_views.py::test_validate_user_email_and_index_login[3-200] PASSED [ 70%]
tests/test_views.py::test_validate_user_email_and_index_login[4-200] PASSED [ 71%]
tests/test_views.py::test_validate_user_email_and_index_login[5-200] PASSED [ 71%]
tests/test_views.py::test_validate_user_email_and_index_login[6-200] PASSED [ 71%]
tests/test_views.py::test_validate_user_email_and_index_login[7-200] PASSED [ 72%]
tests/test_views.py::test_validate_user_email_and_index_guest PASSED     [ 72%]
tests/test_views.py::test_validate_user_info_login[0-200] PASSED         [ 72%]
tests/test_views.py::test_validate_user_info_login[1-200] PASSED         [ 73%]
tests/test_views.py::test_validate_user_info_login[2-200] PASSED         [ 73%]
tests/test_views.py::test_validate_user_info_login[3-200] PASSED         [ 74%]
tests/test_views.py::test_validate_user_info_login[4-200] PASSED         [ 74%]
tests/test_views.py::test_validate_user_info_login[5-200] PASSED         [ 74%]
tests/test_views.py::test_validate_user_info_login[6-200] PASSED         [ 75%]
tests/test_views.py::test_validate_user_info_login[7-200] PASSED         [ 75%]
tests/test_views.py::test_validate_user_info_guest PASSED                [ 75%]
tests/test_views.py::test_get_user_info_acl_nologin PASSED               [ 76%]
tests/test_views.py::test_get_user_info_acl[0-200] PASSED                [ 76%]
tests/test_views.py::test_get_user_info_acl[1-200] PASSED                [ 76%]
tests/test_views.py::test_get_user_info_acl[2-200] PASSED                [ 77%]
tests/test_views.py::test_get_user_info_acl[3-200] PASSED                [ 77%]
tests/test_views.py::test_get_user_info_acl[4-200] PASSED                [ 77%]
tests/test_views.py::test_get_user_info_acl[5-200] PASSED                [ 78%]
tests/test_views.py::test_get_user_info_acl[6-200] PASSED                [ 78%]
tests/test_views.py::test_get_user_info_acl[7-200] PASSED                [ 78%]
tests/test_views.py::test_get_current_login_user_id_acl_nologin PASSED   [ 79%]
tests/test_views.py::test_get_current_login_user_id_acl[0-200] PASSED    [ 79%]
tests/test_views.py::test_get_current_login_user_id_acl[1-200] PASSED    [ 80%]
tests/test_views.py::test_get_current_login_user_id_acl[2-200] PASSED    [ 80%]
tests/test_views.py::test_get_current_login_user_id_acl[3-200] PASSED    [ 80%]
tests/test_views.py::test_get_current_login_user_id_acl[4-200] PASSED    [ 81%]
tests/test_views.py::test_get_current_login_user_id_acl[5-200] PASSED    [ 81%]
tests/test_views.py::test_get_current_login_user_id_acl[6-200] PASSED    [ 81%]
tests/test_views.py::test_get_current_login_user_id_acl[7-200] PASSED    [ 82%]
tests/test_views.py::test_prepare_edit_item_login[0-200] PASSED          [ 82%]
tests/test_views.py::test_prepare_edit_item_login[1-200] PASSED          [ 82%]
tests/test_views.py::test_prepare_edit_item_login[2-200] PASSED          [ 83%]
tests/test_views.py::test_prepare_edit_item_login[3-200] PASSED          [ 83%]
tests/test_views.py::test_prepare_edit_item_login[4-200] PASSED          [ 83%]
tests/test_views.py::test_prepare_edit_item_login[5-200] PASSED          [ 84%]
tests/test_views.py::test_prepare_edit_item_login[6-200] PASSED          [ 84%]
tests/test_views.py::test_prepare_edit_item_login[7-200] PASSED          [ 84%]
tests/test_views.py::test_prepare_edit_item_guest PASSED                 [ 85%]
tests/test_views.py::test_ranking_acl_nologin FAILED                     [ 85%]
tests/test_views.py::test_check_ranking_show PASSED                      [ 85%]
tests/test_views.py::test_check_restricted_content_login[0-200] PASSED   [ 86%]
tests/test_views.py::test_check_restricted_content_login[1-200] PASSED   [ 86%]
tests/test_views.py::test_check_restricted_content_login[2-200] PASSED   [ 87%]
tests/test_views.py::test_check_restricted_content_login[3-200] PASSED   [ 87%]
tests/test_views.py::test_check_restricted_content_login[4-200] PASSED   [ 87%]
tests/test_views.py::test_check_restricted_content_login[5-200] PASSED   [ 88%]
tests/test_views.py::test_check_restricted_content_login[6-200] PASSED   [ 88%]
tests/test_views.py::test_check_restricted_content_login[7-200] PASSED   [ 88%]
tests/test_views.py::test_check_restricted_content_guest PASSED          [ 89%]
tests/test_views.py::test_validate_bibtex_export_acl_nologin FAILED      [ 89%]
tests/test_views.py::test_export_acl_nologin PASSED                      [ 89%]
tests/test_views.py::test_validate_login[0-200] PASSED                   [ 90%]
tests/test_views.py::test_validate_login[1-200] PASSED                   [ 90%]
tests/test_views.py::test_validate_login[2-200] PASSED                   [ 90%]
tests/test_views.py::test_validate_login[3-200] PASSED                   [ 91%]
tests/test_views.py::test_validate_login[4-200] PASSED                   [ 91%]
tests/test_views.py::test_validate_login[5-200] PASSED                   [ 91%]
tests/test_views.py::test_validate_login[6-200] PASSED                   [ 92%]
tests/test_views.py::test_validate_login[7-200] PASSED                   [ 92%]
tests/test_views.py::test_validate_guest PASSED                          [ 92%]
tests/test_views.py::test_check_validation_error_msg_acl_nologin PASSED  [ 93%]
tests/test_views.py::test_corresponding_activity_list_acl_nologin PASSED [ 93%]
tests/test_views.py::test_get_authors_prefix_settings_acl_nologin PASSED [ 94%]
tests/test_views.py::test_get_authors_affiliation_settings_acl_nologin PASSED [ 94%]
tests/test_views.py::test_session_validate_acl_nologin PASSED            [ 94%]
tests/test_views.py::test_check_record_doi_acl_nologin PASSED            [ 95%]
tests/test_views.py::test_check_record_doi_indexes_acl_nologin PASSED    [ 95%]
tests/test_views.py::test_check_record_doi_indexes_acl[0-200] PASSED     [ 95%]
tests/test_views.py::test_check_record_doi_indexes_acl[1-200] PASSED     [ 96%]
tests/test_views.py::test_check_record_doi_indexes_acl[2-200] PASSED     [ 96%]
tests/test_views.py::test_check_record_doi_indexes_acl[3-200] PASSED     [ 96%]
tests/test_views.py::test_check_record_doi_indexes_acl[4-200] PASSED     [ 97%]
tests/test_views.py::test_check_record_doi_indexes_acl[5-200] PASSED     [ 97%]
tests/test_views.py::test_check_record_doi_indexes_acl[6-200] PASSED     [ 97%]
tests/test_views.py::test_check_record_doi_indexes_acl[7-200] PASSED     [ 98%]
tests/test_views.py::test_check_record_doi_indexes[0-200] PASSED         [ 98%]
tests/test_weko_items_ui.py::test_version PASSED                         [ 98%]
tests/test_weko_items_ui.py::test_init PASSED                            [ 99%]
tests/test_weko_items_ui.py::test_view PASSED                            [ 99%]
tests/test_weko_items_ui.py::test_prepare_edit_item PASSED               [100%]

==================================== ERRORS ====================================
______________ ERROR at setup of test_get_list_file_by_record_id _______________

self = <urllib3.connection.HTTPConnection object at 0x7fde3d6b76d8>

    def _new_conn(self):
        """ Establish a socket connection and set nodelay settings on it.
    
        :return: New socket connection.
        """
        extra_kw = {}
        if self.source_address:
            extra_kw['source_address'] = self.source_address
    
        if self.socket_options:
            extra_kw['socket_options'] = self.socket_options
    
        try:
            conn = connection.create_connection(
>               (self.host, self.port), self.timeout, **extra_kw)

.tox/c1/lib/python3.6/site-packages/urllib3/connection.py:141: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

address = ('localhost', 9200), timeout = 120, source_address = None
socket_options = [(6, 1, 1)]

    def create_connection(address, timeout=socket._GLOBAL_DEFAULT_TIMEOUT,
                          source_address=None, socket_options=None):
        """Connect to *address* and return the socket object.
    
        Convenience function.  Connect to *address* (a 2-tuple ``(host,
        port)``) and return the socket object.  Passing the optional
        *timeout* parameter will set the timeout on the socket instance
        before attempting to connect.  If no *timeout* is supplied, the
        global default timeout setting returned by :func:`getdefaulttimeout`
        is used.  If *source_address* is set it must be a tuple of (host, port)
        for the socket to bind as a source address before making the connection.
        An host of '' or port 0 tells the OS to use the default.
        """
    
        host, port = address
        if host.startswith('['):
            host = host.strip('[]')
        err = None
    
        # Using the value from allowed_gai_family() in the context of getaddrinfo lets
        # us select whether to work with IPv4 DNS records, IPv6 records, or both.
        # The original create_connection function always returns all records.
        family = allowed_gai_family()
    
        for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
            af, socktype, proto, canonname, sa = res
            sock = None
            try:
                sock = socket.socket(af, socktype, proto)
    
                # If provided, set socket level options before connecting.
                _set_socket_options(sock, socket_options)
    
                if timeout is not socket._GLOBAL_DEFAULT_TIMEOUT:
                    sock.settimeout(timeout)
                if source_address:
                    sock.bind(source_address)
                sock.connect(sa)
                return sock
    
            except socket.error as e:
                err = e
                if sock is not None:
                    sock.close()
                    sock = None
    
        if err is not None:
>           raise err

.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py:83: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

address = ('localhost', 9200), timeout = 120, source_address = None
socket_options = [(6, 1, 1)]

    def create_connection(address, timeout=socket._GLOBAL_DEFAULT_TIMEOUT,
                          source_address=None, socket_options=None):
        """Connect to *address* and return the socket object.
    
        Convenience function.  Connect to *address* (a 2-tuple ``(host,
        port)``) and return the socket object.  Passing the optional
        *timeout* parameter will set the timeout on the socket instance
        before attempting to connect.  If no *timeout* is supplied, the
        global default timeout setting returned by :func:`getdefaulttimeout`
        is used.  If *source_address* is set it must be a tuple of (host, port)
        for the socket to bind as a source address before making the connection.
        An host of '' or port 0 tells the OS to use the default.
        """
    
        host, port = address
        if host.startswith('['):
            host = host.strip('[]')
        err = None
    
        # Using the value from allowed_gai_family() in the context of getaddrinfo lets
        # us select whether to work with IPv4 DNS records, IPv6 records, or both.
        # The original create_connection function always returns all records.
        family = allowed_gai_family()
    
        for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
            af, socktype, proto, canonname, sa = res
            sock = None
            try:
                sock = socket.socket(af, socktype, proto)
    
                # If provided, set socket level options before connecting.
                _set_socket_options(sock, socket_options)
    
                if timeout is not socket._GLOBAL_DEFAULT_TIMEOUT:
                    sock.settimeout(timeout)
                if source_address:
                    sock.bind(source_address)
>               sock.connect(sa)
E               ConnectionRefusedError: [Errno 111] Connection refused

.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py:73: ConnectionRefusedError

During handling of the above exception, another exception occurred:

self = <urllib3.connectionpool.HTTPConnectionPool object at 0x7fde3d7cd128>
method = 'PUT', url = '/test-weko-item-v1.0.0'
body = b'{"settings":{"number_of_shards":1,"number_of_replicas":1,"index.mapping.total_fields.limit":50000,"analysis":{"token...":{"type":"text","index":false,"copy_to":"search_string","fields":{"raw":{"type":"keyword","ignore_above":256}}}}}]}}}'
headers = {'content-type': 'application/json', 'Content-Length': '12354'}
retries = Retry(total=0, connect=None, read=False, redirect=None, status=None)
redirect = False, assert_same_host = False
timeout = <urllib3.util.timeout.Timeout object at 0x7fde3d6b7630>
pool_timeout = None, release_conn = False, chunked = False, body_pos = None
response_kw = {'decode_content': False, 'preload_content': False}, conn = None
release_this_conn = True, err = None, clean_exit = False
timeout_obj = <urllib3.util.timeout.Timeout object at 0x7fde3d6b7240>
is_new_proxy_conn = False

    def urlopen(self, method, url, body=None, headers=None, retries=None,
                redirect=True, assert_same_host=True, timeout=_Default,
                pool_timeout=None, release_conn=None, chunked=False,
                body_pos=None, **response_kw):
        """
        Get a connection from the pool and perform an HTTP request. This is the
        lowest level call for making a request, so you'll need to specify all
        the raw details.
    
        .. note::
    
           More commonly, it's appropriate to use a convenience method provided
           by :class:`.RequestMethods`, such as :meth:`request`.
    
        .. note::
    
           `release_conn` will only behave as expected if
           `preload_content=False` because we want to make
           `preload_content=False` the default behaviour someday soon without
           breaking backwards compatibility.
    
        :param method:
            HTTP request method (such as GET, POST, PUT, etc.)
    
        :param body:
            Data to send in the request body (useful for creating
            POST requests, see HTTPConnectionPool.post_url for
            more convenience).
    
        :param headers:
            Dictionary of custom headers to send, such as User-Agent,
            If-None-Match, etc. If None, pool headers are used. If provided,
            these headers completely replace any pool-specific headers.
    
        :param retries:
            Configure the number of retries to allow before raising a
            :class:`~urllib3.exceptions.MaxRetryError` exception.
    
            Pass ``None`` to retry until you receive a response. Pass a
            :class:`~urllib3.util.retry.Retry` object for fine-grained control
            over different types of retries.
            Pass an integer number to retry connection errors that many times,
            but no other types of errors. Pass zero to never retry.
    
            If ``False``, then retries are disabled and any exception is raised
            immediately. Also, instead of raising a MaxRetryError on redirects,
            the redirect response will be returned.
    
        :type retries: :class:`~urllib3.util.retry.Retry`, False, or an int.
    
        :param redirect:
            If True, automatically handle redirects (status codes 301, 302,
            303, 307, 308). Each redirect counts as a retry. Disabling retries
            will disable redirect, too.
    
        :param assert_same_host:
            If ``True``, will make sure that the host of the pool requests is
            consistent else will raise HostChangedError. When False, you can
            use the pool on an HTTP proxy and request foreign hosts.
    
        :param timeout:
            If specified, overrides the default timeout for this one
            request. It may be a float (in seconds) or an instance of
            :class:`urllib3.util.Timeout`.
    
        :param pool_timeout:
            If set and the pool is set to block=True, then this method will
            block for ``pool_timeout`` seconds and raise EmptyPoolError if no
            connection is available within the time period.
    
        :param release_conn:
            If False, then the urlopen call will not release the connection
            back into the pool once a response is received (but will release if
            you read the entire contents of the response such as when
            `preload_content=True`). This is useful if you're not preloading
            the response's content immediately. You will need to call
            ``r.release_conn()`` on the response ``r`` to return the connection
            back into the pool. If None, it takes the value of
            ``response_kw.get('preload_content', True)``.
    
        :param chunked:
            If True, urllib3 will send the body using chunked transfer
            encoding. Otherwise, urllib3 will send the body using the standard
            content-length form. Defaults to False.
    
        :param int body_pos:
            Position to seek to in file-like body in the event of a retry or
            redirect. Typically this won't need to be set because urllib3 will
            auto-populate the value when needed.
    
        :param \\**response_kw:
            Additional parameters are passed to
            :meth:`urllib3.response.HTTPResponse.from_httplib`
        """
        if headers is None:
            headers = self.headers
    
        if not isinstance(retries, Retry):
            retries = Retry.from_int(retries, redirect=redirect, default=self.retries)
    
        if release_conn is None:
            release_conn = response_kw.get('preload_content', True)
    
        # Check host
        if assert_same_host and not self.is_same_host(url):
            raise HostChangedError(self, url, retries)
    
        conn = None
    
        # Track whether `conn` needs to be released before
        # returning/raising/recursing. Update this variable if necessary, and
        # leave `release_conn` constant throughout the function. That way, if
        # the function recurses, the original value of `release_conn` will be
        # passed down into the recursive call, and its value will be respected.
        #
        # See issue #651 [1] for details.
        #
        # [1] <https://github.com/shazow/urllib3/issues/651>
        release_this_conn = release_conn
    
        # Merge the proxy headers. Only do this in HTTP. We have to copy the
        # headers dict so we can safely change it without those changes being
        # reflected in anyone else's copy.
        if self.scheme == 'http':
            headers = headers.copy()
            headers.update(self.proxy_headers)
    
        # Must keep the exception bound to a separate variable or else Python 3
        # complains about UnboundLocalError.
        err = None
    
        # Keep track of whether we cleanly exited the except block. This
        # ensures we do proper cleanup in finally.
        clean_exit = False
    
        # Rewind body position, if needed. Record current position
        # for future rewinds in the event of a redirect/retry.
        body_pos = set_file_position(body, body_pos)
    
        try:
            # Request a connection from the queue.
            timeout_obj = self._get_timeout(timeout)
            conn = self._get_conn(timeout=pool_timeout)
    
            conn.timeout = timeout_obj.connect_timeout
    
            is_new_proxy_conn = self.proxy is not None and not getattr(conn, 'sock', None)
            if is_new_proxy_conn:
                self._prepare_proxy(conn)
    
            # Make the request on the httplib connection object.
            httplib_response = self._make_request(conn, method, url,
                                                  timeout=timeout_obj,
                                                  body=body, headers=headers,
>                                                 chunked=chunked)

.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py:601: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <urllib3.connectionpool.HTTPConnectionPool object at 0x7fde3d7cd128>
conn = <urllib3.connection.HTTPConnection object at 0x7fde3d6b76d8>
method = 'PUT', url = '/test-weko-item-v1.0.0'
timeout = <urllib3.util.timeout.Timeout object at 0x7fde3d6b7240>
chunked = False
httplib_request_kw = {'body': b'{"settings":{"number_of_shards":1,"number_of_replicas":1,"index.mapping.total_fields.limit":50000,"analysis...pe":"keyword","ignore_above":256}}}}}]}}}', 'headers': {'content-type': 'application/json', 'Content-Length': '12354'}}
timeout_obj = <urllib3.util.timeout.Timeout object at 0x7fde3d6b74a8>

    def _make_request(self, conn, method, url, timeout=_Default, chunked=False,
                      **httplib_request_kw):
        """
        Perform a request on a given urllib connection object taken from our
        pool.
    
        :param conn:
            a connection from one of our connection pools
    
        :param timeout:
            Socket timeout in seconds for the request. This can be a
            float or integer, which will set the same timeout value for
            the socket connect and the socket read, or an instance of
            :class:`urllib3.util.Timeout`, which gives you more fine-grained
            control over your timeouts.
        """
        self.num_requests += 1
    
        timeout_obj = self._get_timeout(timeout)
        timeout_obj.start_connect()
        conn.timeout = timeout_obj.connect_timeout
    
        # Trigger any extra validation we need to do.
        try:
            self._validate_conn(conn)
        except (SocketTimeout, BaseSSLError) as e:
            # Py2 raises this as a BaseSSLError, Py3 raises it as socket timeout.
            self._raise_timeout(err=e, url=url, timeout_value=conn.timeout)
            raise
    
        # conn.request() calls httplib.*.request, not the method in
        # urllib3.request. It also calls makefile (recv) on the socket.
        if chunked:
            conn.request_chunked(method, url, **httplib_request_kw)
        else:
>           conn.request(method, url, **httplib_request_kw)

.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py:357: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <urllib3.connection.HTTPConnection object at 0x7fde3d6b76d8>
method = 'PUT', url = '/test-weko-item-v1.0.0'
body = b'{"settings":{"number_of_shards":1,"number_of_replicas":1,"index.mapping.total_fields.limit":50000,"analysis":{"token...":{"type":"text","index":false,"copy_to":"search_string","fields":{"raw":{"type":"keyword","ignore_above":256}}}}}]}}}'
headers = {'content-type': 'application/json', 'Content-Length': '12354'}

    def request(self, method, url, body=None, headers={}, *,
                encode_chunked=False):
        """Send a complete request to the server."""
>       self._send_request(method, url, body, headers, encode_chunked)

/usr/local/lib/python3.6/http/client.py:1291: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <urllib3.connection.HTTPConnection object at 0x7fde3d6b76d8>
method = 'PUT', url = '/test-weko-item-v1.0.0'
body = b'{"settings":{"number_of_shards":1,"number_of_replicas":1,"index.mapping.total_fields.limit":50000,"analysis":{"token...":{"type":"text","index":false,"copy_to":"search_string","fields":{"raw":{"type":"keyword","ignore_above":256}}}}}]}}}'
headers = {'content-type': 'application/json', 'Content-Length': '12354'}
encode_chunked = False

    def _send_request(self, method, url, body, headers, encode_chunked):
        # Honor explicitly requested Host: and Accept-Encoding: headers.
        header_names = frozenset(k.lower() for k in headers)
        skips = {}
        if 'host' in header_names:
            skips['skip_host'] = 1
        if 'accept-encoding' in header_names:
            skips['skip_accept_encoding'] = 1
    
        self.putrequest(method, url, **skips)
    
        # chunked encoding will happen if HTTP/1.1 is used and either
        # the caller passes encode_chunked=True or the following
        # conditions hold:
        # 1. content-length has not been explicitly set
        # 2. the body is a file or iterable, but not a str or bytes-like
        # 3. Transfer-Encoding has NOT been explicitly set by the caller
    
        if 'content-length' not in header_names:
            # only chunk body if not explicitly set for backwards
            # compatibility, assuming the client code is already handling the
            # chunking
            if 'transfer-encoding' not in header_names:
                # if content-length cannot be automatically determined, fall
                # back to chunked encoding
                encode_chunked = False
                content_length = self._get_content_length(body, method)
                if content_length is None:
                    if body is not None:
                        if self.debuglevel > 0:
                            print('Unable to determine size of %r' % body)
                        encode_chunked = True
                        self.putheader('Transfer-Encoding', 'chunked')
                else:
                    self.putheader('Content-Length', str(content_length))
        else:
            encode_chunked = False
    
        for hdr, value in headers.items():
            self.putheader(hdr, value)
        if isinstance(body, str):
            # RFC 2616 Section 3.7.1 says that text default has a
            # default charset of iso-8859-1.
            body = _encode(body, 'body')
>       self.endheaders(body, encode_chunked=encode_chunked)

/usr/local/lib/python3.6/http/client.py:1337: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <urllib3.connection.HTTPConnection object at 0x7fde3d6b76d8>
message_body = b'{"settings":{"number_of_shards":1,"number_of_replicas":1,"index.mapping.total_fields.limit":50000,"analysis":{"token...":{"type":"text","index":false,"copy_to":"search_string","fields":{"raw":{"type":"keyword","ignore_above":256}}}}}]}}}'

    def endheaders(self, message_body=None, *, encode_chunked=False):
        """Indicate that the last header line has been sent to the server.
    
        This method sends the request to the server.  The optional message_body
        argument can be used to pass a message body associated with the
        request.
        """
        if self.__state == _CS_REQ_STARTED:
            self.__state = _CS_REQ_SENT
        else:
            raise CannotSendHeader()
>       self._send_output(message_body, encode_chunked=encode_chunked)

/usr/local/lib/python3.6/http/client.py:1286: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <urllib3.connection.HTTPConnection object at 0x7fde3d6b76d8>
message_body = b'{"settings":{"number_of_shards":1,"number_of_replicas":1,"index.mapping.total_fields.limit":50000,"analysis":{"token...":{"type":"text","index":false,"copy_to":"search_string","fields":{"raw":{"type":"keyword","ignore_above":256}}}}}]}}}'
encode_chunked = False

    def _send_output(self, message_body=None, encode_chunked=False):
        """Send the currently buffered request and clear the buffer.
    
        Appends an extra \\r\\n to the buffer.
        A message_body may be specified, to be appended to the request.
        """
        self._buffer.extend((b"", b""))
        msg = b"\r\n".join(self._buffer)
        del self._buffer[:]
>       self.send(msg)

/usr/local/lib/python3.6/http/client.py:1046: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <urllib3.connection.HTTPConnection object at 0x7fde3d6b76d8>
data = b'PUT /test-weko-item-v1.0.0 HTTP/1.1\r\nHost: localhost:9200\r\nAccept-Encoding: identity\r\ncontent-type: application/json\r\nContent-Length: 12354\r\n\r\n'

    def send(self, data):
        """Send `data' to the server.
        ``data`` can be a string object, a bytes object, an array object, a
        file-like object that supports a .read() method, or an iterable object.
        """
    
        if self.sock is None:
            if self.auto_open:
>               self.connect()

/usr/local/lib/python3.6/http/client.py:984: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <urllib3.connection.HTTPConnection object at 0x7fde3d6b76d8>

    def connect(self):
>       conn = self._new_conn()

.tox/c1/lib/python3.6/site-packages/urllib3/connection.py:166: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <urllib3.connection.HTTPConnection object at 0x7fde3d6b76d8>

    def _new_conn(self):
        """ Establish a socket connection and set nodelay settings on it.
    
        :return: New socket connection.
        """
        extra_kw = {}
        if self.source_address:
            extra_kw['source_address'] = self.source_address
    
        if self.socket_options:
            extra_kw['socket_options'] = self.socket_options
    
        try:
            conn = connection.create_connection(
                (self.host, self.port), self.timeout, **extra_kw)
    
        except SocketTimeout as e:
            raise ConnectTimeoutError(
                self, "Connection to %s timed out. (connect timeout=%s)" %
                (self.host, self.timeout))
    
        except SocketError as e:
            raise NewConnectionError(
>               self, "Failed to establish a new connection: %s" % e)
E           urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3d6b76d8>: Failed to establish a new connection: [Errno 111] Connection refused

.tox/c1/lib/python3.6/site-packages/urllib3/connection.py:150: NewConnectionError

During handling of the above exception, another exception occurred:

self = <requests.adapters.HTTPAdapter object at 0x7fde3d9acdd8>
request = <PreparedRequest [PUT]>, stream = False
timeout = <urllib3.util.timeout.Timeout object at 0x7fde3d6b7630>, verify = ''
cert = None, proxies = OrderedDict()

    def send(self, request, stream=False, timeout=None, verify=True, cert=None, proxies=None):
        """Sends PreparedRequest object. Returns Response object.
    
        :param request: The :class:`PreparedRequest <PreparedRequest>` being sent.
        :param stream: (optional) Whether to stream the request content.
        :param timeout: (optional) How long to wait for the server to send
            data before giving up, as a float, or a :ref:`(connect timeout,
            read timeout) <timeouts>` tuple.
        :type timeout: float or tuple or urllib3 Timeout object
        :param verify: (optional) Either a boolean, in which case it controls whether
            we verify the server's TLS certificate, or a string, in which case it
            must be a path to a CA bundle to use
        :param cert: (optional) Any user-provided SSL certificate to be trusted.
        :param proxies: (optional) The proxies dictionary to apply to the request.
        :rtype: requests.Response
        """
    
        conn = self.get_connection(request.url, proxies)
    
        self.cert_verify(conn, request.url, verify, cert)
        url = self.request_url(request, proxies)
        self.add_headers(request)
    
        chunked = not (request.body is None or 'Content-Length' in request.headers)
    
        if isinstance(timeout, tuple):
            try:
                connect, read = timeout
                timeout = TimeoutSauce(connect=connect, read=read)
            except ValueError as e:
                # this may raise a string formatting error.
                err = ("Invalid timeout {0}. Pass a (connect, read) "
                       "timeout tuple, or a single float to set "
                       "both timeouts to the same value".format(timeout))
                raise ValueError(err)
        elif isinstance(timeout, TimeoutSauce):
            pass
        else:
            timeout = TimeoutSauce(connect=timeout, read=timeout)
    
        try:
            if not chunked:
                resp = conn.urlopen(
                    method=request.method,
                    url=url,
                    body=request.body,
                    headers=request.headers,
                    redirect=False,
                    assert_same_host=False,
                    preload_content=False,
                    decode_content=False,
                    retries=self.max_retries,
>                   timeout=timeout
                )

.tox/c1/lib/python3.6/site-packages/requests/adapters.py:440: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <urllib3.connectionpool.HTTPConnectionPool object at 0x7fde3d7cd128>
method = 'PUT', url = '/test-weko-item-v1.0.0'
body = b'{"settings":{"number_of_shards":1,"number_of_replicas":1,"index.mapping.total_fields.limit":50000,"analysis":{"token...":{"type":"text","index":false,"copy_to":"search_string","fields":{"raw":{"type":"keyword","ignore_above":256}}}}}]}}}'
headers = {'content-type': 'application/json', 'Content-Length': '12354'}
retries = Retry(total=0, connect=None, read=False, redirect=None, status=None)
redirect = False, assert_same_host = False
timeout = <urllib3.util.timeout.Timeout object at 0x7fde3d6b7630>
pool_timeout = None, release_conn = False, chunked = False, body_pos = None
response_kw = {'decode_content': False, 'preload_content': False}, conn = None
release_this_conn = True, err = None, clean_exit = False
timeout_obj = <urllib3.util.timeout.Timeout object at 0x7fde3d6b7240>
is_new_proxy_conn = False

    def urlopen(self, method, url, body=None, headers=None, retries=None,
                redirect=True, assert_same_host=True, timeout=_Default,
                pool_timeout=None, release_conn=None, chunked=False,
                body_pos=None, **response_kw):
        """
        Get a connection from the pool and perform an HTTP request. This is the
        lowest level call for making a request, so you'll need to specify all
        the raw details.
    
        .. note::
    
           More commonly, it's appropriate to use a convenience method provided
           by :class:`.RequestMethods`, such as :meth:`request`.
    
        .. note::
    
           `release_conn` will only behave as expected if
           `preload_content=False` because we want to make
           `preload_content=False` the default behaviour someday soon without
           breaking backwards compatibility.
    
        :param method:
            HTTP request method (such as GET, POST, PUT, etc.)
    
        :param body:
            Data to send in the request body (useful for creating
            POST requests, see HTTPConnectionPool.post_url for
            more convenience).
    
        :param headers:
            Dictionary of custom headers to send, such as User-Agent,
            If-None-Match, etc. If None, pool headers are used. If provided,
            these headers completely replace any pool-specific headers.
    
        :param retries:
            Configure the number of retries to allow before raising a
            :class:`~urllib3.exceptions.MaxRetryError` exception.
    
            Pass ``None`` to retry until you receive a response. Pass a
            :class:`~urllib3.util.retry.Retry` object for fine-grained control
            over different types of retries.
            Pass an integer number to retry connection errors that many times,
            but no other types of errors. Pass zero to never retry.
    
            If ``False``, then retries are disabled and any exception is raised
            immediately. Also, instead of raising a MaxRetryError on redirects,
            the redirect response will be returned.
    
        :type retries: :class:`~urllib3.util.retry.Retry`, False, or an int.
    
        :param redirect:
            If True, automatically handle redirects (status codes 301, 302,
            303, 307, 308). Each redirect counts as a retry. Disabling retries
            will disable redirect, too.
    
        :param assert_same_host:
            If ``True``, will make sure that the host of the pool requests is
            consistent else will raise HostChangedError. When False, you can
            use the pool on an HTTP proxy and request foreign hosts.
    
        :param timeout:
            If specified, overrides the default timeout for this one
            request. It may be a float (in seconds) or an instance of
            :class:`urllib3.util.Timeout`.
    
        :param pool_timeout:
            If set and the pool is set to block=True, then this method will
            block for ``pool_timeout`` seconds and raise EmptyPoolError if no
            connection is available within the time period.
    
        :param release_conn:
            If False, then the urlopen call will not release the connection
            back into the pool once a response is received (but will release if
            you read the entire contents of the response such as when
            `preload_content=True`). This is useful if you're not preloading
            the response's content immediately. You will need to call
            ``r.release_conn()`` on the response ``r`` to return the connection
            back into the pool. If None, it takes the value of
            ``response_kw.get('preload_content', True)``.
    
        :param chunked:
            If True, urllib3 will send the body using chunked transfer
            encoding. Otherwise, urllib3 will send the body using the standard
            content-length form. Defaults to False.
    
        :param int body_pos:
            Position to seek to in file-like body in the event of a retry or
            redirect. Typically this won't need to be set because urllib3 will
            auto-populate the value when needed.
    
        :param \\**response_kw:
            Additional parameters are passed to
            :meth:`urllib3.response.HTTPResponse.from_httplib`
        """
        if headers is None:
            headers = self.headers
    
        if not isinstance(retries, Retry):
            retries = Retry.from_int(retries, redirect=redirect, default=self.retries)
    
        if release_conn is None:
            release_conn = response_kw.get('preload_content', True)
    
        # Check host
        if assert_same_host and not self.is_same_host(url):
            raise HostChangedError(self, url, retries)
    
        conn = None
    
        # Track whether `conn` needs to be released before
        # returning/raising/recursing. Update this variable if necessary, and
        # leave `release_conn` constant throughout the function. That way, if
        # the function recurses, the original value of `release_conn` will be
        # passed down into the recursive call, and its value will be respected.
        #
        # See issue #651 [1] for details.
        #
        # [1] <https://github.com/shazow/urllib3/issues/651>
        release_this_conn = release_conn
    
        # Merge the proxy headers. Only do this in HTTP. We have to copy the
        # headers dict so we can safely change it without those changes being
        # reflected in anyone else's copy.
        if self.scheme == 'http':
            headers = headers.copy()
            headers.update(self.proxy_headers)
    
        # Must keep the exception bound to a separate variable or else Python 3
        # complains about UnboundLocalError.
        err = None
    
        # Keep track of whether we cleanly exited the except block. This
        # ensures we do proper cleanup in finally.
        clean_exit = False
    
        # Rewind body position, if needed. Record current position
        # for future rewinds in the event of a redirect/retry.
        body_pos = set_file_position(body, body_pos)
    
        try:
            # Request a connection from the queue.
            timeout_obj = self._get_timeout(timeout)
            conn = self._get_conn(timeout=pool_timeout)
    
            conn.timeout = timeout_obj.connect_timeout
    
            is_new_proxy_conn = self.proxy is not None and not getattr(conn, 'sock', None)
            if is_new_proxy_conn:
                self._prepare_proxy(conn)
    
            # Make the request on the httplib connection object.
            httplib_response = self._make_request(conn, method, url,
                                                  timeout=timeout_obj,
                                                  body=body, headers=headers,
                                                  chunked=chunked)
    
            # If we're going to release the connection in ``finally:``, then
            # the response doesn't need to know about the connection. Otherwise
            # it will also try to release it and we'll have a double-release
            # mess.
            response_conn = conn if not release_conn else None
    
            # Pass method to Response for length checking
            response_kw['request_method'] = method
    
            # Import httplib's response into our own wrapper object
            response = self.ResponseCls.from_httplib(httplib_response,
                                                     pool=self,
                                                     connection=response_conn,
                                                     retries=retries,
                                                     **response_kw)
    
            # Everything went great!
            clean_exit = True
    
        except queue.Empty:
            # Timed out by queue.
            raise EmptyPoolError(self, "No pool connections are available.")
    
        except (TimeoutError, HTTPException, SocketError, ProtocolError,
                BaseSSLError, SSLError, CertificateError) as e:
            # Discard the connection for these exceptions. It will be
            # replaced during the next _get_conn() call.
            clean_exit = False
            if isinstance(e, (BaseSSLError, CertificateError)):
                e = SSLError(e)
            elif isinstance(e, (SocketError, NewConnectionError)) and self.proxy:
                e = ProxyError('Cannot connect to proxy.', e)
            elif isinstance(e, (SocketError, HTTPException)):
                e = ProtocolError('Connection aborted.', e)
    
            retries = retries.increment(method, url, error=e, _pool=self,
>                                       _stacktrace=sys.exc_info()[2])

.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py:639: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = Retry(total=0, connect=None, read=False, redirect=None, status=None)
method = 'PUT', url = '/test-weko-item-v1.0.0', response = None
error = NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3d6b76d8>: Failed to establish a new connection: [Errno 111] Connection refused',)
_pool = <urllib3.connectionpool.HTTPConnectionPool object at 0x7fde3d7cd128>
_stacktrace = <traceback object at 0x7fde3d6bb348>

    def increment(self, method=None, url=None, response=None, error=None,
                  _pool=None, _stacktrace=None):
        """ Return a new Retry object with incremented retry counters.
    
        :param response: A response object, or None, if the server did not
            return a response.
        :type response: :class:`~urllib3.response.HTTPResponse`
        :param Exception error: An error encountered during the request, or
            None if the response was received successfully.
    
        :return: A new ``Retry`` object.
        """
        if self.total is False and error:
            # Disabled, indicate to re-raise the error.
            raise six.reraise(type(error), error, _stacktrace)
    
        total = self.total
        if total is not None:
            total -= 1
    
        connect = self.connect
        read = self.read
        redirect = self.redirect
        status_count = self.status
        cause = 'unknown'
        status = None
        redirect_location = None
    
        if error and self._is_connection_error(error):
            # Connect retry?
            if connect is False:
                raise six.reraise(type(error), error, _stacktrace)
            elif connect is not None:
                connect -= 1
    
        elif error and self._is_read_error(error):
            # Read retry?
            if read is False or not self._is_method_retryable(method):
                raise six.reraise(type(error), error, _stacktrace)
            elif read is not None:
                read -= 1
    
        elif response and response.get_redirect_location():
            # Redirect retry?
            if redirect is not None:
                redirect -= 1
            cause = 'too many redirects'
            redirect_location = response.get_redirect_location()
            status = response.status
    
        else:
            # Incrementing because of a server error like a 500 in
            # status_forcelist and a the given method is in the whitelist
            cause = ResponseError.GENERIC_ERROR
            if response and response.status:
                if status_count is not None:
                    status_count -= 1
                cause = ResponseError.SPECIFIC_ERROR.format(
                    status_code=response.status)
                status = response.status
    
        history = self.history + (RequestHistory(method, url, error, status, redirect_location),)
    
        new_retry = self.new(
            total=total,
            connect=connect, read=read, redirect=redirect, status=status_count,
            history=history)
    
        if new_retry.is_exhausted():
>           raise MaxRetryError(_pool, url, error or ResponseError(cause))
E           urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3d6b76d8>: Failed to establish a new connection: [Errno 111] Connection refused',))

.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py:388: MaxRetryError

During handling of the above exception, another exception occurred:

self = <RequestsHttpConnection: http://localhost:9200>, method = 'PUT'
url = 'http://localhost:9200/test-weko-item-v1.0.0', params = {}
body = b'{"settings":{"number_of_shards":1,"number_of_replicas":1,"index.mapping.total_fields.limit":50000,"analysis":{"token...":{"type":"text","index":false,"copy_to":"search_string","fields":{"raw":{"type":"keyword","ignore_above":256}}}}}]}}}'
timeout = None, ignore = (), headers = None

    def perform_request(self, method, url, params=None, body=None, timeout=None, ignore=(), headers=None):
        url = self.base_url + url
        if params:
            url = '%s?%s' % (url, urlencode(params or {}))
    
        start = time.time()
        request = requests.Request(method=method, headers=headers, url=url, data=body)
        prepared_request = self.session.prepare_request(request)
        settings = self.session.merge_environment_settings(prepared_request.url, {}, None, None, None)
        send_kwargs = {'timeout': timeout or self.timeout}
        send_kwargs.update(settings)
        try:
>           response = self.session.send(prepared_request, **send_kwargs)

.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py:76: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <requests.sessions.Session object at 0x7fde3d9cfac8>
request = <PreparedRequest [PUT]>
kwargs = {'cert': None, 'proxies': OrderedDict(), 'stream': False, 'timeout': 120, ...}
allow_redirects = True, stream = False, hooks = {'response': []}
adapter = <requests.adapters.HTTPAdapter object at 0x7fde3d9acdd8>
start = 1679693092.5527208

    def send(self, request, **kwargs):
        """Send a given PreparedRequest.
    
        :rtype: requests.Response
        """
        # Set defaults that the hooks can utilize to ensure they always have
        # the correct parameters to reproduce the previous request.
        kwargs.setdefault('stream', self.stream)
        kwargs.setdefault('verify', self.verify)
        kwargs.setdefault('cert', self.cert)
        kwargs.setdefault('proxies', self.proxies)
    
        # It's possible that users might accidentally send a Request object.
        # Guard against that specific failure case.
        if isinstance(request, Request):
            raise ValueError('You can only send PreparedRequests.')
    
        # Set up variables needed for resolve_redirects and dispatching of hooks
        allow_redirects = kwargs.pop('allow_redirects', True)
        stream = kwargs.get('stream')
        hooks = request.hooks
    
        # Get the appropriate adapter to use
        adapter = self.get_adapter(url=request.url)
    
        # Start time (approximately) of the request
        start = preferred_clock()
    
        # Send the request
>       r = adapter.send(request, **kwargs)

.tox/c1/lib/python3.6/site-packages/requests/sessions.py:618: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <requests.adapters.HTTPAdapter object at 0x7fde3d9acdd8>
request = <PreparedRequest [PUT]>, stream = False
timeout = <urllib3.util.timeout.Timeout object at 0x7fde3d6b7630>, verify = ''
cert = None, proxies = OrderedDict()

    def send(self, request, stream=False, timeout=None, verify=True, cert=None, proxies=None):
        """Sends PreparedRequest object. Returns Response object.
    
        :param request: The :class:`PreparedRequest <PreparedRequest>` being sent.
        :param stream: (optional) Whether to stream the request content.
        :param timeout: (optional) How long to wait for the server to send
            data before giving up, as a float, or a :ref:`(connect timeout,
            read timeout) <timeouts>` tuple.
        :type timeout: float or tuple or urllib3 Timeout object
        :param verify: (optional) Either a boolean, in which case it controls whether
            we verify the server's TLS certificate, or a string, in which case it
            must be a path to a CA bundle to use
        :param cert: (optional) Any user-provided SSL certificate to be trusted.
        :param proxies: (optional) The proxies dictionary to apply to the request.
        :rtype: requests.Response
        """
    
        conn = self.get_connection(request.url, proxies)
    
        self.cert_verify(conn, request.url, verify, cert)
        url = self.request_url(request, proxies)
        self.add_headers(request)
    
        chunked = not (request.body is None or 'Content-Length' in request.headers)
    
        if isinstance(timeout, tuple):
            try:
                connect, read = timeout
                timeout = TimeoutSauce(connect=connect, read=read)
            except ValueError as e:
                # this may raise a string formatting error.
                err = ("Invalid timeout {0}. Pass a (connect, read) "
                       "timeout tuple, or a single float to set "
                       "both timeouts to the same value".format(timeout))
                raise ValueError(err)
        elif isinstance(timeout, TimeoutSauce):
            pass
        else:
            timeout = TimeoutSauce(connect=timeout, read=timeout)
    
        try:
            if not chunked:
                resp = conn.urlopen(
                    method=request.method,
                    url=url,
                    body=request.body,
                    headers=request.headers,
                    redirect=False,
                    assert_same_host=False,
                    preload_content=False,
                    decode_content=False,
                    retries=self.max_retries,
                    timeout=timeout
                )
    
            # Send the request.
            else:
                if hasattr(conn, 'proxy_pool'):
                    conn = conn.proxy_pool
    
                low_conn = conn._get_conn(timeout=DEFAULT_POOL_TIMEOUT)
    
                try:
                    low_conn.putrequest(request.method,
                                        url,
                                        skip_accept_encoding=True)
    
                    for header, value in request.headers.items():
                        low_conn.putheader(header, value)
    
                    low_conn.endheaders()
    
                    for i in request.body:
                        low_conn.send(hex(len(i))[2:].encode('utf-8'))
                        low_conn.send(b'\r\n')
                        low_conn.send(i)
                        low_conn.send(b'\r\n')
                    low_conn.send(b'0\r\n\r\n')
    
                    # Receive the response from the server
                    try:
                        # For Python 2.7+ versions, use buffering of HTTP
                        # responses
                        r = low_conn.getresponse(buffering=True)
                    except TypeError:
                        # For compatibility with Python 2.6 versions and back
                        r = low_conn.getresponse()
    
                    resp = HTTPResponse.from_httplib(
                        r,
                        pool=conn,
                        connection=low_conn,
                        preload_content=False,
                        decode_content=False
                    )
                except:
                    # If we hit any problems here, clean up the connection.
                    # Then, reraise so that we can handle the actual exception.
                    low_conn.close()
                    raise
    
        except (ProtocolError, socket.error) as err:
            raise ConnectionError(err, request=request)
    
        except MaxRetryError as e:
            if isinstance(e.reason, ConnectTimeoutError):
                # TODO: Remove this in 3.0.0: see #2811
                if not isinstance(e.reason, NewConnectionError):
                    raise ConnectTimeout(e, request=request)
    
            if isinstance(e.reason, ResponseError):
                raise RetryError(e, request=request)
    
            if isinstance(e.reason, _ProxyError):
                raise ProxyError(e, request=request)
    
            if isinstance(e.reason, _SSLError):
                # This branch is for urllib3 v1.22 and later.
                raise SSLError(e, request=request)
    
>           raise ConnectionError(e, request=request)
E           requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3d6b76d8>: Failed to establish a new connection: [Errno 111] Connection refused',))

.tox/c1/lib/python3.6/site-packages/requests/adapters.py:508: ConnectionError

During handling of the above exception, another exception occurred:

app = <Flask 'testapp'>
db_records = [(<PersistentIdentifier depid:1 / rec:ef7f0a12-697d-4122-a384-74af0c276b64 (R)>, <PersistentIdentifier recid:1 / rec:e...617258105262': {'resourceuri': 'http://purl.org/coar/resource_type/c_5794', 'resourcetype': 'conference paper'}}), ...]

    @pytest.fixture()
    def esindex(app,db_records):
        with open("tests/data/mappings/item-v1.0.0.json","r") as f:
            mapping = json.load(f)
    
        search = LocalProxy(lambda: app.extensions["invenio-search"])
    
        with app.test_request_context():
>           search.client.indices.create(app.config["INDEXER_DEFAULT_INDEX"],body=mapping)

tests/conftest.py:352: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.tox/c1/lib/python3.6/site-packages/elasticsearch/client/utils.py:76: in _wrapped
    return func(*args, params=params, **kwargs)
.tox/c1/lib/python3.6/site-packages/elasticsearch/client/indices.py:91: in create
    params=params, body=body)
.tox/c1/lib/python3.6/site-packages/elasticsearch/transport.py:314: in perform_request
    status, headers_response, data = connection.perform_request(method, url, params, body, headers=headers, ignore=ignore, timeout=timeout)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <RequestsHttpConnection: http://localhost:9200>, method = 'PUT'
url = 'http://localhost:9200/test-weko-item-v1.0.0', params = {}
body = b'{"settings":{"number_of_shards":1,"number_of_replicas":1,"index.mapping.total_fields.limit":50000,"analysis":{"token...":{"type":"text","index":false,"copy_to":"search_string","fields":{"raw":{"type":"keyword","ignore_above":256}}}}}]}}}'
timeout = None, ignore = (), headers = None

    def perform_request(self, method, url, params=None, body=None, timeout=None, ignore=(), headers=None):
        url = self.base_url + url
        if params:
            url = '%s?%s' % (url, urlencode(params or {}))
    
        start = time.time()
        request = requests.Request(method=method, headers=headers, url=url, data=body)
        prepared_request = self.session.prepare_request(request)
        settings = self.session.merge_environment_settings(prepared_request.url, {}, None, None, None)
        send_kwargs = {'timeout': timeout or self.timeout}
        send_kwargs.update(settings)
        try:
            response = self.session.send(prepared_request, **send_kwargs)
            duration = time.time() - start
            raw_data = response.text
        except Exception as e:
            self.log_request_fail(method, url, prepared_request.path_url, body, time.time() - start, exception=e)
            if isinstance(e, requests.exceptions.SSLError):
                raise SSLError('N/A', str(e), e)
            if isinstance(e, requests.Timeout):
                raise ConnectionTimeout('TIMEOUT', str(e), e)
>           raise ConnectionError('N/A', str(e), e)
E           elasticsearch.exceptions.ConnectionError: ConnectionError(HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3d6b76d8>: Failed to establish a new connection: [Errno 111] Connection refused',))) caused by: ConnectionError(HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3d6b76d8>: Failed to establish a new connection: [Errno 111] Connection refused',)))

.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py:85: ConnectionError
------------------------------ Captured log setup ------------------------------
WARNING  flask.app:ext.py:255 JSONSCHEMAS_HOST is set to localhost
WARNING  elasticsearch:base.py:97 PUT http://localhost:9200/test-weko-item-v1.0.0 [status:N/A request:0.005s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3d7cd400>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3d7cd400>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3d7cd400>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 PUT http://localhost:9200/test-weko-item-v1.0.0 [status:N/A request:0.001s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3d7cd4e0>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3d7cd4e0>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3d7cd4e0>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 PUT http://localhost:9200/test-weko-item-v1.0.0 [status:N/A request:0.001s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3d7e7128>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3d7e7128>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3d7e7128>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 PUT http://localhost:9200/test-weko-item-v1.0.0 [status:N/A request:0.001s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3d7de0b8>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3d7de0b8>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3d7de0b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 PUT http://localhost:9200/test-weko-item-v1.0.0 [status:N/A request:0.002s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3d7deef0>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3d7deef0>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3d7deef0>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 PUT http://localhost:9200/test-weko-item-v1.0.0 [status:N/A request:0.001s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3c9b1240>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3c9b1240>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3c9b1240>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 PUT http://localhost:9200/test-weko-item-v1.0.0 [status:N/A request:0.001s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3c9b18d0>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3c9b18d0>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3c9b18d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 PUT http://localhost:9200/test-weko-item-v1.0.0 [status:N/A request:0.001s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3c9b1cc0>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3c9b1cc0>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3c9b1cc0>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 PUT http://localhost:9200/test-weko-item-v1.0.0 [status:N/A request:0.001s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3c9b1f98>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3c9b1f98>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3c9b1f98>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 PUT http://localhost:9200/test-weko-item-v1.0.0 [status:N/A request:0.001s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3d6b7358>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3d6b7358>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3d6b7358>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 PUT http://localhost:9200/test-weko-item-v1.0.0 [status:N/A request:0.001s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3d6b76d8>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3d6b76d8>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3d6b76d8>: Failed to establish a new connection: [Errno 111] Connection refused',))
_____________ ERROR at setup of test_update_index_tree_for_record ______________

self = <urllib3.connection.HTTPConnection object at 0x7fde3c2c4908>

    def _new_conn(self):
        """ Establish a socket connection and set nodelay settings on it.
    
        :return: New socket connection.
        """
        extra_kw = {}
        if self.source_address:
            extra_kw['source_address'] = self.source_address
    
        if self.socket_options:
            extra_kw['socket_options'] = self.socket_options
    
        try:
            conn = connection.create_connection(
>               (self.host, self.port), self.timeout, **extra_kw)

.tox/c1/lib/python3.6/site-packages/urllib3/connection.py:141: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

address = ('localhost', 9200), timeout = 120, source_address = None
socket_options = [(6, 1, 1)]

    def create_connection(address, timeout=socket._GLOBAL_DEFAULT_TIMEOUT,
                          source_address=None, socket_options=None):
        """Connect to *address* and return the socket object.
    
        Convenience function.  Connect to *address* (a 2-tuple ``(host,
        port)``) and return the socket object.  Passing the optional
        *timeout* parameter will set the timeout on the socket instance
        before attempting to connect.  If no *timeout* is supplied, the
        global default timeout setting returned by :func:`getdefaulttimeout`
        is used.  If *source_address* is set it must be a tuple of (host, port)
        for the socket to bind as a source address before making the connection.
        An host of '' or port 0 tells the OS to use the default.
        """
    
        host, port = address
        if host.startswith('['):
            host = host.strip('[]')
        err = None
    
        # Using the value from allowed_gai_family() in the context of getaddrinfo lets
        # us select whether to work with IPv4 DNS records, IPv6 records, or both.
        # The original create_connection function always returns all records.
        family = allowed_gai_family()
    
        for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
            af, socktype, proto, canonname, sa = res
            sock = None
            try:
                sock = socket.socket(af, socktype, proto)
    
                # If provided, set socket level options before connecting.
                _set_socket_options(sock, socket_options)
    
                if timeout is not socket._GLOBAL_DEFAULT_TIMEOUT:
                    sock.settimeout(timeout)
                if source_address:
                    sock.bind(source_address)
                sock.connect(sa)
                return sock
    
            except socket.error as e:
                err = e
                if sock is not None:
                    sock.close()
                    sock = None
    
        if err is not None:
>           raise err

.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py:83: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

address = ('localhost', 9200), timeout = 120, source_address = None
socket_options = [(6, 1, 1)]

    def create_connection(address, timeout=socket._GLOBAL_DEFAULT_TIMEOUT,
                          source_address=None, socket_options=None):
        """Connect to *address* and return the socket object.
    
        Convenience function.  Connect to *address* (a 2-tuple ``(host,
        port)``) and return the socket object.  Passing the optional
        *timeout* parameter will set the timeout on the socket instance
        before attempting to connect.  If no *timeout* is supplied, the
        global default timeout setting returned by :func:`getdefaulttimeout`
        is used.  If *source_address* is set it must be a tuple of (host, port)
        for the socket to bind as a source address before making the connection.
        An host of '' or port 0 tells the OS to use the default.
        """
    
        host, port = address
        if host.startswith('['):
            host = host.strip('[]')
        err = None
    
        # Using the value from allowed_gai_family() in the context of getaddrinfo lets
        # us select whether to work with IPv4 DNS records, IPv6 records, or both.
        # The original create_connection function always returns all records.
        family = allowed_gai_family()
    
        for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
            af, socktype, proto, canonname, sa = res
            sock = None
            try:
                sock = socket.socket(af, socktype, proto)
    
                # If provided, set socket level options before connecting.
                _set_socket_options(sock, socket_options)
    
                if timeout is not socket._GLOBAL_DEFAULT_TIMEOUT:
                    sock.settimeout(timeout)
                if source_address:
                    sock.bind(source_address)
>               sock.connect(sa)
E               ConnectionRefusedError: [Errno 111] Connection refused

.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py:73: ConnectionRefusedError

During handling of the above exception, another exception occurred:

self = <urllib3.connectionpool.HTTPConnectionPool object at 0x7fde3d185fd0>
method = 'PUT', url = '/test-weko-item-v1.0.0'
body = b'{"settings":{"number_of_shards":1,"number_of_replicas":1,"index.mapping.total_fields.limit":50000,"analysis":{"token...":{"type":"text","index":false,"copy_to":"search_string","fields":{"raw":{"type":"keyword","ignore_above":256}}}}}]}}}'
headers = {'content-type': 'application/json', 'Content-Length': '12354'}
retries = Retry(total=0, connect=None, read=False, redirect=None, status=None)
redirect = False, assert_same_host = False
timeout = <urllib3.util.timeout.Timeout object at 0x7fde3c2c4fd0>
pool_timeout = None, release_conn = False, chunked = False, body_pos = None
response_kw = {'decode_content': False, 'preload_content': False}, conn = None
release_this_conn = True, err = None, clean_exit = False
timeout_obj = <urllib3.util.timeout.Timeout object at 0x7fde3c2c4048>
is_new_proxy_conn = False

    def urlopen(self, method, url, body=None, headers=None, retries=None,
                redirect=True, assert_same_host=True, timeout=_Default,
                pool_timeout=None, release_conn=None, chunked=False,
                body_pos=None, **response_kw):
        """
        Get a connection from the pool and perform an HTTP request. This is the
        lowest level call for making a request, so you'll need to specify all
        the raw details.
    
        .. note::
    
           More commonly, it's appropriate to use a convenience method provided
           by :class:`.RequestMethods`, such as :meth:`request`.
    
        .. note::
    
           `release_conn` will only behave as expected if
           `preload_content=False` because we want to make
           `preload_content=False` the default behaviour someday soon without
           breaking backwards compatibility.
    
        :param method:
            HTTP request method (such as GET, POST, PUT, etc.)
    
        :param body:
            Data to send in the request body (useful for creating
            POST requests, see HTTPConnectionPool.post_url for
            more convenience).
    
        :param headers:
            Dictionary of custom headers to send, such as User-Agent,
            If-None-Match, etc. If None, pool headers are used. If provided,
            these headers completely replace any pool-specific headers.
    
        :param retries:
            Configure the number of retries to allow before raising a
            :class:`~urllib3.exceptions.MaxRetryError` exception.
    
            Pass ``None`` to retry until you receive a response. Pass a
            :class:`~urllib3.util.retry.Retry` object for fine-grained control
            over different types of retries.
            Pass an integer number to retry connection errors that many times,
            but no other types of errors. Pass zero to never retry.
    
            If ``False``, then retries are disabled and any exception is raised
            immediately. Also, instead of raising a MaxRetryError on redirects,
            the redirect response will be returned.
    
        :type retries: :class:`~urllib3.util.retry.Retry`, False, or an int.
    
        :param redirect:
            If True, automatically handle redirects (status codes 301, 302,
            303, 307, 308). Each redirect counts as a retry. Disabling retries
            will disable redirect, too.
    
        :param assert_same_host:
            If ``True``, will make sure that the host of the pool requests is
            consistent else will raise HostChangedError. When False, you can
            use the pool on an HTTP proxy and request foreign hosts.
    
        :param timeout:
            If specified, overrides the default timeout for this one
            request. It may be a float (in seconds) or an instance of
            :class:`urllib3.util.Timeout`.
    
        :param pool_timeout:
            If set and the pool is set to block=True, then this method will
            block for ``pool_timeout`` seconds and raise EmptyPoolError if no
            connection is available within the time period.
    
        :param release_conn:
            If False, then the urlopen call will not release the connection
            back into the pool once a response is received (but will release if
            you read the entire contents of the response such as when
            `preload_content=True`). This is useful if you're not preloading
            the response's content immediately. You will need to call
            ``r.release_conn()`` on the response ``r`` to return the connection
            back into the pool. If None, it takes the value of
            ``response_kw.get('preload_content', True)``.
    
        :param chunked:
            If True, urllib3 will send the body using chunked transfer
            encoding. Otherwise, urllib3 will send the body using the standard
            content-length form. Defaults to False.
    
        :param int body_pos:
            Position to seek to in file-like body in the event of a retry or
            redirect. Typically this won't need to be set because urllib3 will
            auto-populate the value when needed.
    
        :param \\**response_kw:
            Additional parameters are passed to
            :meth:`urllib3.response.HTTPResponse.from_httplib`
        """
        if headers is None:
            headers = self.headers
    
        if not isinstance(retries, Retry):
            retries = Retry.from_int(retries, redirect=redirect, default=self.retries)
    
        if release_conn is None:
            release_conn = response_kw.get('preload_content', True)
    
        # Check host
        if assert_same_host and not self.is_same_host(url):
            raise HostChangedError(self, url, retries)
    
        conn = None
    
        # Track whether `conn` needs to be released before
        # returning/raising/recursing. Update this variable if necessary, and
        # leave `release_conn` constant throughout the function. That way, if
        # the function recurses, the original value of `release_conn` will be
        # passed down into the recursive call, and its value will be respected.
        #
        # See issue #651 [1] for details.
        #
        # [1] <https://github.com/shazow/urllib3/issues/651>
        release_this_conn = release_conn
    
        # Merge the proxy headers. Only do this in HTTP. We have to copy the
        # headers dict so we can safely change it without those changes being
        # reflected in anyone else's copy.
        if self.scheme == 'http':
            headers = headers.copy()
            headers.update(self.proxy_headers)
    
        # Must keep the exception bound to a separate variable or else Python 3
        # complains about UnboundLocalError.
        err = None
    
        # Keep track of whether we cleanly exited the except block. This
        # ensures we do proper cleanup in finally.
        clean_exit = False
    
        # Rewind body position, if needed. Record current position
        # for future rewinds in the event of a redirect/retry.
        body_pos = set_file_position(body, body_pos)
    
        try:
            # Request a connection from the queue.
            timeout_obj = self._get_timeout(timeout)
            conn = self._get_conn(timeout=pool_timeout)
    
            conn.timeout = timeout_obj.connect_timeout
    
            is_new_proxy_conn = self.proxy is not None and not getattr(conn, 'sock', None)
            if is_new_proxy_conn:
                self._prepare_proxy(conn)
    
            # Make the request on the httplib connection object.
            httplib_response = self._make_request(conn, method, url,
                                                  timeout=timeout_obj,
                                                  body=body, headers=headers,
>                                                 chunked=chunked)

.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py:601: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <urllib3.connectionpool.HTTPConnectionPool object at 0x7fde3d185fd0>
conn = <urllib3.connection.HTTPConnection object at 0x7fde3c2c4908>
method = 'PUT', url = '/test-weko-item-v1.0.0'
timeout = <urllib3.util.timeout.Timeout object at 0x7fde3c2c4048>
chunked = False
httplib_request_kw = {'body': b'{"settings":{"number_of_shards":1,"number_of_replicas":1,"index.mapping.total_fields.limit":50000,"analysis...pe":"keyword","ignore_above":256}}}}}]}}}', 'headers': {'content-type': 'application/json', 'Content-Length': '12354'}}
timeout_obj = <urllib3.util.timeout.Timeout object at 0x7fde3c2c4390>

    def _make_request(self, conn, method, url, timeout=_Default, chunked=False,
                      **httplib_request_kw):
        """
        Perform a request on a given urllib connection object taken from our
        pool.
    
        :param conn:
            a connection from one of our connection pools
    
        :param timeout:
            Socket timeout in seconds for the request. This can be a
            float or integer, which will set the same timeout value for
            the socket connect and the socket read, or an instance of
            :class:`urllib3.util.Timeout`, which gives you more fine-grained
            control over your timeouts.
        """
        self.num_requests += 1
    
        timeout_obj = self._get_timeout(timeout)
        timeout_obj.start_connect()
        conn.timeout = timeout_obj.connect_timeout
    
        # Trigger any extra validation we need to do.
        try:
            self._validate_conn(conn)
        except (SocketTimeout, BaseSSLError) as e:
            # Py2 raises this as a BaseSSLError, Py3 raises it as socket timeout.
            self._raise_timeout(err=e, url=url, timeout_value=conn.timeout)
            raise
    
        # conn.request() calls httplib.*.request, not the method in
        # urllib3.request. It also calls makefile (recv) on the socket.
        if chunked:
            conn.request_chunked(method, url, **httplib_request_kw)
        else:
>           conn.request(method, url, **httplib_request_kw)

.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py:357: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <urllib3.connection.HTTPConnection object at 0x7fde3c2c4908>
method = 'PUT', url = '/test-weko-item-v1.0.0'
body = b'{"settings":{"number_of_shards":1,"number_of_replicas":1,"index.mapping.total_fields.limit":50000,"analysis":{"token...":{"type":"text","index":false,"copy_to":"search_string","fields":{"raw":{"type":"keyword","ignore_above":256}}}}}]}}}'
headers = {'content-type': 'application/json', 'Content-Length': '12354'}

    def request(self, method, url, body=None, headers={}, *,
                encode_chunked=False):
        """Send a complete request to the server."""
>       self._send_request(method, url, body, headers, encode_chunked)

/usr/local/lib/python3.6/http/client.py:1291: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <urllib3.connection.HTTPConnection object at 0x7fde3c2c4908>
method = 'PUT', url = '/test-weko-item-v1.0.0'
body = b'{"settings":{"number_of_shards":1,"number_of_replicas":1,"index.mapping.total_fields.limit":50000,"analysis":{"token...":{"type":"text","index":false,"copy_to":"search_string","fields":{"raw":{"type":"keyword","ignore_above":256}}}}}]}}}'
headers = {'content-type': 'application/json', 'Content-Length': '12354'}
encode_chunked = False

    def _send_request(self, method, url, body, headers, encode_chunked):
        # Honor explicitly requested Host: and Accept-Encoding: headers.
        header_names = frozenset(k.lower() for k in headers)
        skips = {}
        if 'host' in header_names:
            skips['skip_host'] = 1
        if 'accept-encoding' in header_names:
            skips['skip_accept_encoding'] = 1
    
        self.putrequest(method, url, **skips)
    
        # chunked encoding will happen if HTTP/1.1 is used and either
        # the caller passes encode_chunked=True or the following
        # conditions hold:
        # 1. content-length has not been explicitly set
        # 2. the body is a file or iterable, but not a str or bytes-like
        # 3. Transfer-Encoding has NOT been explicitly set by the caller
    
        if 'content-length' not in header_names:
            # only chunk body if not explicitly set for backwards
            # compatibility, assuming the client code is already handling the
            # chunking
            if 'transfer-encoding' not in header_names:
                # if content-length cannot be automatically determined, fall
                # back to chunked encoding
                encode_chunked = False
                content_length = self._get_content_length(body, method)
                if content_length is None:
                    if body is not None:
                        if self.debuglevel > 0:
                            print('Unable to determine size of %r' % body)
                        encode_chunked = True
                        self.putheader('Transfer-Encoding', 'chunked')
                else:
                    self.putheader('Content-Length', str(content_length))
        else:
            encode_chunked = False
    
        for hdr, value in headers.items():
            self.putheader(hdr, value)
        if isinstance(body, str):
            # RFC 2616 Section 3.7.1 says that text default has a
            # default charset of iso-8859-1.
            body = _encode(body, 'body')
>       self.endheaders(body, encode_chunked=encode_chunked)

/usr/local/lib/python3.6/http/client.py:1337: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <urllib3.connection.HTTPConnection object at 0x7fde3c2c4908>
message_body = b'{"settings":{"number_of_shards":1,"number_of_replicas":1,"index.mapping.total_fields.limit":50000,"analysis":{"token...":{"type":"text","index":false,"copy_to":"search_string","fields":{"raw":{"type":"keyword","ignore_above":256}}}}}]}}}'

    def endheaders(self, message_body=None, *, encode_chunked=False):
        """Indicate that the last header line has been sent to the server.
    
        This method sends the request to the server.  The optional message_body
        argument can be used to pass a message body associated with the
        request.
        """
        if self.__state == _CS_REQ_STARTED:
            self.__state = _CS_REQ_SENT
        else:
            raise CannotSendHeader()
>       self._send_output(message_body, encode_chunked=encode_chunked)

/usr/local/lib/python3.6/http/client.py:1286: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <urllib3.connection.HTTPConnection object at 0x7fde3c2c4908>
message_body = b'{"settings":{"number_of_shards":1,"number_of_replicas":1,"index.mapping.total_fields.limit":50000,"analysis":{"token...":{"type":"text","index":false,"copy_to":"search_string","fields":{"raw":{"type":"keyword","ignore_above":256}}}}}]}}}'
encode_chunked = False

    def _send_output(self, message_body=None, encode_chunked=False):
        """Send the currently buffered request and clear the buffer.
    
        Appends an extra \\r\\n to the buffer.
        A message_body may be specified, to be appended to the request.
        """
        self._buffer.extend((b"", b""))
        msg = b"\r\n".join(self._buffer)
        del self._buffer[:]
>       self.send(msg)

/usr/local/lib/python3.6/http/client.py:1046: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <urllib3.connection.HTTPConnection object at 0x7fde3c2c4908>
data = b'PUT /test-weko-item-v1.0.0 HTTP/1.1\r\nHost: localhost:9200\r\nAccept-Encoding: identity\r\ncontent-type: application/json\r\nContent-Length: 12354\r\n\r\n'

    def send(self, data):
        """Send `data' to the server.
        ``data`` can be a string object, a bytes object, an array object, a
        file-like object that supports a .read() method, or an iterable object.
        """
    
        if self.sock is None:
            if self.auto_open:
>               self.connect()

/usr/local/lib/python3.6/http/client.py:984: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <urllib3.connection.HTTPConnection object at 0x7fde3c2c4908>

    def connect(self):
>       conn = self._new_conn()

.tox/c1/lib/python3.6/site-packages/urllib3/connection.py:166: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <urllib3.connection.HTTPConnection object at 0x7fde3c2c4908>

    def _new_conn(self):
        """ Establish a socket connection and set nodelay settings on it.
    
        :return: New socket connection.
        """
        extra_kw = {}
        if self.source_address:
            extra_kw['source_address'] = self.source_address
    
        if self.socket_options:
            extra_kw['socket_options'] = self.socket_options
    
        try:
            conn = connection.create_connection(
                (self.host, self.port), self.timeout, **extra_kw)
    
        except SocketTimeout as e:
            raise ConnectTimeoutError(
                self, "Connection to %s timed out. (connect timeout=%s)" %
                (self.host, self.timeout))
    
        except SocketError as e:
            raise NewConnectionError(
>               self, "Failed to establish a new connection: %s" % e)
E           urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3c2c4908>: Failed to establish a new connection: [Errno 111] Connection refused

.tox/c1/lib/python3.6/site-packages/urllib3/connection.py:150: NewConnectionError

During handling of the above exception, another exception occurred:

self = <requests.adapters.HTTPAdapter object at 0x7fde3e514908>
request = <PreparedRequest [PUT]>, stream = False
timeout = <urllib3.util.timeout.Timeout object at 0x7fde3c2c4fd0>, verify = ''
cert = None, proxies = OrderedDict()

    def send(self, request, stream=False, timeout=None, verify=True, cert=None, proxies=None):
        """Sends PreparedRequest object. Returns Response object.
    
        :param request: The :class:`PreparedRequest <PreparedRequest>` being sent.
        :param stream: (optional) Whether to stream the request content.
        :param timeout: (optional) How long to wait for the server to send
            data before giving up, as a float, or a :ref:`(connect timeout,
            read timeout) <timeouts>` tuple.
        :type timeout: float or tuple or urllib3 Timeout object
        :param verify: (optional) Either a boolean, in which case it controls whether
            we verify the server's TLS certificate, or a string, in which case it
            must be a path to a CA bundle to use
        :param cert: (optional) Any user-provided SSL certificate to be trusted.
        :param proxies: (optional) The proxies dictionary to apply to the request.
        :rtype: requests.Response
        """
    
        conn = self.get_connection(request.url, proxies)
    
        self.cert_verify(conn, request.url, verify, cert)
        url = self.request_url(request, proxies)
        self.add_headers(request)
    
        chunked = not (request.body is None or 'Content-Length' in request.headers)
    
        if isinstance(timeout, tuple):
            try:
                connect, read = timeout
                timeout = TimeoutSauce(connect=connect, read=read)
            except ValueError as e:
                # this may raise a string formatting error.
                err = ("Invalid timeout {0}. Pass a (connect, read) "
                       "timeout tuple, or a single float to set "
                       "both timeouts to the same value".format(timeout))
                raise ValueError(err)
        elif isinstance(timeout, TimeoutSauce):
            pass
        else:
            timeout = TimeoutSauce(connect=timeout, read=timeout)
    
        try:
            if not chunked:
                resp = conn.urlopen(
                    method=request.method,
                    url=url,
                    body=request.body,
                    headers=request.headers,
                    redirect=False,
                    assert_same_host=False,
                    preload_content=False,
                    decode_content=False,
                    retries=self.max_retries,
>                   timeout=timeout
                )

.tox/c1/lib/python3.6/site-packages/requests/adapters.py:440: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <urllib3.connectionpool.HTTPConnectionPool object at 0x7fde3d185fd0>
method = 'PUT', url = '/test-weko-item-v1.0.0'
body = b'{"settings":{"number_of_shards":1,"number_of_replicas":1,"index.mapping.total_fields.limit":50000,"analysis":{"token...":{"type":"text","index":false,"copy_to":"search_string","fields":{"raw":{"type":"keyword","ignore_above":256}}}}}]}}}'
headers = {'content-type': 'application/json', 'Content-Length': '12354'}
retries = Retry(total=0, connect=None, read=False, redirect=None, status=None)
redirect = False, assert_same_host = False
timeout = <urllib3.util.timeout.Timeout object at 0x7fde3c2c4fd0>
pool_timeout = None, release_conn = False, chunked = False, body_pos = None
response_kw = {'decode_content': False, 'preload_content': False}, conn = None
release_this_conn = True, err = None, clean_exit = False
timeout_obj = <urllib3.util.timeout.Timeout object at 0x7fde3c2c4048>
is_new_proxy_conn = False

    def urlopen(self, method, url, body=None, headers=None, retries=None,
                redirect=True, assert_same_host=True, timeout=_Default,
                pool_timeout=None, release_conn=None, chunked=False,
                body_pos=None, **response_kw):
        """
        Get a connection from the pool and perform an HTTP request. This is the
        lowest level call for making a request, so you'll need to specify all
        the raw details.
    
        .. note::
    
           More commonly, it's appropriate to use a convenience method provided
           by :class:`.RequestMethods`, such as :meth:`request`.
    
        .. note::
    
           `release_conn` will only behave as expected if
           `preload_content=False` because we want to make
           `preload_content=False` the default behaviour someday soon without
           breaking backwards compatibility.
    
        :param method:
            HTTP request method (such as GET, POST, PUT, etc.)
    
        :param body:
            Data to send in the request body (useful for creating
            POST requests, see HTTPConnectionPool.post_url for
            more convenience).
    
        :param headers:
            Dictionary of custom headers to send, such as User-Agent,
            If-None-Match, etc. If None, pool headers are used. If provided,
            these headers completely replace any pool-specific headers.
    
        :param retries:
            Configure the number of retries to allow before raising a
            :class:`~urllib3.exceptions.MaxRetryError` exception.
    
            Pass ``None`` to retry until you receive a response. Pass a
            :class:`~urllib3.util.retry.Retry` object for fine-grained control
            over different types of retries.
            Pass an integer number to retry connection errors that many times,
            but no other types of errors. Pass zero to never retry.
    
            If ``False``, then retries are disabled and any exception is raised
            immediately. Also, instead of raising a MaxRetryError on redirects,
            the redirect response will be returned.
    
        :type retries: :class:`~urllib3.util.retry.Retry`, False, or an int.
    
        :param redirect:
            If True, automatically handle redirects (status codes 301, 302,
            303, 307, 308). Each redirect counts as a retry. Disabling retries
            will disable redirect, too.
    
        :param assert_same_host:
            If ``True``, will make sure that the host of the pool requests is
            consistent else will raise HostChangedError. When False, you can
            use the pool on an HTTP proxy and request foreign hosts.
    
        :param timeout:
            If specified, overrides the default timeout for this one
            request. It may be a float (in seconds) or an instance of
            :class:`urllib3.util.Timeout`.
    
        :param pool_timeout:
            If set and the pool is set to block=True, then this method will
            block for ``pool_timeout`` seconds and raise EmptyPoolError if no
            connection is available within the time period.
    
        :param release_conn:
            If False, then the urlopen call will not release the connection
            back into the pool once a response is received (but will release if
            you read the entire contents of the response such as when
            `preload_content=True`). This is useful if you're not preloading
            the response's content immediately. You will need to call
            ``r.release_conn()`` on the response ``r`` to return the connection
            back into the pool. If None, it takes the value of
            ``response_kw.get('preload_content', True)``.
    
        :param chunked:
            If True, urllib3 will send the body using chunked transfer
            encoding. Otherwise, urllib3 will send the body using the standard
            content-length form. Defaults to False.
    
        :param int body_pos:
            Position to seek to in file-like body in the event of a retry or
            redirect. Typically this won't need to be set because urllib3 will
            auto-populate the value when needed.
    
        :param \\**response_kw:
            Additional parameters are passed to
            :meth:`urllib3.response.HTTPResponse.from_httplib`
        """
        if headers is None:
            headers = self.headers
    
        if not isinstance(retries, Retry):
            retries = Retry.from_int(retries, redirect=redirect, default=self.retries)
    
        if release_conn is None:
            release_conn = response_kw.get('preload_content', True)
    
        # Check host
        if assert_same_host and not self.is_same_host(url):
            raise HostChangedError(self, url, retries)
    
        conn = None
    
        # Track whether `conn` needs to be released before
        # returning/raising/recursing. Update this variable if necessary, and
        # leave `release_conn` constant throughout the function. That way, if
        # the function recurses, the original value of `release_conn` will be
        # passed down into the recursive call, and its value will be respected.
        #
        # See issue #651 [1] for details.
        #
        # [1] <https://github.com/shazow/urllib3/issues/651>
        release_this_conn = release_conn
    
        # Merge the proxy headers. Only do this in HTTP. We have to copy the
        # headers dict so we can safely change it without those changes being
        # reflected in anyone else's copy.
        if self.scheme == 'http':
            headers = headers.copy()
            headers.update(self.proxy_headers)
    
        # Must keep the exception bound to a separate variable or else Python 3
        # complains about UnboundLocalError.
        err = None
    
        # Keep track of whether we cleanly exited the except block. This
        # ensures we do proper cleanup in finally.
        clean_exit = False
    
        # Rewind body position, if needed. Record current position
        # for future rewinds in the event of a redirect/retry.
        body_pos = set_file_position(body, body_pos)
    
        try:
            # Request a connection from the queue.
            timeout_obj = self._get_timeout(timeout)
            conn = self._get_conn(timeout=pool_timeout)
    
            conn.timeout = timeout_obj.connect_timeout
    
            is_new_proxy_conn = self.proxy is not None and not getattr(conn, 'sock', None)
            if is_new_proxy_conn:
                self._prepare_proxy(conn)
    
            # Make the request on the httplib connection object.
            httplib_response = self._make_request(conn, method, url,
                                                  timeout=timeout_obj,
                                                  body=body, headers=headers,
                                                  chunked=chunked)
    
            # If we're going to release the connection in ``finally:``, then
            # the response doesn't need to know about the connection. Otherwise
            # it will also try to release it and we'll have a double-release
            # mess.
            response_conn = conn if not release_conn else None
    
            # Pass method to Response for length checking
            response_kw['request_method'] = method
    
            # Import httplib's response into our own wrapper object
            response = self.ResponseCls.from_httplib(httplib_response,
                                                     pool=self,
                                                     connection=response_conn,
                                                     retries=retries,
                                                     **response_kw)
    
            # Everything went great!
            clean_exit = True
    
        except queue.Empty:
            # Timed out by queue.
            raise EmptyPoolError(self, "No pool connections are available.")
    
        except (TimeoutError, HTTPException, SocketError, ProtocolError,
                BaseSSLError, SSLError, CertificateError) as e:
            # Discard the connection for these exceptions. It will be
            # replaced during the next _get_conn() call.
            clean_exit = False
            if isinstance(e, (BaseSSLError, CertificateError)):
                e = SSLError(e)
            elif isinstance(e, (SocketError, NewConnectionError)) and self.proxy:
                e = ProxyError('Cannot connect to proxy.', e)
            elif isinstance(e, (SocketError, HTTPException)):
                e = ProtocolError('Connection aborted.', e)
    
            retries = retries.increment(method, url, error=e, _pool=self,
>                                       _stacktrace=sys.exc_info()[2])

.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py:639: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = Retry(total=0, connect=None, read=False, redirect=None, status=None)
method = 'PUT', url = '/test-weko-item-v1.0.0', response = None
error = NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3c2c4908>: Failed to establish a new connection: [Errno 111] Connection refused',)
_pool = <urllib3.connectionpool.HTTPConnectionPool object at 0x7fde3d185fd0>
_stacktrace = <traceback object at 0x7fde3c6d0608>

    def increment(self, method=None, url=None, response=None, error=None,
                  _pool=None, _stacktrace=None):
        """ Return a new Retry object with incremented retry counters.
    
        :param response: A response object, or None, if the server did not
            return a response.
        :type response: :class:`~urllib3.response.HTTPResponse`
        :param Exception error: An error encountered during the request, or
            None if the response was received successfully.
    
        :return: A new ``Retry`` object.
        """
        if self.total is False and error:
            # Disabled, indicate to re-raise the error.
            raise six.reraise(type(error), error, _stacktrace)
    
        total = self.total
        if total is not None:
            total -= 1
    
        connect = self.connect
        read = self.read
        redirect = self.redirect
        status_count = self.status
        cause = 'unknown'
        status = None
        redirect_location = None
    
        if error and self._is_connection_error(error):
            # Connect retry?
            if connect is False:
                raise six.reraise(type(error), error, _stacktrace)
            elif connect is not None:
                connect -= 1
    
        elif error and self._is_read_error(error):
            # Read retry?
            if read is False or not self._is_method_retryable(method):
                raise six.reraise(type(error), error, _stacktrace)
            elif read is not None:
                read -= 1
    
        elif response and response.get_redirect_location():
            # Redirect retry?
            if redirect is not None:
                redirect -= 1
            cause = 'too many redirects'
            redirect_location = response.get_redirect_location()
            status = response.status
    
        else:
            # Incrementing because of a server error like a 500 in
            # status_forcelist and a the given method is in the whitelist
            cause = ResponseError.GENERIC_ERROR
            if response and response.status:
                if status_count is not None:
                    status_count -= 1
                cause = ResponseError.SPECIFIC_ERROR.format(
                    status_code=response.status)
                status = response.status
    
        history = self.history + (RequestHistory(method, url, error, status, redirect_location),)
    
        new_retry = self.new(
            total=total,
            connect=connect, read=read, redirect=redirect, status=status_count,
            history=history)
    
        if new_retry.is_exhausted():
>           raise MaxRetryError(_pool, url, error or ResponseError(cause))
E           urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3c2c4908>: Failed to establish a new connection: [Errno 111] Connection refused',))

.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py:388: MaxRetryError

During handling of the above exception, another exception occurred:

self = <RequestsHttpConnection: http://localhost:9200>, method = 'PUT'
url = 'http://localhost:9200/test-weko-item-v1.0.0', params = {}
body = b'{"settings":{"number_of_shards":1,"number_of_replicas":1,"index.mapping.total_fields.limit":50000,"analysis":{"token...":{"type":"text","index":false,"copy_to":"search_string","fields":{"raw":{"type":"keyword","ignore_above":256}}}}}]}}}'
timeout = None, ignore = (), headers = None

    def perform_request(self, method, url, params=None, body=None, timeout=None, ignore=(), headers=None):
        url = self.base_url + url
        if params:
            url = '%s?%s' % (url, urlencode(params or {}))
    
        start = time.time()
        request = requests.Request(method=method, headers=headers, url=url, data=body)
        prepared_request = self.session.prepare_request(request)
        settings = self.session.merge_environment_settings(prepared_request.url, {}, None, None, None)
        send_kwargs = {'timeout': timeout or self.timeout}
        send_kwargs.update(settings)
        try:
>           response = self.session.send(prepared_request, **send_kwargs)

.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py:76: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <requests.sessions.Session object at 0x7fde3e567860>
request = <PreparedRequest [PUT]>
kwargs = {'cert': None, 'proxies': OrderedDict(), 'stream': False, 'timeout': 120, ...}
allow_redirects = True, stream = False, hooks = {'response': []}
adapter = <requests.adapters.HTTPAdapter object at 0x7fde3e514908>
start = 1679693257.781715

    def send(self, request, **kwargs):
        """Send a given PreparedRequest.
    
        :rtype: requests.Response
        """
        # Set defaults that the hooks can utilize to ensure they always have
        # the correct parameters to reproduce the previous request.
        kwargs.setdefault('stream', self.stream)
        kwargs.setdefault('verify', self.verify)
        kwargs.setdefault('cert', self.cert)
        kwargs.setdefault('proxies', self.proxies)
    
        # It's possible that users might accidentally send a Request object.
        # Guard against that specific failure case.
        if isinstance(request, Request):
            raise ValueError('You can only send PreparedRequests.')
    
        # Set up variables needed for resolve_redirects and dispatching of hooks
        allow_redirects = kwargs.pop('allow_redirects', True)
        stream = kwargs.get('stream')
        hooks = request.hooks
    
        # Get the appropriate adapter to use
        adapter = self.get_adapter(url=request.url)
    
        # Start time (approximately) of the request
        start = preferred_clock()
    
        # Send the request
>       r = adapter.send(request, **kwargs)

.tox/c1/lib/python3.6/site-packages/requests/sessions.py:618: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <requests.adapters.HTTPAdapter object at 0x7fde3e514908>
request = <PreparedRequest [PUT]>, stream = False
timeout = <urllib3.util.timeout.Timeout object at 0x7fde3c2c4fd0>, verify = ''
cert = None, proxies = OrderedDict()

    def send(self, request, stream=False, timeout=None, verify=True, cert=None, proxies=None):
        """Sends PreparedRequest object. Returns Response object.
    
        :param request: The :class:`PreparedRequest <PreparedRequest>` being sent.
        :param stream: (optional) Whether to stream the request content.
        :param timeout: (optional) How long to wait for the server to send
            data before giving up, as a float, or a :ref:`(connect timeout,
            read timeout) <timeouts>` tuple.
        :type timeout: float or tuple or urllib3 Timeout object
        :param verify: (optional) Either a boolean, in which case it controls whether
            we verify the server's TLS certificate, or a string, in which case it
            must be a path to a CA bundle to use
        :param cert: (optional) Any user-provided SSL certificate to be trusted.
        :param proxies: (optional) The proxies dictionary to apply to the request.
        :rtype: requests.Response
        """
    
        conn = self.get_connection(request.url, proxies)
    
        self.cert_verify(conn, request.url, verify, cert)
        url = self.request_url(request, proxies)
        self.add_headers(request)
    
        chunked = not (request.body is None or 'Content-Length' in request.headers)
    
        if isinstance(timeout, tuple):
            try:
                connect, read = timeout
                timeout = TimeoutSauce(connect=connect, read=read)
            except ValueError as e:
                # this may raise a string formatting error.
                err = ("Invalid timeout {0}. Pass a (connect, read) "
                       "timeout tuple, or a single float to set "
                       "both timeouts to the same value".format(timeout))
                raise ValueError(err)
        elif isinstance(timeout, TimeoutSauce):
            pass
        else:
            timeout = TimeoutSauce(connect=timeout, read=timeout)
    
        try:
            if not chunked:
                resp = conn.urlopen(
                    method=request.method,
                    url=url,
                    body=request.body,
                    headers=request.headers,
                    redirect=False,
                    assert_same_host=False,
                    preload_content=False,
                    decode_content=False,
                    retries=self.max_retries,
                    timeout=timeout
                )
    
            # Send the request.
            else:
                if hasattr(conn, 'proxy_pool'):
                    conn = conn.proxy_pool
    
                low_conn = conn._get_conn(timeout=DEFAULT_POOL_TIMEOUT)
    
                try:
                    low_conn.putrequest(request.method,
                                        url,
                                        skip_accept_encoding=True)
    
                    for header, value in request.headers.items():
                        low_conn.putheader(header, value)
    
                    low_conn.endheaders()
    
                    for i in request.body:
                        low_conn.send(hex(len(i))[2:].encode('utf-8'))
                        low_conn.send(b'\r\n')
                        low_conn.send(i)
                        low_conn.send(b'\r\n')
                    low_conn.send(b'0\r\n\r\n')
    
                    # Receive the response from the server
                    try:
                        # For Python 2.7+ versions, use buffering of HTTP
                        # responses
                        r = low_conn.getresponse(buffering=True)
                    except TypeError:
                        # For compatibility with Python 2.6 versions and back
                        r = low_conn.getresponse()
    
                    resp = HTTPResponse.from_httplib(
                        r,
                        pool=conn,
                        connection=low_conn,
                        preload_content=False,
                        decode_content=False
                    )
                except:
                    # If we hit any problems here, clean up the connection.
                    # Then, reraise so that we can handle the actual exception.
                    low_conn.close()
                    raise
    
        except (ProtocolError, socket.error) as err:
            raise ConnectionError(err, request=request)
    
        except MaxRetryError as e:
            if isinstance(e.reason, ConnectTimeoutError):
                # TODO: Remove this in 3.0.0: see #2811
                if not isinstance(e.reason, NewConnectionError):
                    raise ConnectTimeout(e, request=request)
    
            if isinstance(e.reason, ResponseError):
                raise RetryError(e, request=request)
    
            if isinstance(e.reason, _ProxyError):
                raise ProxyError(e, request=request)
    
            if isinstance(e.reason, _SSLError):
                # This branch is for urllib3 v1.22 and later.
                raise SSLError(e, request=request)
    
>           raise ConnectionError(e, request=request)
E           requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3c2c4908>: Failed to establish a new connection: [Errno 111] Connection refused',))

.tox/c1/lib/python3.6/site-packages/requests/adapters.py:508: ConnectionError

During handling of the above exception, another exception occurred:

app = <Flask 'testapp'>
db_records = [(<PersistentIdentifier depid:1 / rec:59765e90-f1c6-40c5-8f10-d12aec95bea0 (R)>, <PersistentIdentifier recid:1 / rec:5...617258105262': {'resourceuri': 'http://purl.org/coar/resource_type/c_5794', 'resourcetype': 'conference paper'}}), ...]

    @pytest.fixture()
    def esindex(app,db_records):
        with open("tests/data/mappings/item-v1.0.0.json","r") as f:
            mapping = json.load(f)
    
        search = LocalProxy(lambda: app.extensions["invenio-search"])
    
        with app.test_request_context():
>           search.client.indices.create(app.config["INDEXER_DEFAULT_INDEX"],body=mapping)

tests/conftest.py:352: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.tox/c1/lib/python3.6/site-packages/elasticsearch/client/utils.py:76: in _wrapped
    return func(*args, params=params, **kwargs)
.tox/c1/lib/python3.6/site-packages/elasticsearch/client/indices.py:91: in create
    params=params, body=body)
.tox/c1/lib/python3.6/site-packages/elasticsearch/transport.py:314: in perform_request
    status, headers_response, data = connection.perform_request(method, url, params, body, headers=headers, ignore=ignore, timeout=timeout)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <RequestsHttpConnection: http://localhost:9200>, method = 'PUT'
url = 'http://localhost:9200/test-weko-item-v1.0.0', params = {}
body = b'{"settings":{"number_of_shards":1,"number_of_replicas":1,"index.mapping.total_fields.limit":50000,"analysis":{"token...":{"type":"text","index":false,"copy_to":"search_string","fields":{"raw":{"type":"keyword","ignore_above":256}}}}}]}}}'
timeout = None, ignore = (), headers = None

    def perform_request(self, method, url, params=None, body=None, timeout=None, ignore=(), headers=None):
        url = self.base_url + url
        if params:
            url = '%s?%s' % (url, urlencode(params or {}))
    
        start = time.time()
        request = requests.Request(method=method, headers=headers, url=url, data=body)
        prepared_request = self.session.prepare_request(request)
        settings = self.session.merge_environment_settings(prepared_request.url, {}, None, None, None)
        send_kwargs = {'timeout': timeout or self.timeout}
        send_kwargs.update(settings)
        try:
            response = self.session.send(prepared_request, **send_kwargs)
            duration = time.time() - start
            raw_data = response.text
        except Exception as e:
            self.log_request_fail(method, url, prepared_request.path_url, body, time.time() - start, exception=e)
            if isinstance(e, requests.exceptions.SSLError):
                raise SSLError('N/A', str(e), e)
            if isinstance(e, requests.Timeout):
                raise ConnectionTimeout('TIMEOUT', str(e), e)
>           raise ConnectionError('N/A', str(e), e)
E           elasticsearch.exceptions.ConnectionError: ConnectionError(HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3c2c4908>: Failed to establish a new connection: [Errno 111] Connection refused',))) caused by: ConnectionError(HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3c2c4908>: Failed to establish a new connection: [Errno 111] Connection refused',)))

.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py:85: ConnectionError
------------------------------ Captured log setup ------------------------------
WARNING  flask.app:ext.py:255 JSONSCHEMAS_HOST is set to localhost
WARNING  elasticsearch:base.py:97 PUT http://localhost:9200/test-weko-item-v1.0.0 [status:N/A request:0.002s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3bd9ab00>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bd9ab00>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bd9ab00>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 PUT http://localhost:9200/test-weko-item-v1.0.0 [status:N/A request:0.001s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3bd9c710>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bd9c710>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bd9c710>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 PUT http://localhost:9200/test-weko-item-v1.0.0 [status:N/A request:0.001s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3c4ba438>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3c4ba438>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3c4ba438>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 PUT http://localhost:9200/test-weko-item-v1.0.0 [status:N/A request:0.001s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3c4ba198>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3c4ba198>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3c4ba198>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 PUT http://localhost:9200/test-weko-item-v1.0.0 [status:N/A request:0.001s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3c8a1b38>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3c8a1b38>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3c8a1b38>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 PUT http://localhost:9200/test-weko-item-v1.0.0 [status:N/A request:0.001s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3bd2f198>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bd2f198>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bd2f198>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 PUT http://localhost:9200/test-weko-item-v1.0.0 [status:N/A request:0.001s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3bcc37b8>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bcc37b8>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bcc37b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 PUT http://localhost:9200/test-weko-item-v1.0.0 [status:N/A request:0.001s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3bcc31d0>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bcc31d0>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bcc31d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 PUT http://localhost:9200/test-weko-item-v1.0.0 [status:N/A request:0.002s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3c541550>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3c541550>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3c541550>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 PUT http://localhost:9200/test-weko-item-v1.0.0 [status:N/A request:0.001s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3c2c4438>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3c2c4438>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3c2c4438>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 PUT http://localhost:9200/test-weko-item-v1.0.0 [status:N/A request:0.001s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3c2c4908>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3c2c4908>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko-item-v1.0.0 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3c2c4908>: Failed to establish a new connection: [Errno 111] Connection refused',))
=================================== FAILURES ===================================
____________________ test_update_json_schema_by_activity_id ____________________

app = <Flask 'testapp'>

    def test_update_json_schema_by_activity_id(app):
        with open("tests/data/json_data.json", "r") as f:
            json_data = json.load(f)
            with app.test_request_context():
>               assert (
                    update_json_schema_by_activity_id(json_data, "A-00000000-00000") == None
                )

tests/test_utils.py:5084: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
weko_items_ui/utils.py:651: in update_json_schema_by_activity_id
    sessionstore = redis_connection.connection(db=current_app.config['ACCOUNTS_SESSION_REDIS_DB_NO'], kv = True)
../weko-redis/weko_redis/redis.py:40: in connection
    raise ex
../weko-redis/weko_redis/redis.py:36: in connection
    store = self.redis_connection(db)
../weko-redis/weko_redis/redis.py:55: in redis_connection
    raise ex
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <weko_redis.redis.RedisConnection object at 0x7fde3cde5518>, db = 1

    def redis_connection(self, db):
        store = None
        try:
>           redis_url = 'redis://' + current_app.config['CACHE_REDIS_HOST'] + ':' + current_app.config['REDIS_PORT'] + '/' + str(db)
E           TypeError: must be str, not NoneType

../weko-redis/weko_redis/redis.py:52: TypeError
------------------------------ Captured log setup ------------------------------
WARNING  flask.app:ext.py:255 JSONSCHEMAS_HOST is set to localhost
____________________ test_update_schema_form_by_activity_id ____________________

app = <Flask 'testapp'>
db_itemtype = {'item_type': <ItemType 1>, 'item_type_mapping': <ItemTypeMapping 1>, 'item_type_name': <ItemTypeName 1>}

    def test_update_schema_form_by_activity_id(app,db_itemtype):
        item_type = db_itemtype['item_type']
        with app.test_request_context():
>           assert update_schema_form_by_activity_id(item_type.form, "A-00000000-00000")==None

tests/test_utils.py:5101: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
weko_items_ui/utils.py:681: in update_schema_form_by_activity_id
    sessionstore = redis_connection.connection(db=current_app.config['ACCOUNTS_SESSION_REDIS_DB_NO'], kv = True)
../weko-redis/weko_redis/redis.py:40: in connection
    raise ex
../weko-redis/weko_redis/redis.py:36: in connection
    store = self.redis_connection(db)
../weko-redis/weko_redis/redis.py:55: in redis_connection
    raise ex
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <weko_redis.redis.RedisConnection object at 0x7fde3e385be0>, db = 1

    def redis_connection(self, db):
        store = None
        try:
>           redis_url = 'redis://' + current_app.config['CACHE_REDIS_HOST'] + ':' + current_app.config['REDIS_PORT'] + '/' + str(db)
E           TypeError: must be str, not NoneType

../weko-redis/weko_redis/redis.py:52: TypeError
------------------------------ Captured log setup ------------------------------
WARNING  flask.app:ext.py:255 JSONSCHEMAS_HOST is set to localhost
_____________________________ test_make_stats_file _____________________________

app = <Flask 'testapp'>
users = [{'email': 'contributor@test.org', 'id': 2, 'obj': <User 2>}, {'email': 'repoadmin@test.org', 'id': 4, 'obj': <User 4>...eneraluser@test.org', 'id': 6, 'obj': <User 5>}, {'email': 'originalroleuser@test.org', 'id': 7, 'obj': <User 7>}, ...]
db_itemtype = {'item_type': <ItemType 1>, 'item_type_mapping': <ItemTypeMapping 1>, 'item_type_name': <ItemTypeName 1>}
db_records = [(<PersistentIdentifier depid:1 / rec:f118046e-9ce6-44fe-b7a4-66f2eb3e891a (R)>, <PersistentIdentifier recid:1 / rec:f...617258105262': {'resourceuri': 'http://purl.org/coar/resource_type/c_5794', 'resourcetype': 'conference paper'}}), ...]
db_itemtype2 = {'item_type': <ItemType 2>, 'item_type_mapping': <ItemTypeMapping 2>, 'item_type_name': <ItemTypeName 2>}
db_records2 = [(<PersistentIdentifier depid:7 / rec:ed1f1117-f03a-4cd8-85a9-c50b346c30f7 (R)>, <PersistentIdentifier recid:7 / rec:e...jpn'}, 'item_1569380622649': {'resourceuri': 'http://purl.org/coar/resource_type/c_ddb1', 'resourcetype': 'dataset'}})]

    def test_make_stats_file(app, users,db_itemtype, db_records,db_itemtype2,db_records2):
        app.config.update(
            EMAIL_DISPLAY_FLG=True,
            WEKO_RECORDS_UI_LICENSE_DICT=[
                {
                    "name": "write your own license",
                    "value": "license_free",
                },
                # version 0
                {
                    "name": "Creative Commons CC0 1.0 Universal Public Domain Designation",
                    "code": "CC0",
                    "href_ja": "https://creativecommons.org/publicdomain/zero/1.0/deed.ja",
                    "href_default": "https://creativecommons.org/publicdomain/zero/1.0/",
                    "value": "license_12",
                    "src": "88x31(0).png",
                    "src_pdf": "cc-0.png",
                    "href_pdf": "https://creativecommons.org/publicdomain/zero/1.0/"
                    "deed.ja",
                    "txt": "This work is licensed under a Public Domain Dedication "
                    "International License.",
                },
                # version 3.0
                {
                    "name": "Creative Commons Attribution 3.0 Unported (CC BY 3.0)",
                    "code": "CC BY 3.0",
                    "href_ja": "https://creativecommons.org/licenses/by/3.0/deed.ja",
                    "href_default": "https://creativecommons.org/licenses/by/3.0/",
                    "value": "license_6",
                    "src": "88x31(1).png",
                    "src_pdf": "by.png",
                    "href_pdf": "http://creativecommons.org/licenses/by/3.0/",
                    "txt": "This work is licensed under a Creative Commons Attribution"
                    " 3.0 International License.",
                },
                {
                    "name": "Creative Commons Attribution-ShareAlike 3.0 Unported "
                    "(CC BY-SA 3.0)",
                    "code": "CC BY-SA 3.0",
                    "href_ja": "https://creativecommons.org/licenses/by-sa/3.0/deed.ja",
                    "href_default": "https://creativecommons.org/licenses/by-sa/3.0/",
                    "value": "license_7",
                    "src": "88x31(2).png",
                    "src_pdf": "by-sa.png",
                    "href_pdf": "http://creativecommons.org/licenses/by-sa/3.0/",
                    "txt": "This work is licensed under a Creative Commons Attribution"
                    "-ShareAlike 3.0 International License.",
                },
                {
                    "name": "Creative Commons Attribution-NoDerivs 3.0 Unported (CC BY-ND 3.0)",
                    "code": "CC BY-ND 3.0",
                    "href_ja": "https://creativecommons.org/licenses/by-nd/3.0/deed.ja",
                    "href_default": "https://creativecommons.org/licenses/by-nd/3.0/",
                    "value": "license_8",
                    "src": "88x31(3).png",
                    "src_pdf": "by-nd.png",
                    "href_pdf": "http://creativecommons.org/licenses/by-nd/3.0/",
                    "txt": "This work is licensed under a Creative Commons Attribution"
                    "-NoDerivatives 3.0 International License.",
                },
                {
                    "name": "Creative Commons Attribution-NonCommercial 3.0 Unported"
                    " (CC BY-NC 3.0)",
                    "code": "CC BY-NC 3.0",
                    "href_ja": "https://creativecommons.org/licenses/by-nc/3.0/deed.ja",
                    "href_default": "https://creativecommons.org/licenses/by-nc/3.0/",
                    "value": "license_9",
                    "src": "88x31(4).png",
                    "src_pdf": "by-nc.png",
                    "href_pdf": "http://creativecommons.org/licenses/by-nc/3.0/",
                    "txt": "This work is licensed under a Creative Commons Attribution"
                    "-NonCommercial 3.0 International License.",
                },
                {
                    "name": "Creative Commons Attribution-NonCommercial-ShareAlike 3.0 "
                    "Unported (CC BY-NC-SA 3.0)",
                    "code": "CC BY-NC-SA 3.0",
                    "href_ja": "https://creativecommons.org/licenses/by-nc-sa/3.0/deed.ja",
                    "href_default": "https://creativecommons.org/licenses/by-nc-sa/3.0/",
                    "value": "license_10",
                    "src": "88x31(5).png",
                    "src_pdf": "by-nc-sa.png",
                    "href_pdf": "http://creativecommons.org/licenses/by-nc-sa/3.0/",
                    "txt": "This work is licensed under a Creative Commons Attribution"
                    "-NonCommercial-ShareAlike 3.0 International License.",
                },
                {
                    "name": "Creative Commons Attribution-NonCommercial-NoDerivs "
                    "3.0 Unported (CC BY-NC-ND 3.0)",
                    "code": "CC BY-NC-ND 3.0",
                    "href_ja": "https://creativecommons.org/licenses/by-nc-nd/3.0/deed.ja",
                    "href_default": "https://creativecommons.org/licenses/by-nc-nd/3.0/",
                    "value": "license_11",
                    "src": "88x31(6).png",
                    "src_pdf": "by-nc-nd.png",
                    "href_pdf": "http://creativecommons.org/licenses/by-nc-nd/3.0/",
                    "txt": "This work is licensed under a Creative Commons Attribution"
                    "-NonCommercial-ShareAlike 3.0 International License.",
                },
                # version 4.0
                {
                    "name": "Creative Commons Attribution 4.0 International (CC BY 4.0)",
                    "code": "CC BY 4.0",
                    "href_ja": "https://creativecommons.org/licenses/by/4.0/deed.ja",
                    "href_default": "https://creativecommons.org/licenses/by/4.0/",
                    "value": "license_0",
                    "src": "88x31(1).png",
                    "src_pdf": "by.png",
                    "href_pdf": "http://creativecommons.org/licenses/by/4.0/",
                    "txt": "This work is licensed under a Creative Commons Attribution"
                    " 4.0 International License.",
                },
                {
                    "name": "Creative Commons Attribution-ShareAlike 4.0 International "
                    "(CC BY-SA 4.0)",
                    "code": "CC BY-SA 4.0",
                    "href_ja": "https://creativecommons.org/licenses/by-sa/4.0/deed.ja",
                    "href_default": "https://creativecommons.org/licenses/by-sa/4.0/",
                    "value": "license_1",
                    "src": "88x31(2).png",
                    "src_pdf": "by-sa.png",
                    "href_pdf": "http://creativecommons.org/licenses/by-sa/4.0/",
                    "txt": "This work is licensed under a Creative Commons Attribution"
                    "-ShareAlike 4.0 International License.",
                },
                {
                    "name": "Creative Commons Attribution-NoDerivatives 4.0 International "
                    "(CC BY-ND 4.0)",
                    "code": "CC BY-ND 4.0",
                    "href_ja": "https://creativecommons.org/licenses/by-nd/4.0/deed.ja",
                    "href_default": "https://creativecommons.org/licenses/by-nd/4.0/",
                    "value": "license_2",
                    "src": "88x31(3).png",
                    "src_pdf": "by-nd.png",
                    "href_pdf": "http://creativecommons.org/licenses/by-nd/4.0/",
                    "txt": "This work is licensed under a Creative Commons Attribution"
                    "-NoDerivatives 4.0 International License.",
                },
                {
                    "name": "Creative Commons Attribution-NonCommercial 4.0 International"
                    " (CC BY-NC 4.0)",
                    "code": "CC BY-NC 4.0",
                    "href_ja": "https://creativecommons.org/licenses/by-nc/4.0/deed.ja",
                    "href_default": "https://creativecommons.org/licenses/by-nc/4.0/",
                    "value": "license_3",
                    "src": "88x31(4).png",
                    "src_pdf": "by-nc.png",
                    "href_pdf": "http://creativecommons.org/licenses/by-nc/4.0/",
                    "txt": "This work is licensed under a Creative Commons Attribution"
                    "-NonCommercial 4.0 International License.",
                },
                {
                    "name": "Creative Commons Attribution-NonCommercial-ShareAlike 4.0"
                    " International (CC BY-NC-SA 4.0)",
                    "code": "CC BY-NC-SA 4.0",
                    "href_ja": "https://creativecommons.org/licenses/by-nc-sa/4.0/deed.ja",
                    "href_default": "https://creativecommons.org/licenses/by-nc-sa/4.0/",
                    "value": "license_4",
                    "src": "88x31(5).png",
                    "src_pdf": "by-nc-sa.png",
                    "href_pdf": "http://creativecommons.org/licenses/by-nc-sa/4.0/",
                    "txt": "This work is licensed under a Creative Commons Attribution"
                    "-NonCommercial-ShareAlike 4.0 International License.",
                },
                {
                    "name": "Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 "
                    "International (CC BY-NC-ND 4.0)",
                    "code": "CC BY-NC-ND 4.0",
                    "href_ja": "https://creativecommons.org/licenses/by-nc-nd/4.0/deed.ja",
                    "href_default": "https://creativecommons.org/licenses/by-nc-nd/4.0/",
                    "value": "license_5",
                    "src": "88x31(6).png",
                    "src_pdf": "by-nc-nd.png",
                    "href_pdf": "http://creativecommons.org/licenses/by-nc-nd/4.0/",
                    "txt": "This work is licensed under a Creative Commons Attribution"
                    "-NonCommercial-ShareAlike 4.0 International License.",
                },
            ],
        )
        item_types_data = {
            "1": {
                "item_type_id": "1",
                "name": "",
                "root_url": "https://localhost:8443/",
                "jsonschema": "items/jsonschema/1",
                "keys": [],
                "labels": [],
                "recids": [1],
                "data": {},
            }
        }
        item_type_id = 1
        list_item_role = {"1": {"weko_creator_id": "1", "weko_shared_id": -1}}
    
        with app.test_request_context():
>           assert make_stats_file(item_type_id, [1], list_item_role) == ([['#.id', '.uri', '.metadata.path[0]', '.pos_index[0]', '.publish_status', '.feedback_mail[0]', '.cnri', '.doi_ra', '.doi', '.edit_mode', '.metadata.pubdate', '.metadata.item_1617186331708[0].subitem_1551255647225', '.metadata.item_1617186331708[0].subitem_1551255648112', '.metadata.item_1617186385884[0].subitem_1551255720400', '.metadata.item_1617186385884[0].subitem_1551255721061', '.metadata.item_1617186419668[0].creatorAffiliations[0].affiliationNameIdentifiers[0].affiliationNameIdentifier', '.metadata.item_1617186419668[0].creatorAffiliations[0].affiliationNameIdentifiers[0].affiliationNameIdentifierScheme', '.metadata.item_1617186419668[0].creatorAffiliations[0].affiliationNameIdentifiers[0].affiliationNameIdentifierURI', '.metadata.item_1617186419668[0].creatorAffiliations[0].affiliationNames[0].affiliationName', '.metadata.item_1617186419668[0].creatorAffiliations[0].affiliationNames[0].affiliationNameLang', '.metadata.item_1617186419668[0].creatorAlternatives[0].creatorAlternative', '.metadata.item_1617186419668[0].creatorAlternatives[0].creatorAlternativeLang', '.metadata.item_1617186419668[0].creatorMails[0].creatorMail', '.metadata.item_1617186419668[0].creatorNames[0].creatorName', '.metadata.item_1617186419668[0].creatorNames[0].creatorNameLang', '.metadata.item_1617186419668[0].familyNames[0].familyName', '.metadata.item_1617186419668[0].familyNames[0].familyNameLang', '.metadata.item_1617186419668[0].givenNames[0].givenName', '.metadata.item_1617186419668[0].givenNames[0].givenNameLang', '.metadata.item_1617186419668[0].nameIdentifiers[0].nameIdentifier', '.metadata.item_1617186419668[0].nameIdentifiers[0].nameIdentifierScheme', '.metadata.item_1617186419668[0].nameIdentifiers[0].nameIdentifierURI', '.metadata.item_1617349709064[0].contributorAffiliations[0].contributorAffiliationNameIdentifiers[0].contributorAffiliationNameIdentifier', '.metadata.item_1617349709064[0].contributorAffiliations[0].contributorAffiliationNameIdentifiers[0].contributorAffiliationScheme', '.metadata.item_1617349709064[0].contributorAffiliations[0].contributorAffiliationNameIdentifiers[0].contributorAffiliationURI', '.metadata.item_1617349709064[0].contributorAffiliations[0].contributorAffiliationNames[0].contributorAffiliationName', '.metadata.item_1617349709064[0].contributorAffiliations[0].contributorAffiliationNames[0].contributorAffiliationNameLang', '.metadata.item_1617349709064[0].contributorAlternatives[0].contributorAlternative', '.metadata.item_1617349709064[0].contributorAlternatives[0].contributorAlternativeLang', '.metadata.item_1617349709064[0].contributorMails[0].contributorMail', '.metadata.item_1617349709064[0].contributorNames[0].contributorName', '.metadata.item_1617349709064[0].contributorNames[0].lang', '.metadata.item_1617349709064[0].contributorType', '.metadata.item_1617349709064[0].familyNames[0].familyName', '.metadata.item_1617349709064[0].familyNames[0].familyNameLang', '.metadata.item_1617349709064[0].givenNames[0].givenName', '.metadata.item_1617349709064[0].givenNames[0].givenNameLang', '.metadata.item_1617349709064[0].nameIdentifiers[0].nameIdentifier', '.metadata.item_1617349709064[0].nameIdentifiers[0].nameIdentifierScheme', '.metadata.item_1617349709064[0].nameIdentifiers[0].nameIdentifierURI', '.metadata.item_1617186476635.subitem_1522299639480', '.metadata.item_1617186476635.subitem_1600958577026', '.metadata.item_1617351524846.subitem_1523260933860', '.metadata.item_1617186499011[0].subitem_1522650717957', '.metadata.item_1617186499011[0].subitem_1522650727486', '.metadata.item_1617186499011[0].subitem_1522651041219', '.metadata.item_1617610673286[0].nameIdentifiers[0].nameIdentifier', '.metadata.item_1617610673286[0].nameIdentifiers[0].nameIdentifierScheme', '.metadata.item_1617610673286[0].nameIdentifiers[0].nameIdentifierURI', '.metadata.item_1617610673286[0].rightHolderNames[0].rightHolderLanguage', '.metadata.item_1617610673286[0].rightHolderNames[0].rightHolderName', '.metadata.item_1617186609386[0].subitem_1522299896455', '.metadata.item_1617186609386[0].subitem_1522300014469', '.metadata.item_1617186609386[0].subitem_1522300048512', '.metadata.item_1617186609386[0].subitem_1523261968819', '.metadata.item_1617186626617[0].subitem_description', '.metadata.item_1617186626617[0].subitem_description_language', '.metadata.item_1617186626617[0].subitem_description_type', '.metadata.item_1617186643794[0].subitem_1522300295150', '.metadata.item_1617186643794[0].subitem_1522300316516', '.metadata.item_1617186660861[0].subitem_1522300695726', '.metadata.item_1617186660861[0].subitem_1522300722591', '.metadata.item_1617186702042[0].subitem_1551255818386', '.metadata.item_1617258105262.resourcetype', '.metadata.item_1617258105262.resourceuri', '.metadata.item_1617349808926.subitem_1523263171732', '.metadata.item_1617265215918.subitem_1522305645492', '.metadata.item_1617265215918.subitem_1600292170262', '.metadata.item_1617186783814[0].subitem_identifier_type', '.metadata.item_1617186783814[0].subitem_identifier_uri', '.metadata.item_1617186819068.subitem_identifier_reg_text', '.metadata.item_1617186819068.subitem_identifier_reg_type', '.metadata.item_1617353299429[0].subitem_1522306207484', '.metadata.item_1617353299429[0].subitem_1522306287251.subitem_1522306382014', '.metadata.item_1617353299429[0].subitem_1522306287251.subitem_1522306436033', '.metadata.item_1617353299429[0].subitem_1523320863692[0].subitem_1523320867455', '.metadata.item_1617353299429[0].subitem_1523320863692[0].subitem_1523320909613', '.metadata.item_1617186859717[0].subitem_1522658018441', '.metadata.item_1617186859717[0].subitem_1522658031721', '.metadata.item_1617186882738[0].subitem_geolocation_box.subitem_east_longitude', '.metadata.item_1617186882738[0].subitem_geolocation_box.subitem_north_latitude', '.metadata.item_1617186882738[0].subitem_geolocation_box.subitem_south_latitude', '.metadata.item_1617186882738[0].subitem_geolocation_box.subitem_west_longitude', '.metadata.item_1617186882738[0].subitem_geolocation_place[0].subitem_geolocation_place_text', '.metadata.item_1617186882738[0].subitem_geolocation_point.subitem_point_latitude', '.metadata.item_1617186882738[0].subitem_geolocation_point.subitem_point_longitude', '.metadata.item_1617186901218[0].subitem_1522399143519.subitem_1522399281603', '.metadata.item_1617186901218[0].subitem_1522399143519.subitem_1522399333375', '.metadata.item_1617186901218[0].subitem_1522399412622[0].subitem_1522399416691', '.metadata.item_1617186901218[0].subitem_1522399412622[0].subitem_1522737543681', '.metadata.item_1617186901218[0].subitem_1522399571623.subitem_1522399585738', '.metadata.item_1617186901218[0].subitem_1522399571623.subitem_1522399628911', '.metadata.item_1617186901218[0].subitem_1522399651758[0].subitem_1522721910626', '.metadata.item_1617186901218[0].subitem_1522399651758[0].subitem_1522721929892', '.metadata.item_1617186920753[0].subitem_1522646500366', '.metadata.item_1617186920753[0].subitem_1522646572813', '.metadata.item_1617186941041[0].subitem_1522650068558', '.metadata.item_1617186941041[0].subitem_1522650091861', '.metadata.item_1617186959569.subitem_1551256328147', '.metadata.item_1617186981471.subitem_1551256294723', '.metadata.item_1617186994930.subitem_1551256248092', '.metadata.item_1617187024783.subitem_1551256198917', '.metadata.item_1617187045071.subitem_1551256185532', '.metadata.item_1617187056579.bibliographicIssueDates.bibliographicIssueDate', '.metadata.item_1617187056579.bibliographicIssueDates.bibliographicIssueDateType', '.metadata.item_1617187056579.bibliographicIssueNumber', '.metadata.item_1617187056579.bibliographicNumberOfPages', '.metadata.item_1617187056579.bibliographicPageEnd', '.metadata.item_1617187056579.bibliographicPageStart', '.metadata.item_1617187056579.bibliographicVolumeNumber', '.metadata.item_1617187056579.bibliographic_titles[0].bibliographic_title', '.metadata.item_1617187056579.bibliographic_titles[0].bibliographic_titleLang', '.metadata.item_1617187087799.subitem_1551256171004', '.metadata.item_1617187112279[0].subitem_1551256126428', '.metadata.item_1617187112279[0].subitem_1551256129013', '.metadata.item_1617187136212.subitem_1551256096004', '.metadata.item_1617944105607[0].subitem_1551256015892[0].subitem_1551256027296', '.metadata.item_1617944105607[0].subitem_1551256015892[0].subitem_1551256029891', '.metadata.item_1617944105607[0].subitem_1551256037922[0].subitem_1551256042287', '.metadata.item_1617944105607[0].subitem_1551256037922[0].subitem_1551256047619', '.metadata.item_1617187187528[0].subitem_1599711633003[0].subitem_1599711636923', '.metadata.item_1617187187528[0].subitem_1599711633003[0].subitem_1599711645590', '.metadata.item_1617187187528[0].subitem_1599711655652', '.metadata.item_1617187187528[0].subitem_1599711660052[0].subitem_1599711680082', '.metadata.item_1617187187528[0].subitem_1599711660052[0].subitem_1599711686511', '.metadata.item_1617187187528[0].subitem_1599711699392.subitem_1599711704251', '.metadata.item_1617187187528[0].subitem_1599711699392.subitem_1599711712451', '.metadata.item_1617187187528[0].subitem_1599711699392.subitem_1599711727603', '.metadata.item_1617187187528[0].subitem_1599711699392.subitem_1599711731891', '.metadata.item_1617187187528[0].subitem_1599711699392.subitem_1599711735410', '.metadata.item_1617187187528[0].subitem_1599711699392.subitem_1599711739022', '.metadata.item_1617187187528[0].subitem_1599711699392.subitem_1599711743722', '.metadata.item_1617187187528[0].subitem_1599711699392.subitem_1599711745532', '.metadata.item_1617187187528[0].subitem_1599711758470[0].subitem_1599711769260', '.metadata.item_1617187187528[0].subitem_1599711758470[0].subitem_1599711775943', '.metadata.item_1617187187528[0].subitem_1599711788485[0].subitem_1599711798761', '.metadata.item_1617187187528[0].subitem_1599711788485[0].subitem_1599711803382', '.metadata.item_1617187187528[0].subitem_1599711813532', '.file_path[0]', '.metadata.item_1617605131499[0].accessrole', '.metadata.item_1617605131499[0].date[0].dateType', '.metadata.item_1617605131499[0].date[0].dateValue', '.metadata.item_1617605131499[0].displaytype', '.metadata.item_1617605131499[0].fileDate[0].fileDateType', '.metadata.item_1617605131499[0].fileDate[0].fileDateValue', '.metadata.item_1617605131499[0].filename', '.metadata.item_1617605131499[0].filesize[0].value', '.metadata.item_1617605131499[0].format', '.metadata.item_1617605131499[0].groups', '.metadata.item_1617605131499[0].licensefree', '.metadata.item_1617605131499[0].licensetype', '.metadata.item_1617605131499[0].url.label', '.metadata.item_1617605131499[0].url.objectType', '.metadata.item_1617605131499[0].url.url', '.metadata.item_1617605131499[0].version', '.metadata.item_1617620223087[0].subitem_1565671149650', '.metadata.item_1617620223087[0].subitem_1565671169640', '.metadata.item_1617620223087[0].subitem_1565671178623', '.thumbnail_path[0]', '.metadata.item_1662046377046[0].subitem_thumbnail[0].thumbnail_label', '.metadata.item_1662046377046[0].subitem_thumbnail[0].thumbnail_url'], ['#ID', 'URI', '.IndexID[0]', '.POS_INDEX[0]', '.PUBLISH_STATUS', '.FEEDBACK_MAIL[0]', '.CNRI', '.DOI_RA', '.DOI', 'Keep/Upgrade Version', 'PubDate', 'Title[0].Title', 'Title[0].Language', 'Alternative Title[0].Alternative Title', 'Alternative Title[0].Language', 'Creator[0].[0].[0].', 'Creator[0].[0].[0].', 'Creator[0].[0].[0].URI', 'Creator[0].[0].[0].', 'Creator[0].[0].[0].', 'Creator[0].[0].', 'Creator[0].[0].', 'Creator[0].[0].', 'Creator[0].[0].', 'Creator[0].[0].', 'Creator[0].[0].', 'Creator[0].[0].', 'Creator[0].[0].', 'Creator[0].[0].', 'Creator[0].[0].', 'Creator[0].[0].Scheme', 'Creator[0].[0].URI', 'Contributor[0].[0].[0].', 'Contributor[0].[0].[0].', 'Contributor[0].[0].[0].URI', 'Contributor[0].[0].[0].', 'Contributor[0].[0].[0].', 'Contributor[0].[0].', 'Contributor[0].[0].', 'Contributor[0].[0].', 'Contributor[0].[0].', 'Contributor[0].[0].', 'Contributor[0].', 'Contributor[0].[0].', 'Contributor[0].[0].', 'Contributor[0].[0].', 'Contributor[0].[0].', 'Contributor[0].[0].', 'Contributor[0].[0].Scheme', 'Contributor[0].[0].URI', 'Access Rights.', 'Access Rights.URI', 'APC.APC', 'Rights[0].', 'Rights[0].Resource', 'Rights[0].', 'Rights Holder[0].[0].', 'Rights Holder[0].[0].Scheme', 'Rights Holder[0].[0].URI', 'Rights Holder[0].[0].', 'Rights Holder[0].[0].', 'Subject[0].', 'Subject[0].Scheme', 'Subject[0].URI', 'Subject[0].', 'Description[0].', 'Description[0].', 'Description[0].', 'Publisher[0].', 'Publisher[0].', 'Date[0].', 'Date[0].', 'Language[0].Language', 'Resource Type.', 'Resource Type.', 'Version.', 'Version Type.', 'Version Type.Resource', 'Identifier[0].', 'Identifier[0].', 'Identifier Registration.ID', 'Identifier Registration.ID', 'Relation[0].', 'Relation[0]..', 'Relation[0]..', 'Relation[0].[0].', 'Relation[0].[0].', 'Temporal[0].', 'Temporal[0].', 'Geo Location[0]..', 'Geo Location[0]..', 'Geo Location[0]..', 'Geo Location[0]..', 'Geo Location[0].[0].', 'Geo Location[0]..', 'Geo Location[0]..', 'Funding Reference[0]..', 'Funding Reference[0]..', 'Funding Reference[0].[0].', 'Funding Reference[0].[0].', 'Funding Reference[0]..URI', 'Funding Reference[0]..', 'Funding Reference[0].[0].', 'Funding Reference[0].[0].', 'Source Identifier[0].', 'Source Identifier[0].', 'Source Title[0].', 'Source Title[0].', 'Volume Number.Volume Number', 'Issue Number.Issue Number', 'Number of Pages.Number of Pages', 'Page Start.Page Start', 'Page End.Page End', 'Bibliographic Information..', 'Bibliographic Information..', 'Bibliographic Information.', 'Bibliographic Information.', 'Bibliographic Information.', 'Bibliographic Information.', 'Bibliographic Information.', 'Bibliographic Information.[0].', 'Bibliographic Information.[0].', 'Dissertation Number.Dissertation Number', 'Degree Name[0].Degree Name', 'Degree Name[0].Language', 'Date Granted.Date Granted', 'Degree Grantor[0].Degree Grantor Name Identifier[0].Degree Grantor Name Identifier', 'Degree Grantor[0].Degree Grantor Name Identifier[0].Degree Grantor Name Identifier Scheme', 'Degree Grantor[0].Degree Grantor Name[0].Degree Grantor Name', 'Degree Grantor[0].Degree Grantor Name[0].Language', 'Conference[0].Conference Name[0].Conference Name', 'Conference[0].Conference Name[0].Language', 'Conference[0].Conference Sequence', 'Conference[0].Conference Sponsor[0].Conference Sponsor', 'Conference[0].Conference Sponsor[0].Language', 'Conference[0].Conference Date.Conference Date', 'Conference[0].Conference Date.Start Day', 'Conference[0].Conference Date.Start Month', 'Conference[0].Conference Date.Start Year', 'Conference[0].Conference Date.End Day', 'Conference[0].Conference Date.End Month', 'Conference[0].Conference Date.End Year', 'Conference[0].Conference Date.Language', 'Conference[0].Conference Venue[0].Conference Venue', 'Conference[0].Conference Venue[0].Language', 'Conference[0].Conference Place[0].Conference Place', 'Conference[0].Conference Place[0].Language', 'Conference[0].Conference Country', '.[0]', 'File[0].', 'File[0].[0].', 'File[0].[0].', 'File[0].', 'File[0].[0].', 'File[0].[0].', 'File[0].', 'File[0].[0].', 'File[0].', 'File[0].', 'File[0].', 'File[0].', 'File[0].URL.', 'File[0].URL.', 'File[0].URL.URL', 'File[0].', 'Heading[0].Language', 'Heading[0].Banner Headline', 'Heading[0].Subheading', '.[0]', '[0].URI[0].', '[0].URI[0].URI'], ['#', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'System', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'System', '', '', 'System', '', '', 'System', 'System', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'System', 'System'], ['#', '', 'Allow Multiple', 'Allow Multiple', 'Required', 'Allow Multiple', '', '', '', 'Required', 'Required', 'Required, Allow Multiple', 'Required, Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', '', '', '', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Required', 'Required', '', '', '', 'Allow Multiple', 'Allow Multiple', '', '', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'Allow Multiple', 'Allow Multiple', '', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple']], {1: ['1', 'Index(public_state = True,harvest_public_state = True)', 'public', '', '', '', '', 'Keep', '2022-08-20', 'title', 'ja', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'conference paper', 'http://purl.org/coar/resource_type/c_5794', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '']})
E           AssertionError: assert ([['#.id', '....'', '', ...]}) == ([['#.id', '....'', '', ...]})
E             At index 1 diff: {1: [1, 'Index(public_state = True,harvest_public_state = True)', 'public', '', '', '', '', 'Keep', '2022-08-20', 'title', 'ja', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'conference paper', 'http://purl.org/coar/resource_type/c_5794', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '...
E             
E             ...Full output truncated (861 lines hidden), use '-vv' to show

tests/test_utils.py:6798: AssertionError
------------------------------ Captured log setup ------------------------------
WARNING  flask.app:ext.py:255 JSONSCHEMAS_HOST is set to localhost
_______________________ test_make_stats_file_issue33432 ________________________

app = <Flask 'testapp'>
users = [{'email': 'contributor@test.org', 'id': 2, 'obj': <User 2>}, {'email': 'repoadmin@test.org', 'id': 4, 'obj': <User 4>...eneraluser@test.org', 'id': 6, 'obj': <User 5>}, {'email': 'originalroleuser@test.org', 'id': 7, 'obj': <User 7>}, ...]
db_itemtype = {'item_type': <ItemType 1>, 'item_type_mapping': <ItemTypeMapping 1>, 'item_type_name': <ItemTypeName 1>}
db_records = [(<PersistentIdentifier depid:1 / rec:fbef2bc2-439a-4ecf-9021-ddd58d7e1b61 (R)>, <PersistentIdentifier recid:1 / rec:f...617258105262': {'resourceuri': 'http://purl.org/coar/resource_type/c_5794', 'resourcetype': 'conference paper'}}), ...]
db_itemtype2 = {'item_type': <ItemType 2>, 'item_type_mapping': <ItemTypeMapping 2>, 'item_type_name': <ItemTypeName 2>}
db_records2 = [(<PersistentIdentifier depid:7 / rec:e84d0484-4d33-41e3-b3e6-38f2ba621c3a (R)>, <PersistentIdentifier recid:7 / rec:e...jpn'}, 'item_1569380622649': {'resourceuri': 'http://purl.org/coar/resource_type/c_ddb1', 'resourcetype': 'dataset'}})]

    def test_make_stats_file_issue33432(app, users,db_itemtype, db_records,db_itemtype2,db_records2):
        app.config.update(
            EMAIL_DISPLAY_FLG=True,
            WEKO_RECORDS_UI_LICENSE_DICT=[
                {
                    "name": "write your own license",
                    "value": "license_free",
                },
                # version 0
                {
                    "name": "Creative Commons CC0 1.0 Universal Public Domain Designation",
                    "code": "CC0",
                    "href_ja": "https://creativecommons.org/publicdomain/zero/1.0/deed.ja",
                    "href_default": "https://creativecommons.org/publicdomain/zero/1.0/",
                    "value": "license_12",
                    "src": "88x31(0).png",
                    "src_pdf": "cc-0.png",
                    "href_pdf": "https://creativecommons.org/publicdomain/zero/1.0/"
                    "deed.ja",
                    "txt": "This work is licensed under a Public Domain Dedication "
                    "International License.",
                },
                # version 3.0
                {
                    "name": "Creative Commons Attribution 3.0 Unported (CC BY 3.0)",
                    "code": "CC BY 3.0",
                    "href_ja": "https://creativecommons.org/licenses/by/3.0/deed.ja",
                    "href_default": "https://creativecommons.org/licenses/by/3.0/",
                    "value": "license_6",
                    "src": "88x31(1).png",
                    "src_pdf": "by.png",
                    "href_pdf": "http://creativecommons.org/licenses/by/3.0/",
                    "txt": "This work is licensed under a Creative Commons Attribution"
                    " 3.0 International License.",
                },
                {
                    "name": "Creative Commons Attribution-ShareAlike 3.0 Unported "
                    "(CC BY-SA 3.0)",
                    "code": "CC BY-SA 3.0",
                    "href_ja": "https://creativecommons.org/licenses/by-sa/3.0/deed.ja",
                    "href_default": "https://creativecommons.org/licenses/by-sa/3.0/",
                    "value": "license_7",
                    "src": "88x31(2).png",
                    "src_pdf": "by-sa.png",
                    "href_pdf": "http://creativecommons.org/licenses/by-sa/3.0/",
                    "txt": "This work is licensed under a Creative Commons Attribution"
                    "-ShareAlike 3.0 International License.",
                },
                {
                    "name": "Creative Commons Attribution-NoDerivs 3.0 Unported (CC BY-ND 3.0)",
                    "code": "CC BY-ND 3.0",
                    "href_ja": "https://creativecommons.org/licenses/by-nd/3.0/deed.ja",
                    "href_default": "https://creativecommons.org/licenses/by-nd/3.0/",
                    "value": "license_8",
                    "src": "88x31(3).png",
                    "src_pdf": "by-nd.png",
                    "href_pdf": "http://creativecommons.org/licenses/by-nd/3.0/",
                    "txt": "This work is licensed under a Creative Commons Attribution"
                    "-NoDerivatives 3.0 International License.",
                },
                {
                    "name": "Creative Commons Attribution-NonCommercial 3.0 Unported"
                    " (CC BY-NC 3.0)",
                    "code": "CC BY-NC 3.0",
                    "href_ja": "https://creativecommons.org/licenses/by-nc/3.0/deed.ja",
                    "href_default": "https://creativecommons.org/licenses/by-nc/3.0/",
                    "value": "license_9",
                    "src": "88x31(4).png",
                    "src_pdf": "by-nc.png",
                    "href_pdf": "http://creativecommons.org/licenses/by-nc/3.0/",
                    "txt": "This work is licensed under a Creative Commons Attribution"
                    "-NonCommercial 3.0 International License.",
                },
                {
                    "name": "Creative Commons Attribution-NonCommercial-ShareAlike 3.0 "
                    "Unported (CC BY-NC-SA 3.0)",
                    "code": "CC BY-NC-SA 3.0",
                    "href_ja": "https://creativecommons.org/licenses/by-nc-sa/3.0/deed.ja",
                    "href_default": "https://creativecommons.org/licenses/by-nc-sa/3.0/",
                    "value": "license_10",
                    "src": "88x31(5).png",
                    "src_pdf": "by-nc-sa.png",
                    "href_pdf": "http://creativecommons.org/licenses/by-nc-sa/3.0/",
                    "txt": "This work is licensed under a Creative Commons Attribution"
                    "-NonCommercial-ShareAlike 3.0 International License.",
                },
                {
                    "name": "Creative Commons Attribution-NonCommercial-NoDerivs "
                    "3.0 Unported (CC BY-NC-ND 3.0)",
                    "code": "CC BY-NC-ND 3.0",
                    "href_ja": "https://creativecommons.org/licenses/by-nc-nd/3.0/deed.ja",
                    "href_default": "https://creativecommons.org/licenses/by-nc-nd/3.0/",
                    "value": "license_11",
                    "src": "88x31(6).png",
                    "src_pdf": "by-nc-nd.png",
                    "href_pdf": "http://creativecommons.org/licenses/by-nc-nd/3.0/",
                    "txt": "This work is licensed under a Creative Commons Attribution"
                    "-NonCommercial-ShareAlike 3.0 International License.",
                },
                # version 4.0
                {
                    "name": "Creative Commons Attribution 4.0 International (CC BY 4.0)",
                    "code": "CC BY 4.0",
                    "href_ja": "https://creativecommons.org/licenses/by/4.0/deed.ja",
                    "href_default": "https://creativecommons.org/licenses/by/4.0/",
                    "value": "license_0",
                    "src": "88x31(1).png",
                    "src_pdf": "by.png",
                    "href_pdf": "http://creativecommons.org/licenses/by/4.0/",
                    "txt": "This work is licensed under a Creative Commons Attribution"
                    " 4.0 International License.",
                },
                {
                    "name": "Creative Commons Attribution-ShareAlike 4.0 International "
                    "(CC BY-SA 4.0)",
                    "code": "CC BY-SA 4.0",
                    "href_ja": "https://creativecommons.org/licenses/by-sa/4.0/deed.ja",
                    "href_default": "https://creativecommons.org/licenses/by-sa/4.0/",
                    "value": "license_1",
                    "src": "88x31(2).png",
                    "src_pdf": "by-sa.png",
                    "href_pdf": "http://creativecommons.org/licenses/by-sa/4.0/",
                    "txt": "This work is licensed under a Creative Commons Attribution"
                    "-ShareAlike 4.0 International License.",
                },
                {
                    "name": "Creative Commons Attribution-NoDerivatives 4.0 International "
                    "(CC BY-ND 4.0)",
                    "code": "CC BY-ND 4.0",
                    "href_ja": "https://creativecommons.org/licenses/by-nd/4.0/deed.ja",
                    "href_default": "https://creativecommons.org/licenses/by-nd/4.0/",
                    "value": "license_2",
                    "src": "88x31(3).png",
                    "src_pdf": "by-nd.png",
                    "href_pdf": "http://creativecommons.org/licenses/by-nd/4.0/",
                    "txt": "This work is licensed under a Creative Commons Attribution"
                    "-NoDerivatives 4.0 International License.",
                },
                {
                    "name": "Creative Commons Attribution-NonCommercial 4.0 International"
                    " (CC BY-NC 4.0)",
                    "code": "CC BY-NC 4.0",
                    "href_ja": "https://creativecommons.org/licenses/by-nc/4.0/deed.ja",
                    "href_default": "https://creativecommons.org/licenses/by-nc/4.0/",
                    "value": "license_3",
                    "src": "88x31(4).png",
                    "src_pdf": "by-nc.png",
                    "href_pdf": "http://creativecommons.org/licenses/by-nc/4.0/",
                    "txt": "This work is licensed under a Creative Commons Attribution"
                    "-NonCommercial 4.0 International License.",
                },
                {
                    "name": "Creative Commons Attribution-NonCommercial-ShareAlike 4.0"
                    " International (CC BY-NC-SA 4.0)",
                    "code": "CC BY-NC-SA 4.0",
                    "href_ja": "https://creativecommons.org/licenses/by-nc-sa/4.0/deed.ja",
                    "href_default": "https://creativecommons.org/licenses/by-nc-sa/4.0/",
                    "value": "license_4",
                    "src": "88x31(5).png",
                    "src_pdf": "by-nc-sa.png",
                    "href_pdf": "http://creativecommons.org/licenses/by-nc-sa/4.0/",
                    "txt": "This work is licensed under a Creative Commons Attribution"
                    "-NonCommercial-ShareAlike 4.0 International License.",
                },
                {
                    "name": "Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 "
                    "International (CC BY-NC-ND 4.0)",
                    "code": "CC BY-NC-ND 4.0",
                    "href_ja": "https://creativecommons.org/licenses/by-nc-nd/4.0/deed.ja",
                    "href_default": "https://creativecommons.org/licenses/by-nc-nd/4.0/",
                    "value": "license_5",
                    "src": "88x31(6).png",
                    "src_pdf": "by-nc-nd.png",
                    "href_pdf": "http://creativecommons.org/licenses/by-nc-nd/4.0/",
                    "txt": "This work is licensed under a Creative Commons Attribution"
                    "-NonCommercial-ShareAlike 4.0 International License.",
                },
            ],
        )
        item_types_data = {
            "2": {
                "item_type_id": "2",
                "name": "2",
                "root_url": "https://localhost:8443/",
                "jsonschema": "items/jsonschema/2",
                "keys": [],
                "labels": [],
                "recids": [7],
                "data": {},
            }
        }
        item_type_id = 2
        list_item_role = {"2": {"weko_creator_id": "1", "weko_shared_id": -1}}
    
        with app.test_request_context():
>           assert make_stats_file(item_type_id, [7], list_item_role) == ([['#.id', '.uri', '.metadata.path[0]', '.pos_index[0]', '.publish_status', '.feedback_mail[0]', '.cnri', '.doi_ra', '.doi', '.edit_mode', '.metadata.pubdate', '.metadata.item_1554883918421.subitem_1551255647225', '.metadata.item_1554883918421.subitem_1551255648112', '.metadata.item_1554883961001.subitem_1551255818386', '.metadata.item_1554884042490.subitem_1522299896455', '.metadata.item_1554884042490.subitem_1522300014469', '.metadata.item_1554884042490.subitem_1522300048512', '.metadata.item_1554884042490.subitem_1523261968819', '.metadata.item_1532070986701.creatorAffiliations[0].affiliationNameIdentifiers[0].affiliationNameIdentifier', '.metadata.item_1532070986701.creatorAffiliations[0].affiliationNameIdentifiers[0].affiliationNameIdentifierScheme', '.metadata.item_1532070986701.creatorAffiliations[0].affiliationNameIdentifiers[0].affiliationNameIdentifierURI', '.metadata.item_1532070986701.creatorAffiliations[0].affiliationNames[0].affiliationName', '.metadata.item_1532070986701.creatorAffiliations[0].affiliationNames[0].affiliationNameLang', '.metadata.item_1532070986701.creatorAlternatives[0].creatorAlternative', '.metadata.item_1532070986701.creatorAlternatives[0].creatorAlternativeLang', '.metadata.item_1532070986701.creatorMails[0].creatorMail', '.metadata.item_1532070986701.creatorNames[0].creatorName', '.metadata.item_1532070986701.creatorNames[0].creatorNameLang', '.metadata.item_1532070986701.familyNames[0].familyName', '.metadata.item_1532070986701.familyNames[0].familyNameLang', '.metadata.item_1532070986701.givenNames[0].givenName', '.metadata.item_1532070986701.givenNames[0].givenNameLang', '.metadata.item_1532070986701.nameIdentifiers[0].nameIdentifier', '.metadata.item_1532070986701.nameIdentifiers[0].nameIdentifierScheme', '.metadata.item_1532070986701.nameIdentifiers[0].nameIdentifierURI', '.metadata.item_1532071014836.contributorAffiliations[0].contributorAffiliationNameIdentifiers[0].contributorAffiliationNameIdentifier', '.metadata.item_1532071014836.contributorAffiliations[0].contributorAffiliationNameIdentifiers[0].contributorAffiliationScheme', '.metadata.item_1532071014836.contributorAffiliations[0].contributorAffiliationNameIdentifiers[0].contributorAffiliationURI', '.metadata.item_1532071014836.contributorAffiliations[0].contributorAffiliationNames[0].contributorAffiliationName', '.metadata.item_1532071014836.contributorAffiliations[0].contributorAffiliationNames[0].contributorAffiliationNameLang', '.metadata.item_1532071014836.contributorAlternatives[0].contributorAlternative', '.metadata.item_1532071014836.contributorAlternatives[0].contributorAlternativeLang', '.metadata.item_1532071014836.contributorMails[0].contributorMail', '.metadata.item_1532071014836.contributorNames[0].contributorName', '.metadata.item_1532071014836.contributorNames[0].lang', '.metadata.item_1532071014836.contributorType', '.metadata.item_1532071014836.familyNames[0].familyName', '.metadata.item_1532071014836.familyNames[0].familyNameLang', '.metadata.item_1532071014836.givenNames[0].givenName', '.metadata.item_1532071014836.givenNames[0].givenNameLang', '.metadata.item_1532071014836.nameIdentifiers[0].nameIdentifier', '.metadata.item_1532071014836.nameIdentifiers[0].nameIdentifierScheme', '.metadata.item_1532071014836.nameIdentifiers[0].nameIdentifierURI', '.metadata.item_1532071031458.subitem_1522299639480', '.metadata.item_1532071031458.subitem_1600958577026', '.metadata.item_1532071039842[0].subitem_1522650717957', '.metadata.item_1532071039842[0].subitem_1522650727486', '.metadata.item_1532071039842[0].subitem_1522651041219', '.metadata.item_1532071057095[0].subitem_1522299896455', '.metadata.item_1532071057095[0].subitem_1522300014469', '.metadata.item_1532071057095[0].subitem_1522300048512', '.metadata.item_1532071057095[0].subitem_1523261968819', '.metadata.item_1532071068215[0].subitem_1522657647525', '.metadata.item_1532071068215[0].subitem_1522657697257', '.metadata.item_1532071068215[0].subitem_1523262169140', '.metadata.item_1532071093517[0].subitem_1522300295150', '.metadata.item_1532071093517[0].subitem_1522300316516', '.metadata.item_1532071103206[0].subitem_1522300695726', '.metadata.item_1532071103206[0].subitem_1522300722591', '.metadata.item_1569380622649.resourcetype', '.metadata.item_1569380622649.resourceuri', '.metadata.item_1581493352241.subitem_1569224170590', '.metadata.item_1581493352241.subitem_1569224172438', '.metadata.item_1532071133483', '.metadata.item_1532071158138[0].subitem_1522306207484', '.metadata.item_1532071158138[0].subitem_1522306287251.subitem_1522306382014', '.metadata.item_1532071158138[0].subitem_1522306287251.subitem_1522306436033', '.metadata.item_1532071158138[0].subitem_1523320863692[0].subitem_1523320867455', '.metadata.item_1532071158138[0].subitem_1523320863692[0].subitem_1523320909613', '.metadata.item_1532071168802[0].subitem_1522658018441', '.metadata.item_1532071168802[0].subitem_1522658031721', '.metadata.item_1532071184504[0].subitem_1522658250154.subitem_1522658252485', '.metadata.item_1532071184504[0].subitem_1522658250154.subitem_1522658264346', '.metadata.item_1532071184504[0].subitem_1522658250154.subitem_1522658270105', '.metadata.item_1532071184504[0].subitem_1522658250154.subitem_1522658274386', '.metadata.item_1532071184504[0].subitem_1523321394401.subitem_1523321400758', '.metadata.item_1532071184504[0].subitem_1523321394401.subitem_1523321450098', '.metadata.item_1532071184504[0].subitem_1523321527273', '.metadata.item_1532071200841[0].subitem_1522399143519.subitem_1522399281603', '.metadata.item_1532071200841[0].subitem_1522399143519.subitem_1522399333375', '.metadata.item_1532071200841[0].subitem_1522399412622[0].subitem_1522399416691', '.metadata.item_1532071200841[0].subitem_1522399412622[0].subitem_1522737543681', '.metadata.item_1532071200841[0].subitem_1522399571623.subitem_1522399585738', '.metadata.item_1532071200841[0].subitem_1522399571623.subitem_1522399628911', '.metadata.item_1532071200841[0].subitem_1522399651758[0].subitem_1522721910626', '.metadata.item_1532071200841[0].subitem_1522399651758[0].subitem_1522721929892', '.metadata.item_1532071216312[0].subitem_1522652546580.subitem_1522652548920', '.metadata.item_1532071216312[0].subitem_1522652546580.subitem_1522652672693', '.metadata.item_1532071216312[0].subitem_1522652546580.subitem_1522652685531', '.metadata.item_1532071216312[0].subitem_1522652734962', '.metadata.item_1532071216312[0].subitem_1522652740098[0].subitem_1522722119299', '.metadata.item_1532071216312[0].subitem_1522652747880[0].subitem_1522722132466', '.metadata.item_1532071216312[0].subitem_1522652747880[0].subitem_1522739295711', '.metadata.item_1532071216312[0].subitem_1523325300505', '.file_path[0]', '.metadata.item_1600165182071[0].accessrole', '.metadata.item_1600165182071[0].date[0].dateType', '.metadata.item_1600165182071[0].date[0].dateValue', '.metadata.item_1600165182071[0].displaytype', '.metadata.item_1600165182071[0].filename', '.metadata.item_1600165182071[0].filesize[0].value', '.metadata.item_1600165182071[0].format', '.metadata.item_1600165182071[0].groupsprice[0].group', '.metadata.item_1600165182071[0].groupsprice[0].price', '.metadata.item_1600165182071[0].is_billing', '.metadata.item_1600165182071[0].licensefree', '.metadata.item_1600165182071[0].licensetype', '.metadata.item_1600165182071[0].url.label', '.metadata.item_1600165182071[0].url.objectType', '.metadata.item_1600165182071[0].url.url', '.metadata.item_1600165182071[0].version'], ['#ID', 'URI', '.IndexID[0]', '.POS_INDEX[0]', '.PUBLISH_STATUS', '.FEEDBACK_MAIL[0]', '.CNRI', '.DOI_RA', '.DOI', 'Keep/Upgrade Version', 'PubDate', 'Title.Title', 'Title.Language', 'Language.Language', 'Keyword.', 'Keyword.Scheme', 'Keyword.URI', 'Keyword.', 'Creator.[0].[0].', 'Creator.[0].[0].', 'Creator.[0].[0].URI', 'Creator.[0].[0].', 'Creator.[0].[0].', 'Creator.[0].', 'Creator.[0].', 'Creator.[0].', 'Creator.[0].', 'Creator.[0].', 'Creator.[0].', 'Creator.[0].', 'Creator.[0].', 'Creator.[0].', 'Creator.[0].', 'Creator.[0].Scheme', 'Creator.[0].URI', 'Contributor.[0].[0].', 'Contributor.[0].[0].', 'Contributor.[0].[0].URI', 'Contributor.[0].[0].', 'Contributor.[0].[0].', 'Contributor.[0].', 'Contributor.[0].', 'Contributor.[0].', 'Contributor.[0].', 'Contributor.[0].', 'Contributor.', 'Contributor.[0].', 'Contributor.[0].', 'Contributor.[0]. ', 'Contributor.[0].', 'Contributor.[0].', 'Contributor.[0].Scheme', 'Contributor.[0].URI', 'Access Rights.', 'Access Rights.URI', 'Rights Information[0].', 'Rights Information[0].Resource', 'Rights Information[0].', 'Subject[0].', 'Subject[0].Scheme', 'Subject[0].URI', 'Subject[0].', 'Content Description[0].', 'Content Description[0].', 'Content Description[0].', 'Publisher[0].', 'Publisher[0].', 'Date[0].', 'Date[0].', 'Resource Type.Type', 'Resource Type.Resource', 'Identifier rRegistration.Identifier Registration', 'Identifier rRegistration.Identifier Registration Type', 'Version information', 'Related information[0].', 'Related information[0]..', 'Related information[0]..', 'Related information[0].[0].', 'Related information[0].[0].', 'Time Range[0].', 'Time Range[0].', 'Location Information[0].. ', 'Location Information[0]..', 'Location Information[0]..', 'Location Information[0]..', 'Location Information[0]..', 'Location Information[0]..', 'Location Information[0].', 'Grant information[0]..', 'Grant information[0]..', 'Grant information[0]. [0].', 'Grant information[0]. [0].', 'Grant information[0]..URI', 'Grant information[0]..', 'Grant information[0].[0].', 'Grant information[0].[0]. ', 'File Information[0].URL.', 'File Information[0].URL.', 'File Information[0].URL.URL', 'File Information[0].', 'File Information[0].[0].', 'File Information[0].[0].', 'File Information[0].[0].', 'File Information[0].', '.[0]', 'Billing File Information[0].', 'Billing File Information[0].[0].', 'Billing File Information[0].[0].', 'Billing File Information[0].', 'Billing File Information[0].', 'Billing File Information[0].[0].', 'Billing File Information[0]. ', 'Billing File Information[0].[0].', 'Billing File Information[0].[0].', 'Billing File Information[0].Is Billing', 'Billing File Information[0].', 'Billing File Information[0].', 'Billing File Information[0].URL.', 'Billing File Information[0].URL. ', 'Billing File Information[0].URL.URL', 'Billing File Information[0].'], ['#', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'System', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'System', 'System', 'System', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['#', '', 'Allow Multiple', 'Allow Multiple', 'Required', 'Allow Multiple', '', '', '', 'Required', 'Required', 'Required', 'Required', 'Required', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Required', 'Required', '', '', '', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple']], {7: ['1', 'Index(public_state = True,harvest_public_state = True)', 'public', '', '', '', '', 'Keep', '2022-08-25', '', 'ja', 'jpn', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'A', 'ja', '', '', 'repoadmin@test.org', '', 'ja', 'ContactPerson', '', '', '', '', '', '', '', 'open access', 'http://purl.org/coar/access_right/c_abf2', 'ja', 'CC0', '', 'ja', 'NDC', '', '', 'abstract', '', 'ja', '', '', '', '', 'dataset', 'http://purl.org/coar/resource_type/c_ddb1', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'Crossref Funder', 'https://dx.doi.org/10.13039/501100001863', 'ja', 'NEDO', '', '12345678', 'ja', '', '', '', '', '', '1GB', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '']})
E           AssertionError: assert ([['#.id', '....'', '', ...]}) == ([['#.id', '....'', '', ...]})
E             At index 1 diff: {7: [1, 'Index(public_state = True,harvest_public_state = True)', 'public', '', '', '', '', 'Keep', '2022-08-25', '', 'ja', 'jpn', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'A', 'ja', '', '', 'repoadmin@test.org', '', 'ja', 'ContactPerson', '', '', '', '', '', '', '', 'open access', 'http://purl.org/coar/access_right/c_abf2', 'ja', 'CC0', '', 'ja', 'NDC', '', '', 'abstract', '...
E             
E             ...Full output truncated (609 lines hidden), use '-vv' to show

tests/test_utils.py:6999: AssertionError
------------------------------ Captured log setup ------------------------------
WARNING  flask.app:ext.py:255 JSONSCHEMAS_HOST is set to localhost
___________________________ test_write_bibtex_files ____________________________

db_oaischema = None

    def test_write_bibtex_files(db_oaischema):
        item_types_data = {
            "15": {
                "item_type_id": "15",
                "name": "(15)",
                "root_url": "https://localhost:8443/",
                "jsonschema": "items/jsonschema/15",
                "keys": [],
                "labels": [],
                "recids": [1],
                "data": {},
            }
        }
        export_path = "/tmp/weko_export_agvb5jc9/20220827140620"
>       assert write_bibtex_files(item_types_data, export_path)

tests/test_utils.py:7224: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
weko_items_ui/utils.py:1371: in write_bibtex_files
    output = make_bibtex_data(item_type_data['recids'])
weko_items_ui/utils.py:2404: in make_bibtex_data
    from weko_schema_ui.serializers import WekoBibTexSerializer
../weko-schema-ui/weko_schema_ui/serializers/__init__.py:62: in <module>
    BibTexSerializer = WekoBibTexSerializer()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <weko_schema_ui.serializers.WekoBibTexSerializer.WekoBibTexSerializer object at 0x7fde3c7dda58>

    def __init__(self):
        """Init."""
        # Load namespace
        self.__ns = cache_schema('jpcoar_mapping').get('namespaces')
        self.__lst_identifier_type = ['doi', 'hdl', 'url']
        # JPCOAR elements
>       jp_jp = '{' + self.__ns['jpcoar'] + '}'
E       KeyError: 'jpcoar'

../weko-schema-ui/weko_schema_ui/serializers/WekoBibTexSerializer.py:133: KeyError
------------------------------ Captured log setup ------------------------------
WARNING  flask.app:ext.py:255 JSONSCHEMAS_HOST is set to localhost
__________________________ test_get_new_items_by_date __________________________

self = <urllib3.connection.HTTPConnection object at 0x7fde3bd97160>

    def _new_conn(self):
        """ Establish a socket connection and set nodelay settings on it.
    
        :return: New socket connection.
        """
        extra_kw = {}
        if self.source_address:
            extra_kw['source_address'] = self.source_address
    
        if self.socket_options:
            extra_kw['socket_options'] = self.socket_options
    
        try:
            conn = connection.create_connection(
>               (self.host, self.port), self.timeout, **extra_kw)

.tox/c1/lib/python3.6/site-packages/urllib3/connection.py:141: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

address = ('localhost', 9200), timeout = 120, source_address = None
socket_options = [(6, 1, 1)]

    def create_connection(address, timeout=socket._GLOBAL_DEFAULT_TIMEOUT,
                          source_address=None, socket_options=None):
        """Connect to *address* and return the socket object.
    
        Convenience function.  Connect to *address* (a 2-tuple ``(host,
        port)``) and return the socket object.  Passing the optional
        *timeout* parameter will set the timeout on the socket instance
        before attempting to connect.  If no *timeout* is supplied, the
        global default timeout setting returned by :func:`getdefaulttimeout`
        is used.  If *source_address* is set it must be a tuple of (host, port)
        for the socket to bind as a source address before making the connection.
        An host of '' or port 0 tells the OS to use the default.
        """
    
        host, port = address
        if host.startswith('['):
            host = host.strip('[]')
        err = None
    
        # Using the value from allowed_gai_family() in the context of getaddrinfo lets
        # us select whether to work with IPv4 DNS records, IPv6 records, or both.
        # The original create_connection function always returns all records.
        family = allowed_gai_family()
    
        for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
            af, socktype, proto, canonname, sa = res
            sock = None
            try:
                sock = socket.socket(af, socktype, proto)
    
                # If provided, set socket level options before connecting.
                _set_socket_options(sock, socket_options)
    
                if timeout is not socket._GLOBAL_DEFAULT_TIMEOUT:
                    sock.settimeout(timeout)
                if source_address:
                    sock.bind(source_address)
                sock.connect(sa)
                return sock
    
            except socket.error as e:
                err = e
                if sock is not None:
                    sock.close()
                    sock = None
    
        if err is not None:
>           raise err

.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py:83: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

address = ('localhost', 9200), timeout = 120, source_address = None
socket_options = [(6, 1, 1)]

    def create_connection(address, timeout=socket._GLOBAL_DEFAULT_TIMEOUT,
                          source_address=None, socket_options=None):
        """Connect to *address* and return the socket object.
    
        Convenience function.  Connect to *address* (a 2-tuple ``(host,
        port)``) and return the socket object.  Passing the optional
        *timeout* parameter will set the timeout on the socket instance
        before attempting to connect.  If no *timeout* is supplied, the
        global default timeout setting returned by :func:`getdefaulttimeout`
        is used.  If *source_address* is set it must be a tuple of (host, port)
        for the socket to bind as a source address before making the connection.
        An host of '' or port 0 tells the OS to use the default.
        """
    
        host, port = address
        if host.startswith('['):
            host = host.strip('[]')
        err = None
    
        # Using the value from allowed_gai_family() in the context of getaddrinfo lets
        # us select whether to work with IPv4 DNS records, IPv6 records, or both.
        # The original create_connection function always returns all records.
        family = allowed_gai_family()
    
        for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
            af, socktype, proto, canonname, sa = res
            sock = None
            try:
                sock = socket.socket(af, socktype, proto)
    
                # If provided, set socket level options before connecting.
                _set_socket_options(sock, socket_options)
    
                if timeout is not socket._GLOBAL_DEFAULT_TIMEOUT:
                    sock.settimeout(timeout)
                if source_address:
                    sock.bind(source_address)
>               sock.connect(sa)
E               ConnectionRefusedError: [Errno 111] Connection refused

.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py:73: ConnectionRefusedError

During handling of the above exception, another exception occurred:

self = <urllib3.connectionpool.HTTPConnectionPool object at 0x7fde3bd2f2b0>
method = 'GET', url = '/test-weko/_search'
body = b'{"query":{"bool":{"must":[{"query_string":{"query":"_type:record-v1.0.0 AND relation_version_is_last:true  AND publi...h":"2"}}]}}],"must_not":[{"match":{"publish_status":"-1"}}]}},"sort":[{"publish_date":{"order":"desc"}}],"size":10000}'
headers = {'content-type': 'application/json', 'Content-Length': '356'}
retries = Retry(total=0, connect=None, read=False, redirect=None, status=None)
redirect = False, assert_same_host = False
timeout = <urllib3.util.timeout.Timeout object at 0x7fde3bdcae80>
pool_timeout = None, release_conn = False, chunked = False, body_pos = None
response_kw = {'decode_content': False, 'preload_content': False}, conn = None
release_this_conn = True, err = None, clean_exit = False
timeout_obj = <urllib3.util.timeout.Timeout object at 0x7fde3bd97e80>
is_new_proxy_conn = False

    def urlopen(self, method, url, body=None, headers=None, retries=None,
                redirect=True, assert_same_host=True, timeout=_Default,
                pool_timeout=None, release_conn=None, chunked=False,
                body_pos=None, **response_kw):
        """
        Get a connection from the pool and perform an HTTP request. This is the
        lowest level call for making a request, so you'll need to specify all
        the raw details.
    
        .. note::
    
           More commonly, it's appropriate to use a convenience method provided
           by :class:`.RequestMethods`, such as :meth:`request`.
    
        .. note::
    
           `release_conn` will only behave as expected if
           `preload_content=False` because we want to make
           `preload_content=False` the default behaviour someday soon without
           breaking backwards compatibility.
    
        :param method:
            HTTP request method (such as GET, POST, PUT, etc.)
    
        :param body:
            Data to send in the request body (useful for creating
            POST requests, see HTTPConnectionPool.post_url for
            more convenience).
    
        :param headers:
            Dictionary of custom headers to send, such as User-Agent,
            If-None-Match, etc. If None, pool headers are used. If provided,
            these headers completely replace any pool-specific headers.
    
        :param retries:
            Configure the number of retries to allow before raising a
            :class:`~urllib3.exceptions.MaxRetryError` exception.
    
            Pass ``None`` to retry until you receive a response. Pass a
            :class:`~urllib3.util.retry.Retry` object for fine-grained control
            over different types of retries.
            Pass an integer number to retry connection errors that many times,
            but no other types of errors. Pass zero to never retry.
    
            If ``False``, then retries are disabled and any exception is raised
            immediately. Also, instead of raising a MaxRetryError on redirects,
            the redirect response will be returned.
    
        :type retries: :class:`~urllib3.util.retry.Retry`, False, or an int.
    
        :param redirect:
            If True, automatically handle redirects (status codes 301, 302,
            303, 307, 308). Each redirect counts as a retry. Disabling retries
            will disable redirect, too.
    
        :param assert_same_host:
            If ``True``, will make sure that the host of the pool requests is
            consistent else will raise HostChangedError. When False, you can
            use the pool on an HTTP proxy and request foreign hosts.
    
        :param timeout:
            If specified, overrides the default timeout for this one
            request. It may be a float (in seconds) or an instance of
            :class:`urllib3.util.Timeout`.
    
        :param pool_timeout:
            If set and the pool is set to block=True, then this method will
            block for ``pool_timeout`` seconds and raise EmptyPoolError if no
            connection is available within the time period.
    
        :param release_conn:
            If False, then the urlopen call will not release the connection
            back into the pool once a response is received (but will release if
            you read the entire contents of the response such as when
            `preload_content=True`). This is useful if you're not preloading
            the response's content immediately. You will need to call
            ``r.release_conn()`` on the response ``r`` to return the connection
            back into the pool. If None, it takes the value of
            ``response_kw.get('preload_content', True)``.
    
        :param chunked:
            If True, urllib3 will send the body using chunked transfer
            encoding. Otherwise, urllib3 will send the body using the standard
            content-length form. Defaults to False.
    
        :param int body_pos:
            Position to seek to in file-like body in the event of a retry or
            redirect. Typically this won't need to be set because urllib3 will
            auto-populate the value when needed.
    
        :param \\**response_kw:
            Additional parameters are passed to
            :meth:`urllib3.response.HTTPResponse.from_httplib`
        """
        if headers is None:
            headers = self.headers
    
        if not isinstance(retries, Retry):
            retries = Retry.from_int(retries, redirect=redirect, default=self.retries)
    
        if release_conn is None:
            release_conn = response_kw.get('preload_content', True)
    
        # Check host
        if assert_same_host and not self.is_same_host(url):
            raise HostChangedError(self, url, retries)
    
        conn = None
    
        # Track whether `conn` needs to be released before
        # returning/raising/recursing. Update this variable if necessary, and
        # leave `release_conn` constant throughout the function. That way, if
        # the function recurses, the original value of `release_conn` will be
        # passed down into the recursive call, and its value will be respected.
        #
        # See issue #651 [1] for details.
        #
        # [1] <https://github.com/shazow/urllib3/issues/651>
        release_this_conn = release_conn
    
        # Merge the proxy headers. Only do this in HTTP. We have to copy the
        # headers dict so we can safely change it without those changes being
        # reflected in anyone else's copy.
        if self.scheme == 'http':
            headers = headers.copy()
            headers.update(self.proxy_headers)
    
        # Must keep the exception bound to a separate variable or else Python 3
        # complains about UnboundLocalError.
        err = None
    
        # Keep track of whether we cleanly exited the except block. This
        # ensures we do proper cleanup in finally.
        clean_exit = False
    
        # Rewind body position, if needed. Record current position
        # for future rewinds in the event of a redirect/retry.
        body_pos = set_file_position(body, body_pos)
    
        try:
            # Request a connection from the queue.
            timeout_obj = self._get_timeout(timeout)
            conn = self._get_conn(timeout=pool_timeout)
    
            conn.timeout = timeout_obj.connect_timeout
    
            is_new_proxy_conn = self.proxy is not None and not getattr(conn, 'sock', None)
            if is_new_proxy_conn:
                self._prepare_proxy(conn)
    
            # Make the request on the httplib connection object.
            httplib_response = self._make_request(conn, method, url,
                                                  timeout=timeout_obj,
                                                  body=body, headers=headers,
>                                                 chunked=chunked)

.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py:601: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <urllib3.connectionpool.HTTPConnectionPool object at 0x7fde3bd2f2b0>
conn = <urllib3.connection.HTTPConnection object at 0x7fde3bd97160>
method = 'GET', url = '/test-weko/_search'
timeout = <urllib3.util.timeout.Timeout object at 0x7fde3bd97e80>
chunked = False
httplib_request_kw = {'body': b'{"query":{"bool":{"must":[{"query_string":{"query":"_type:record-v1.0.0 AND relation_version_is_last:true  ...lish_date":{"order":"desc"}}],"size":10000}', 'headers': {'content-type': 'application/json', 'Content-Length': '356'}}
timeout_obj = <urllib3.util.timeout.Timeout object at 0x7fde3bd97470>

    def _make_request(self, conn, method, url, timeout=_Default, chunked=False,
                      **httplib_request_kw):
        """
        Perform a request on a given urllib connection object taken from our
        pool.
    
        :param conn:
            a connection from one of our connection pools
    
        :param timeout:
            Socket timeout in seconds for the request. This can be a
            float or integer, which will set the same timeout value for
            the socket connect and the socket read, or an instance of
            :class:`urllib3.util.Timeout`, which gives you more fine-grained
            control over your timeouts.
        """
        self.num_requests += 1
    
        timeout_obj = self._get_timeout(timeout)
        timeout_obj.start_connect()
        conn.timeout = timeout_obj.connect_timeout
    
        # Trigger any extra validation we need to do.
        try:
            self._validate_conn(conn)
        except (SocketTimeout, BaseSSLError) as e:
            # Py2 raises this as a BaseSSLError, Py3 raises it as socket timeout.
            self._raise_timeout(err=e, url=url, timeout_value=conn.timeout)
            raise
    
        # conn.request() calls httplib.*.request, not the method in
        # urllib3.request. It also calls makefile (recv) on the socket.
        if chunked:
            conn.request_chunked(method, url, **httplib_request_kw)
        else:
>           conn.request(method, url, **httplib_request_kw)

.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py:357: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <urllib3.connection.HTTPConnection object at 0x7fde3bd97160>
method = 'GET', url = '/test-weko/_search'
body = b'{"query":{"bool":{"must":[{"query_string":{"query":"_type:record-v1.0.0 AND relation_version_is_last:true  AND publi...h":"2"}}]}}],"must_not":[{"match":{"publish_status":"-1"}}]}},"sort":[{"publish_date":{"order":"desc"}}],"size":10000}'
headers = {'content-type': 'application/json', 'Content-Length': '356'}

    def request(self, method, url, body=None, headers={}, *,
                encode_chunked=False):
        """Send a complete request to the server."""
>       self._send_request(method, url, body, headers, encode_chunked)

/usr/local/lib/python3.6/http/client.py:1291: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <urllib3.connection.HTTPConnection object at 0x7fde3bd97160>
method = 'GET', url = '/test-weko/_search'
body = b'{"query":{"bool":{"must":[{"query_string":{"query":"_type:record-v1.0.0 AND relation_version_is_last:true  AND publi...h":"2"}}]}}],"must_not":[{"match":{"publish_status":"-1"}}]}},"sort":[{"publish_date":{"order":"desc"}}],"size":10000}'
headers = {'content-type': 'application/json', 'Content-Length': '356'}
encode_chunked = False

    def _send_request(self, method, url, body, headers, encode_chunked):
        # Honor explicitly requested Host: and Accept-Encoding: headers.
        header_names = frozenset(k.lower() for k in headers)
        skips = {}
        if 'host' in header_names:
            skips['skip_host'] = 1
        if 'accept-encoding' in header_names:
            skips['skip_accept_encoding'] = 1
    
        self.putrequest(method, url, **skips)
    
        # chunked encoding will happen if HTTP/1.1 is used and either
        # the caller passes encode_chunked=True or the following
        # conditions hold:
        # 1. content-length has not been explicitly set
        # 2. the body is a file or iterable, but not a str or bytes-like
        # 3. Transfer-Encoding has NOT been explicitly set by the caller
    
        if 'content-length' not in header_names:
            # only chunk body if not explicitly set for backwards
            # compatibility, assuming the client code is already handling the
            # chunking
            if 'transfer-encoding' not in header_names:
                # if content-length cannot be automatically determined, fall
                # back to chunked encoding
                encode_chunked = False
                content_length = self._get_content_length(body, method)
                if content_length is None:
                    if body is not None:
                        if self.debuglevel > 0:
                            print('Unable to determine size of %r' % body)
                        encode_chunked = True
                        self.putheader('Transfer-Encoding', 'chunked')
                else:
                    self.putheader('Content-Length', str(content_length))
        else:
            encode_chunked = False
    
        for hdr, value in headers.items():
            self.putheader(hdr, value)
        if isinstance(body, str):
            # RFC 2616 Section 3.7.1 says that text default has a
            # default charset of iso-8859-1.
            body = _encode(body, 'body')
>       self.endheaders(body, encode_chunked=encode_chunked)

/usr/local/lib/python3.6/http/client.py:1337: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <urllib3.connection.HTTPConnection object at 0x7fde3bd97160>
message_body = b'{"query":{"bool":{"must":[{"query_string":{"query":"_type:record-v1.0.0 AND relation_version_is_last:true  AND publi...h":"2"}}]}}],"must_not":[{"match":{"publish_status":"-1"}}]}},"sort":[{"publish_date":{"order":"desc"}}],"size":10000}'

    def endheaders(self, message_body=None, *, encode_chunked=False):
        """Indicate that the last header line has been sent to the server.
    
        This method sends the request to the server.  The optional message_body
        argument can be used to pass a message body associated with the
        request.
        """
        if self.__state == _CS_REQ_STARTED:
            self.__state = _CS_REQ_SENT
        else:
            raise CannotSendHeader()
>       self._send_output(message_body, encode_chunked=encode_chunked)

/usr/local/lib/python3.6/http/client.py:1286: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <urllib3.connection.HTTPConnection object at 0x7fde3bd97160>
message_body = b'{"query":{"bool":{"must":[{"query_string":{"query":"_type:record-v1.0.0 AND relation_version_is_last:true  AND publi...h":"2"}}]}}],"must_not":[{"match":{"publish_status":"-1"}}]}},"sort":[{"publish_date":{"order":"desc"}}],"size":10000}'
encode_chunked = False

    def _send_output(self, message_body=None, encode_chunked=False):
        """Send the currently buffered request and clear the buffer.
    
        Appends an extra \\r\\n to the buffer.
        A message_body may be specified, to be appended to the request.
        """
        self._buffer.extend((b"", b""))
        msg = b"\r\n".join(self._buffer)
        del self._buffer[:]
>       self.send(msg)

/usr/local/lib/python3.6/http/client.py:1046: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <urllib3.connection.HTTPConnection object at 0x7fde3bd97160>
data = b'GET /test-weko/_search HTTP/1.1\r\nHost: localhost:9200\r\nAccept-Encoding: identity\r\ncontent-type: application/json\r\nContent-Length: 356\r\n\r\n'

    def send(self, data):
        """Send `data' to the server.
        ``data`` can be a string object, a bytes object, an array object, a
        file-like object that supports a .read() method, or an iterable object.
        """
    
        if self.sock is None:
            if self.auto_open:
>               self.connect()

/usr/local/lib/python3.6/http/client.py:984: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <urllib3.connection.HTTPConnection object at 0x7fde3bd97160>

    def connect(self):
>       conn = self._new_conn()

.tox/c1/lib/python3.6/site-packages/urllib3/connection.py:166: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <urllib3.connection.HTTPConnection object at 0x7fde3bd97160>

    def _new_conn(self):
        """ Establish a socket connection and set nodelay settings on it.
    
        :return: New socket connection.
        """
        extra_kw = {}
        if self.source_address:
            extra_kw['source_address'] = self.source_address
    
        if self.socket_options:
            extra_kw['socket_options'] = self.socket_options
    
        try:
            conn = connection.create_connection(
                (self.host, self.port), self.timeout, **extra_kw)
    
        except SocketTimeout as e:
            raise ConnectTimeoutError(
                self, "Connection to %s timed out. (connect timeout=%s)" %
                (self.host, self.timeout))
    
        except SocketError as e:
            raise NewConnectionError(
>               self, "Failed to establish a new connection: %s" % e)
E           urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3bd97160>: Failed to establish a new connection: [Errno 111] Connection refused

.tox/c1/lib/python3.6/site-packages/urllib3/connection.py:150: NewConnectionError

During handling of the above exception, another exception occurred:

self = <requests.adapters.HTTPAdapter object at 0x7fde3bd2ff98>
request = <PreparedRequest [GET]>, stream = False
timeout = <urllib3.util.timeout.Timeout object at 0x7fde3bdcae80>, verify = ''
cert = None, proxies = OrderedDict()

    def send(self, request, stream=False, timeout=None, verify=True, cert=None, proxies=None):
        """Sends PreparedRequest object. Returns Response object.
    
        :param request: The :class:`PreparedRequest <PreparedRequest>` being sent.
        :param stream: (optional) Whether to stream the request content.
        :param timeout: (optional) How long to wait for the server to send
            data before giving up, as a float, or a :ref:`(connect timeout,
            read timeout) <timeouts>` tuple.
        :type timeout: float or tuple or urllib3 Timeout object
        :param verify: (optional) Either a boolean, in which case it controls whether
            we verify the server's TLS certificate, or a string, in which case it
            must be a path to a CA bundle to use
        :param cert: (optional) Any user-provided SSL certificate to be trusted.
        :param proxies: (optional) The proxies dictionary to apply to the request.
        :rtype: requests.Response
        """
    
        conn = self.get_connection(request.url, proxies)
    
        self.cert_verify(conn, request.url, verify, cert)
        url = self.request_url(request, proxies)
        self.add_headers(request)
    
        chunked = not (request.body is None or 'Content-Length' in request.headers)
    
        if isinstance(timeout, tuple):
            try:
                connect, read = timeout
                timeout = TimeoutSauce(connect=connect, read=read)
            except ValueError as e:
                # this may raise a string formatting error.
                err = ("Invalid timeout {0}. Pass a (connect, read) "
                       "timeout tuple, or a single float to set "
                       "both timeouts to the same value".format(timeout))
                raise ValueError(err)
        elif isinstance(timeout, TimeoutSauce):
            pass
        else:
            timeout = TimeoutSauce(connect=timeout, read=timeout)
    
        try:
            if not chunked:
                resp = conn.urlopen(
                    method=request.method,
                    url=url,
                    body=request.body,
                    headers=request.headers,
                    redirect=False,
                    assert_same_host=False,
                    preload_content=False,
                    decode_content=False,
                    retries=self.max_retries,
>                   timeout=timeout
                )

.tox/c1/lib/python3.6/site-packages/requests/adapters.py:440: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <urllib3.connectionpool.HTTPConnectionPool object at 0x7fde3bd2f2b0>
method = 'GET', url = '/test-weko/_search'
body = b'{"query":{"bool":{"must":[{"query_string":{"query":"_type:record-v1.0.0 AND relation_version_is_last:true  AND publi...h":"2"}}]}}],"must_not":[{"match":{"publish_status":"-1"}}]}},"sort":[{"publish_date":{"order":"desc"}}],"size":10000}'
headers = {'content-type': 'application/json', 'Content-Length': '356'}
retries = Retry(total=0, connect=None, read=False, redirect=None, status=None)
redirect = False, assert_same_host = False
timeout = <urllib3.util.timeout.Timeout object at 0x7fde3bdcae80>
pool_timeout = None, release_conn = False, chunked = False, body_pos = None
response_kw = {'decode_content': False, 'preload_content': False}, conn = None
release_this_conn = True, err = None, clean_exit = False
timeout_obj = <urllib3.util.timeout.Timeout object at 0x7fde3bd97e80>
is_new_proxy_conn = False

    def urlopen(self, method, url, body=None, headers=None, retries=None,
                redirect=True, assert_same_host=True, timeout=_Default,
                pool_timeout=None, release_conn=None, chunked=False,
                body_pos=None, **response_kw):
        """
        Get a connection from the pool and perform an HTTP request. This is the
        lowest level call for making a request, so you'll need to specify all
        the raw details.
    
        .. note::
    
           More commonly, it's appropriate to use a convenience method provided
           by :class:`.RequestMethods`, such as :meth:`request`.
    
        .. note::
    
           `release_conn` will only behave as expected if
           `preload_content=False` because we want to make
           `preload_content=False` the default behaviour someday soon without
           breaking backwards compatibility.
    
        :param method:
            HTTP request method (such as GET, POST, PUT, etc.)
    
        :param body:
            Data to send in the request body (useful for creating
            POST requests, see HTTPConnectionPool.post_url for
            more convenience).
    
        :param headers:
            Dictionary of custom headers to send, such as User-Agent,
            If-None-Match, etc. If None, pool headers are used. If provided,
            these headers completely replace any pool-specific headers.
    
        :param retries:
            Configure the number of retries to allow before raising a
            :class:`~urllib3.exceptions.MaxRetryError` exception.
    
            Pass ``None`` to retry until you receive a response. Pass a
            :class:`~urllib3.util.retry.Retry` object for fine-grained control
            over different types of retries.
            Pass an integer number to retry connection errors that many times,
            but no other types of errors. Pass zero to never retry.
    
            If ``False``, then retries are disabled and any exception is raised
            immediately. Also, instead of raising a MaxRetryError on redirects,
            the redirect response will be returned.
    
        :type retries: :class:`~urllib3.util.retry.Retry`, False, or an int.
    
        :param redirect:
            If True, automatically handle redirects (status codes 301, 302,
            303, 307, 308). Each redirect counts as a retry. Disabling retries
            will disable redirect, too.
    
        :param assert_same_host:
            If ``True``, will make sure that the host of the pool requests is
            consistent else will raise HostChangedError. When False, you can
            use the pool on an HTTP proxy and request foreign hosts.
    
        :param timeout:
            If specified, overrides the default timeout for this one
            request. It may be a float (in seconds) or an instance of
            :class:`urllib3.util.Timeout`.
    
        :param pool_timeout:
            If set and the pool is set to block=True, then this method will
            block for ``pool_timeout`` seconds and raise EmptyPoolError if no
            connection is available within the time period.
    
        :param release_conn:
            If False, then the urlopen call will not release the connection
            back into the pool once a response is received (but will release if
            you read the entire contents of the response such as when
            `preload_content=True`). This is useful if you're not preloading
            the response's content immediately. You will need to call
            ``r.release_conn()`` on the response ``r`` to return the connection
            back into the pool. If None, it takes the value of
            ``response_kw.get('preload_content', True)``.
    
        :param chunked:
            If True, urllib3 will send the body using chunked transfer
            encoding. Otherwise, urllib3 will send the body using the standard
            content-length form. Defaults to False.
    
        :param int body_pos:
            Position to seek to in file-like body in the event of a retry or
            redirect. Typically this won't need to be set because urllib3 will
            auto-populate the value when needed.
    
        :param \\**response_kw:
            Additional parameters are passed to
            :meth:`urllib3.response.HTTPResponse.from_httplib`
        """
        if headers is None:
            headers = self.headers
    
        if not isinstance(retries, Retry):
            retries = Retry.from_int(retries, redirect=redirect, default=self.retries)
    
        if release_conn is None:
            release_conn = response_kw.get('preload_content', True)
    
        # Check host
        if assert_same_host and not self.is_same_host(url):
            raise HostChangedError(self, url, retries)
    
        conn = None
    
        # Track whether `conn` needs to be released before
        # returning/raising/recursing. Update this variable if necessary, and
        # leave `release_conn` constant throughout the function. That way, if
        # the function recurses, the original value of `release_conn` will be
        # passed down into the recursive call, and its value will be respected.
        #
        # See issue #651 [1] for details.
        #
        # [1] <https://github.com/shazow/urllib3/issues/651>
        release_this_conn = release_conn
    
        # Merge the proxy headers. Only do this in HTTP. We have to copy the
        # headers dict so we can safely change it without those changes being
        # reflected in anyone else's copy.
        if self.scheme == 'http':
            headers = headers.copy()
            headers.update(self.proxy_headers)
    
        # Must keep the exception bound to a separate variable or else Python 3
        # complains about UnboundLocalError.
        err = None
    
        # Keep track of whether we cleanly exited the except block. This
        # ensures we do proper cleanup in finally.
        clean_exit = False
    
        # Rewind body position, if needed. Record current position
        # for future rewinds in the event of a redirect/retry.
        body_pos = set_file_position(body, body_pos)
    
        try:
            # Request a connection from the queue.
            timeout_obj = self._get_timeout(timeout)
            conn = self._get_conn(timeout=pool_timeout)
    
            conn.timeout = timeout_obj.connect_timeout
    
            is_new_proxy_conn = self.proxy is not None and not getattr(conn, 'sock', None)
            if is_new_proxy_conn:
                self._prepare_proxy(conn)
    
            # Make the request on the httplib connection object.
            httplib_response = self._make_request(conn, method, url,
                                                  timeout=timeout_obj,
                                                  body=body, headers=headers,
                                                  chunked=chunked)
    
            # If we're going to release the connection in ``finally:``, then
            # the response doesn't need to know about the connection. Otherwise
            # it will also try to release it and we'll have a double-release
            # mess.
            response_conn = conn if not release_conn else None
    
            # Pass method to Response for length checking
            response_kw['request_method'] = method
    
            # Import httplib's response into our own wrapper object
            response = self.ResponseCls.from_httplib(httplib_response,
                                                     pool=self,
                                                     connection=response_conn,
                                                     retries=retries,
                                                     **response_kw)
    
            # Everything went great!
            clean_exit = True
    
        except queue.Empty:
            # Timed out by queue.
            raise EmptyPoolError(self, "No pool connections are available.")
    
        except (TimeoutError, HTTPException, SocketError, ProtocolError,
                BaseSSLError, SSLError, CertificateError) as e:
            # Discard the connection for these exceptions. It will be
            # replaced during the next _get_conn() call.
            clean_exit = False
            if isinstance(e, (BaseSSLError, CertificateError)):
                e = SSLError(e)
            elif isinstance(e, (SocketError, NewConnectionError)) and self.proxy:
                e = ProxyError('Cannot connect to proxy.', e)
            elif isinstance(e, (SocketError, HTTPException)):
                e = ProtocolError('Connection aborted.', e)
    
            retries = retries.increment(method, url, error=e, _pool=self,
>                                       _stacktrace=sys.exc_info()[2])

.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py:639: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = Retry(total=0, connect=None, read=False, redirect=None, status=None)
method = 'GET', url = '/test-weko/_search', response = None
error = NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bd97160>: Failed to establish a new connection: [Errno 111] Connection refused',)
_pool = <urllib3.connectionpool.HTTPConnectionPool object at 0x7fde3bd2f2b0>
_stacktrace = <traceback object at 0x7fde3bc84f88>

    def increment(self, method=None, url=None, response=None, error=None,
                  _pool=None, _stacktrace=None):
        """ Return a new Retry object with incremented retry counters.
    
        :param response: A response object, or None, if the server did not
            return a response.
        :type response: :class:`~urllib3.response.HTTPResponse`
        :param Exception error: An error encountered during the request, or
            None if the response was received successfully.
    
        :return: A new ``Retry`` object.
        """
        if self.total is False and error:
            # Disabled, indicate to re-raise the error.
            raise six.reraise(type(error), error, _stacktrace)
    
        total = self.total
        if total is not None:
            total -= 1
    
        connect = self.connect
        read = self.read
        redirect = self.redirect
        status_count = self.status
        cause = 'unknown'
        status = None
        redirect_location = None
    
        if error and self._is_connection_error(error):
            # Connect retry?
            if connect is False:
                raise six.reraise(type(error), error, _stacktrace)
            elif connect is not None:
                connect -= 1
    
        elif error and self._is_read_error(error):
            # Read retry?
            if read is False or not self._is_method_retryable(method):
                raise six.reraise(type(error), error, _stacktrace)
            elif read is not None:
                read -= 1
    
        elif response and response.get_redirect_location():
            # Redirect retry?
            if redirect is not None:
                redirect -= 1
            cause = 'too many redirects'
            redirect_location = response.get_redirect_location()
            status = response.status
    
        else:
            # Incrementing because of a server error like a 500 in
            # status_forcelist and a the given method is in the whitelist
            cause = ResponseError.GENERIC_ERROR
            if response and response.status:
                if status_count is not None:
                    status_count -= 1
                cause = ResponseError.SPECIFIC_ERROR.format(
                    status_code=response.status)
                status = response.status
    
        history = self.history + (RequestHistory(method, url, error, status, redirect_location),)
    
        new_retry = self.new(
            total=total,
            connect=connect, read=read, redirect=redirect, status=status_count,
            history=history)
    
        if new_retry.is_exhausted():
>           raise MaxRetryError(_pool, url, error or ResponseError(cause))
E           urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko/_search (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bd97160>: Failed to establish a new connection: [Errno 111] Connection refused',))

.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py:388: MaxRetryError

During handling of the above exception, another exception occurred:

self = <RequestsHttpConnection: http://localhost:9200>, method = 'GET'
url = 'http://localhost:9200/test-weko/_search', params = {}
body = b'{"query":{"bool":{"must":[{"query_string":{"query":"_type:record-v1.0.0 AND relation_version_is_last:true  AND publi...h":"2"}}]}}],"must_not":[{"match":{"publish_status":"-1"}}]}},"sort":[{"publish_date":{"order":"desc"}}],"size":10000}'
timeout = None, ignore = (), headers = None

    def perform_request(self, method, url, params=None, body=None, timeout=None, ignore=(), headers=None):
        url = self.base_url + url
        if params:
            url = '%s?%s' % (url, urlencode(params or {}))
    
        start = time.time()
        request = requests.Request(method=method, headers=headers, url=url, data=body)
        prepared_request = self.session.prepare_request(request)
        settings = self.session.merge_environment_settings(prepared_request.url, {}, None, None, None)
        send_kwargs = {'timeout': timeout or self.timeout}
        send_kwargs.update(settings)
        try:
>           response = self.session.send(prepared_request, **send_kwargs)

.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py:76: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <requests.sessions.Session object at 0x7fde3bd30e10>
request = <PreparedRequest [GET]>
kwargs = {'cert': None, 'proxies': OrderedDict(), 'stream': False, 'timeout': 120, ...}
allow_redirects = True, stream = False, hooks = {'response': []}
adapter = <requests.adapters.HTTPAdapter object at 0x7fde3bd2ff98>
start = 1679693157.108606

    def send(self, request, **kwargs):
        """Send a given PreparedRequest.
    
        :rtype: requests.Response
        """
        # Set defaults that the hooks can utilize to ensure they always have
        # the correct parameters to reproduce the previous request.
        kwargs.setdefault('stream', self.stream)
        kwargs.setdefault('verify', self.verify)
        kwargs.setdefault('cert', self.cert)
        kwargs.setdefault('proxies', self.proxies)
    
        # It's possible that users might accidentally send a Request object.
        # Guard against that specific failure case.
        if isinstance(request, Request):
            raise ValueError('You can only send PreparedRequests.')
    
        # Set up variables needed for resolve_redirects and dispatching of hooks
        allow_redirects = kwargs.pop('allow_redirects', True)
        stream = kwargs.get('stream')
        hooks = request.hooks
    
        # Get the appropriate adapter to use
        adapter = self.get_adapter(url=request.url)
    
        # Start time (approximately) of the request
        start = preferred_clock()
    
        # Send the request
>       r = adapter.send(request, **kwargs)

.tox/c1/lib/python3.6/site-packages/requests/sessions.py:618: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <requests.adapters.HTTPAdapter object at 0x7fde3bd2ff98>
request = <PreparedRequest [GET]>, stream = False
timeout = <urllib3.util.timeout.Timeout object at 0x7fde3bdcae80>, verify = ''
cert = None, proxies = OrderedDict()

    def send(self, request, stream=False, timeout=None, verify=True, cert=None, proxies=None):
        """Sends PreparedRequest object. Returns Response object.
    
        :param request: The :class:`PreparedRequest <PreparedRequest>` being sent.
        :param stream: (optional) Whether to stream the request content.
        :param timeout: (optional) How long to wait for the server to send
            data before giving up, as a float, or a :ref:`(connect timeout,
            read timeout) <timeouts>` tuple.
        :type timeout: float or tuple or urllib3 Timeout object
        :param verify: (optional) Either a boolean, in which case it controls whether
            we verify the server's TLS certificate, or a string, in which case it
            must be a path to a CA bundle to use
        :param cert: (optional) Any user-provided SSL certificate to be trusted.
        :param proxies: (optional) The proxies dictionary to apply to the request.
        :rtype: requests.Response
        """
    
        conn = self.get_connection(request.url, proxies)
    
        self.cert_verify(conn, request.url, verify, cert)
        url = self.request_url(request, proxies)
        self.add_headers(request)
    
        chunked = not (request.body is None or 'Content-Length' in request.headers)
    
        if isinstance(timeout, tuple):
            try:
                connect, read = timeout
                timeout = TimeoutSauce(connect=connect, read=read)
            except ValueError as e:
                # this may raise a string formatting error.
                err = ("Invalid timeout {0}. Pass a (connect, read) "
                       "timeout tuple, or a single float to set "
                       "both timeouts to the same value".format(timeout))
                raise ValueError(err)
        elif isinstance(timeout, TimeoutSauce):
            pass
        else:
            timeout = TimeoutSauce(connect=timeout, read=timeout)
    
        try:
            if not chunked:
                resp = conn.urlopen(
                    method=request.method,
                    url=url,
                    body=request.body,
                    headers=request.headers,
                    redirect=False,
                    assert_same_host=False,
                    preload_content=False,
                    decode_content=False,
                    retries=self.max_retries,
                    timeout=timeout
                )
    
            # Send the request.
            else:
                if hasattr(conn, 'proxy_pool'):
                    conn = conn.proxy_pool
    
                low_conn = conn._get_conn(timeout=DEFAULT_POOL_TIMEOUT)
    
                try:
                    low_conn.putrequest(request.method,
                                        url,
                                        skip_accept_encoding=True)
    
                    for header, value in request.headers.items():
                        low_conn.putheader(header, value)
    
                    low_conn.endheaders()
    
                    for i in request.body:
                        low_conn.send(hex(len(i))[2:].encode('utf-8'))
                        low_conn.send(b'\r\n')
                        low_conn.send(i)
                        low_conn.send(b'\r\n')
                    low_conn.send(b'0\r\n\r\n')
    
                    # Receive the response from the server
                    try:
                        # For Python 2.7+ versions, use buffering of HTTP
                        # responses
                        r = low_conn.getresponse(buffering=True)
                    except TypeError:
                        # For compatibility with Python 2.6 versions and back
                        r = low_conn.getresponse()
    
                    resp = HTTPResponse.from_httplib(
                        r,
                        pool=conn,
                        connection=low_conn,
                        preload_content=False,
                        decode_content=False
                    )
                except:
                    # If we hit any problems here, clean up the connection.
                    # Then, reraise so that we can handle the actual exception.
                    low_conn.close()
                    raise
    
        except (ProtocolError, socket.error) as err:
            raise ConnectionError(err, request=request)
    
        except MaxRetryError as e:
            if isinstance(e.reason, ConnectTimeoutError):
                # TODO: Remove this in 3.0.0: see #2811
                if not isinstance(e.reason, NewConnectionError):
                    raise ConnectTimeout(e, request=request)
    
            if isinstance(e.reason, ResponseError):
                raise RetryError(e, request=request)
    
            if isinstance(e.reason, _ProxyError):
                raise ProxyError(e, request=request)
    
            if isinstance(e.reason, _SSLError):
                # This branch is for urllib3 v1.22 and later.
                raise SSLError(e, request=request)
    
>           raise ConnectionError(e, request=request)
E           requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko/_search (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bd97160>: Failed to establish a new connection: [Errno 111] Connection refused',))

.tox/c1/lib/python3.6/site-packages/requests/adapters.py:508: ConnectionError

During handling of the above exception, another exception occurred:

app = <Flask 'testapp'>
db_records = [(<PersistentIdentifier depid:1 / rec:fe6c62ed-df4d-4337-bb41-8cf46fad41cd (R)>, <PersistentIdentifier recid:1 / rec:f...617258105262': {'resourceuri': 'http://purl.org/coar/resource_type/c_5794', 'resourcetype': 'conference paper'}}), ...]

    def test_get_new_items_by_date(app,db_records):
>       assert get_new_items_by_date("1900-01-01","2023-01-01",False) == {}

tests/test_utils.py:7358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
weko_items_ui/utils.py:1677: in get_new_items_by_date
    search_result = search_instance.execute()
.tox/c1/lib/python3.6/site-packages/elasticsearch_dsl/search.py:706: in execute
    **self._params
.tox/c1/lib/python3.6/site-packages/elasticsearch/client/utils.py:76: in _wrapped
    return func(*args, params=params, **kwargs)
.tox/c1/lib/python3.6/site-packages/elasticsearch/client/__init__.py:636: in search
    doc_type, '_search'), params=params, body=body)
.tox/c1/lib/python3.6/site-packages/elasticsearch/transport.py:314: in perform_request
    status, headers_response, data = connection.perform_request(method, url, params, body, headers=headers, ignore=ignore, timeout=timeout)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <RequestsHttpConnection: http://localhost:9200>, method = 'GET'
url = 'http://localhost:9200/test-weko/_search', params = {}
body = b'{"query":{"bool":{"must":[{"query_string":{"query":"_type:record-v1.0.0 AND relation_version_is_last:true  AND publi...h":"2"}}]}}],"must_not":[{"match":{"publish_status":"-1"}}]}},"sort":[{"publish_date":{"order":"desc"}}],"size":10000}'
timeout = None, ignore = (), headers = None

    def perform_request(self, method, url, params=None, body=None, timeout=None, ignore=(), headers=None):
        url = self.base_url + url
        if params:
            url = '%s?%s' % (url, urlencode(params or {}))
    
        start = time.time()
        request = requests.Request(method=method, headers=headers, url=url, data=body)
        prepared_request = self.session.prepare_request(request)
        settings = self.session.merge_environment_settings(prepared_request.url, {}, None, None, None)
        send_kwargs = {'timeout': timeout or self.timeout}
        send_kwargs.update(settings)
        try:
            response = self.session.send(prepared_request, **send_kwargs)
            duration = time.time() - start
            raw_data = response.text
        except Exception as e:
            self.log_request_fail(method, url, prepared_request.path_url, body, time.time() - start, exception=e)
            if isinstance(e, requests.exceptions.SSLError):
                raise SSLError('N/A', str(e), e)
            if isinstance(e, requests.Timeout):
                raise ConnectionTimeout('TIMEOUT', str(e), e)
>           raise ConnectionError('N/A', str(e), e)
E           elasticsearch.exceptions.ConnectionError: ConnectionError(HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko/_search (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bd97160>: Failed to establish a new connection: [Errno 111] Connection refused',))) caused by: ConnectionError(HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko/_search (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bd97160>: Failed to establish a new connection: [Errno 111] Connection refused',)))

.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py:85: ConnectionError
------------------------------ Captured log setup ------------------------------
WARNING  flask.app:ext.py:255 JSONSCHEMAS_HOST is set to localhost
----------------------------- Captured stdout call -----------------------------
{'query': {'bool': {'must': [{'query_string': {'query': '_type:record-v1.0.0 AND relation_version_is_last:true  AND publish_status:0  AND publish_date:[1900-01-01 TO 2023-01-01]'}}, {'bool': {'should': [{'wildcard': {'path': '1'}}, {'wildcard': {'path': '2'}}]}}], 'must_not': [{'match': {'publish_status': '-1'}}]}}, 'sort': [{'publish_date': {'order': 'desc'}}], 'size': 10000}
------------------------------ Captured log call -------------------------------
WARNING  elasticsearch:base.py:97 GET http://localhost:9200/test-weko/_search [status:N/A request:0.003s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3bd2f358>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko/_search (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bd2f358>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko/_search (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bd2f358>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 GET http://localhost:9200/test-weko/_search [status:N/A request:0.001s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3bda2a58>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko/_search (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bda2a58>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko/_search (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bda2a58>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 GET http://localhost:9200/test-weko/_search [status:N/A request:0.001s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3bda8b38>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko/_search (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bda8b38>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko/_search (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bda8b38>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 GET http://localhost:9200/test-weko/_search [status:N/A request:0.001s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3bd9ccc0>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko/_search (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bd9ccc0>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko/_search (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bd9ccc0>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 GET http://localhost:9200/test-weko/_search [status:N/A request:0.001s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3bd43be0>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko/_search (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bd43be0>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko/_search (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bd43be0>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 GET http://localhost:9200/test-weko/_search [status:N/A request:0.001s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3bd5c128>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko/_search (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bd5c128>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko/_search (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bd5c128>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 GET http://localhost:9200/test-weko/_search [status:N/A request:0.001s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3bd9a2b0>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko/_search (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bd9a2b0>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko/_search (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bd9a2b0>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 GET http://localhost:9200/test-weko/_search [status:N/A request:0.001s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3bd3dbe0>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko/_search (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bd3dbe0>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko/_search (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bd3dbe0>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 GET http://localhost:9200/test-weko/_search [status:N/A request:0.002s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3bd3d320>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko/_search (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bd3d320>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko/_search (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bd3d320>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 GET http://localhost:9200/test-weko/_search [status:N/A request:0.001s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3bdcaf60>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko/_search (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bdcaf60>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko/_search (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bdcaf60>: Failed to establish a new connection: [Errno 111] Connection refused',))
WARNING  elasticsearch:base.py:97 GET http://localhost:9200/test-weko/_search [status:N/A request:0.001s]
Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 141, in _new_conn
    (self.host, self.port), self.timeout, **extra_kw)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 83, in create_connection
    raise err
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 601, in urlopen
    chunked=chunked)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 357, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.6/http/client.py", line 1291, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1337, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1286, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.6/http/client.py", line 1046, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.6/http/client.py", line 984, in send
    self.connect()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 166, in connect
    conn = self._new_conn()
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connection.py", line 150, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fde3bd97160>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 440, in send
    timeout=timeout
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/connectionpool.py", line 639, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/urllib3/util/retry.py", line 388, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko/_search (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bd97160>: Failed to establish a new connection: [Errno 111] Connection refused',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/elasticsearch/connection/http_requests.py", line 76, in perform_request
    response = self.session.send(prepared_request, **send_kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/sessions.py", line 618, in send
    r = adapter.send(request, **kwargs)
  File "/code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/requests/adapters.py", line 508, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: /test-weko/_search (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fde3bd97160>: Failed to establish a new connection: [Errno 111] Connection refused',))
____________________ test_update_schema_remove_hidden_item _____________________

db_itemtype = {'item_type': <ItemType 1>, 'item_type_mapping': <ItemTypeMapping 1>, 'item_type_name': <ItemTypeName 1>}

    def test_update_schema_remove_hidden_item(db_itemtype):
        item_type = db_itemtype["item_type"]
        system_properties = [
            "subitem_systemidt_identifier",
            "subitem_systemfile_datetime",
            "subitem_systemfile_filename",
            "subitem_system_id_rg_doi",
            "subitem_system_date_type",
            "subitem_system_date",
            "subitem_system_identifier_type",
            "subitem_system_identifier",
            "subitem_system_text",
        ]
        hidden_items = [
            item_type.form.index(form)
            for form in item_type.form
            if form.get("items")
            and form["items"][0]["key"].split(".")[1] == "subitem_systemidt_identifier"
        ]
        print(hidden_items)
>       assert (
            update_schema_remove_hidden_item(
                item_type.schema, item_type.render, hidden_items
            )
            == ""
        )

tests/test_utils.py:7385: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

schema = {'$schema': 'http://json-schema.org/draft-04/schema#', 'description': '', 'properties': {'item_1617186331708': {'items...e': 'Access Rights', 'type': 'object'}, ...}, 'required': ['pubdate', 'item_1617186331708', 'item_1617258105262'], ...}
render = {'edit_notes': {'item_1617186331708': '', 'item_1617186385884': '', 'item_1617186419668': '', 'item_1617186476635': ''...': False, 'hidden': True, 'multiple': False, 'oneline': False, ...}, 'title': 'Persistent Identifier(URI)', ...}}, ...}
items_name = [39, 40, 41]

    def update_schema_remove_hidden_item(schema, render, items_name):
        """Update schema: remove hidden items.
    
        :param schema: json schema
        :param render: json render
        :param items_name: list items which has hidden flg
        :return: The json object.
        """
        for item in items_name:
            hidden_flg = False
>           key = schema[item]['key']
E           KeyError: 39

weko_items_ui/utils.py:1695: KeyError
------------------------------ Captured log setup ------------------------------
WARNING  flask.app:ext.py:255 JSONSCHEMAS_HOST is set to localhost
----------------------------- Captured stdout call -----------------------------
[39, 40, 41]
_____________________________ test_validate_bibtex _____________________________

app = <Flask 'testapp'>
db = <SQLAlchemy engine=sqlite:////code/modules/weko-items-ui/test.db>
db_records = [(<PersistentIdentifier depid:1 / rec:7b9e6b09-9218-4db0-b346-541fc54eb50b (R)>, <PersistentIdentifier recid:1 / rec:7...617258105262': {'resourceuri': 'http://purl.org/coar/resource_type/c_5794', 'resourcetype': 'conference paper'}}), ...]
db_itemtype = {'item_type': <ItemType 1>, 'item_type_mapping': <ItemTypeMapping 1>, 'item_type_name': <ItemTypeName 1>}
db_oaischema = None

    def test_validate_bibtex(app, db, db_records, db_itemtype, db_oaischema):
        app.config.update(OAISERVER_XSL_URL=None)
>       assert validate_bibtex([1]) == ""

tests/test_utils.py:7728: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
weko_items_ui/utils.py:2383: in validate_bibtex
    from weko_schema_ui.serializers import WekoBibTexSerializer
../weko-schema-ui/weko_schema_ui/serializers/__init__.py:62: in <module>
    BibTexSerializer = WekoBibTexSerializer()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <weko_schema_ui.serializers.WekoBibTexSerializer.WekoBibTexSerializer object at 0x7fde3ab39cc0>

    def __init__(self):
        """Init."""
        # Load namespace
        self.__ns = cache_schema('jpcoar_mapping').get('namespaces')
        self.__lst_identifier_type = ['doi', 'hdl', 'url']
        # JPCOAR elements
>       jp_jp = '{' + self.__ns['jpcoar'] + '}'
E       KeyError: 'jpcoar'

../weko-schema-ui/weko_schema_ui/serializers/WekoBibTexSerializer.py:133: KeyError
------------------------------ Captured log setup ------------------------------
WARNING  flask.app:ext.py:255 JSONSCHEMAS_HOST is set to localhost
____________________________ test_make_bibtex_data _____________________________

db_records = [(<PersistentIdentifier depid:1 / rec:0d9bb27b-619b-4f43-85a2-6c407b4d28ca (R)>, <PersistentIdentifier recid:1 / rec:0...617258105262': {'resourceuri': 'http://purl.org/coar/resource_type/c_5794', 'resourcetype': 'conference paper'}}), ...]

    def test_make_bibtex_data(db_records):
>       assert make_bibtex_data([1])==""

tests/test_utils.py:7734: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
weko_items_ui/utils.py:2404: in make_bibtex_data
    from weko_schema_ui.serializers import WekoBibTexSerializer
../weko-schema-ui/weko_schema_ui/serializers/__init__.py:62: in <module>
    BibTexSerializer = WekoBibTexSerializer()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <weko_schema_ui.serializers.WekoBibTexSerializer.WekoBibTexSerializer object at 0x7fde3c512748>

    def __init__(self):
        """Init."""
        # Load namespace
>       self.__ns = cache_schema('jpcoar_mapping').get('namespaces')
E       AttributeError: 'NoneType' object has no attribute 'get'

../weko-schema-ui/weko_schema_ui/serializers/WekoBibTexSerializer.py:130: AttributeError
------------------------------ Captured log setup ------------------------------
WARNING  flask.app:ext.py:255 JSONSCHEMAS_HOST is set to localhost
_______________________________ test_get_ranking _______________________________

app = <Flask 'testapp'>
db_records = [(<PersistentIdentifier depid:1 / rec:96db9e65-aabd-4c64-8bc0-b6bff6196c0f (R)>, <PersistentIdentifier recid:1 / rec:9...617258105262': {'resourceuri': 'http://purl.org/coar/resource_type/c_5794', 'resourcetype': 'conference paper'}}), ...]
db_ranking = {'settings': <RankingSettings 1>}

    def test_get_ranking(app, db_records, db_ranking):
        settings = db_ranking['settings']
        with app.test_request_context():
>           assert get_ranking(settings)=={'most_reviewed_items': [], 'most_downloaded_items': [], 'created_most_items_user': [], 'most_searched_keywords': [], 'new_items': []}

tests/test_utils.py:7760: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
weko_items_ui/utils.py:2470: in get_ranking
    index_json = Indexes.get_browsing_tree_ignore_more()
../weko-index-tree/weko_index_tree/api.py:598: in get_browsing_tree_ignore_more
    datastore = redis_connection.connection(db=current_app.config['CACHE_REDIS_DB'], kv = True)
../weko-redis/weko_redis/redis.py:40: in connection
    raise ex
../weko-redis/weko_redis/redis.py:36: in connection
    store = self.redis_connection(db)
../weko-redis/weko_redis/redis.py:55: in redis_connection
    raise ex
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <weko_redis.redis.RedisConnection object at 0x7fde3a9fdfd0>, db = 0

    def redis_connection(self, db):
        store = None
        try:
>           redis_url = 'redis://' + current_app.config['CACHE_REDIS_HOST'] + ':' + current_app.config['REDIS_PORT'] + '/' + str(db)
E           TypeError: must be str, not NoneType

../weko-redis/weko_redis/redis.py:52: TypeError
------------------------------ Captured log setup ------------------------------
WARNING  flask.app:ext.py:255 JSONSCHEMAS_HOST is set to localhost
_____________________ test_make_stats_file_with_permission _____________________

app = <Flask 'testapp'>
users = [{'email': 'contributor@test.org', 'id': 2, 'obj': <User 2>}, {'email': 'repoadmin@test.org', 'id': 4, 'obj': <User 4>...eneraluser@test.org', 'id': 6, 'obj': <User 5>}, {'email': 'originalroleuser@test.org', 'id': 7, 'obj': <User 7>}, ...]
db_itemtype = {'item_type': <ItemType 1>, 'item_type_mapping': <ItemTypeMapping 1>, 'item_type_name': <ItemTypeName 1>}
db_records = [(<PersistentIdentifier depid:1 / rec:6c444479-e868-443b-a5bd-c3e00804aeb9 (R)>, <PersistentIdentifier recid:1 / rec:6...617258105262': {'resourceuri': 'http://purl.org/coar/resource_type/c_5794', 'resourcetype': 'conference paper'}}), ...]

    def test_make_stats_file_with_permission(app, users,db_itemtype,db_records):
        item_type_id = 1
        recids = ["1", "2"]
        record0 = WekoRecord.get_record_by_pid(1)
        record1 = WekoRecord.get_record_by_pid(2)
        records_metadata = {"1": record0, "2": record1}
        permissions = dict(
            permission_show_hide=lambda a: True,
            check_created_id=lambda a: True,
            hide_meta_data_for_role=lambda a: True,
            current_language=lambda: True,
        )
    
        with app.test_request_context():
            with patch("flask_login.utils._get_user", return_value=users[2]["obj"]):
>               assert (
                    make_stats_file_with_permission(
                        item_type_id, recids, records_metadata, permissions
                    )
                    == ([['#.id', '.uri', '.metadata.path[0]', '.pos_index[0]', '.publish_status', '.feedback_mail[0]', '.cnri', '.doi_ra', '.doi', '.edit_mode', '.metadata.pubdate', '.metadata.item_1617186331708[0].subitem_1551255647225', '.metadata.item_1617186331708[0].subitem_1551255648112', '.metadata.item_1617186385884[0].subitem_1551255720400', '.metadata.item_1617186385884[0].subitem_1551255721061', '.metadata.item_1617186419668[0].creatorAffiliations[0].affiliationNameIdentifiers[0].affiliationNameIdentifier', '.metadata.item_1617186419668[0].creatorAffiliations[0].affiliationNameIdentifiers[0].affiliationNameIdentifierScheme', '.metadata.item_1617186419668[0].creatorAffiliations[0].affiliationNameIdentifiers[0].affiliationNameIdentifierURI', '.metadata.item_1617186419668[0].creatorAffiliations[0].affiliationNames[0].affiliationName', '.metadata.item_1617186419668[0].creatorAffiliations[0].affiliationNames[0].affiliationNameLang', '.metadata.item_1617186419668[0].creatorAlternatives[0].creatorAlternative', '.metadata.item_1617186419668[0].creatorAlternatives[0].creatorAlternativeLang', '.metadata.item_1617186419668[0].creatorMails[0].creatorMail', '.metadata.item_1617186419668[0].creatorNames[0].creatorName', '.metadata.item_1617186419668[0].creatorNames[0].creatorNameLang', '.metadata.item_1617186419668[0].familyNames[0].familyName', '.metadata.item_1617186419668[0].familyNames[0].familyNameLang', '.metadata.item_1617186419668[0].givenNames[0].givenName', '.metadata.item_1617186419668[0].givenNames[0].givenNameLang', '.metadata.item_1617186419668[0].nameIdentifiers[0].nameIdentifier', '.metadata.item_1617186419668[0].nameIdentifiers[0].nameIdentifierScheme', '.metadata.item_1617186419668[0].nameIdentifiers[0].nameIdentifierURI', '.metadata.item_1617349709064[0].contributorAffiliations[0].contributorAffiliationNameIdentifiers[0].contributorAffiliationNameIdentifier', '.metadata.item_1617349709064[0].contributorAffiliations[0].contributorAffiliationNameIdentifiers[0].contributorAffiliationScheme', '.metadata.item_1617349709064[0].contributorAffiliations[0].contributorAffiliationNameIdentifiers[0].contributorAffiliationURI', '.metadata.item_1617349709064[0].contributorAffiliations[0].contributorAffiliationNames[0].contributorAffiliationName', '.metadata.item_1617349709064[0].contributorAffiliations[0].contributorAffiliationNames[0].contributorAffiliationNameLang', '.metadata.item_1617349709064[0].contributorAlternatives[0].contributorAlternative', '.metadata.item_1617349709064[0].contributorAlternatives[0].contributorAlternativeLang', '.metadata.item_1617349709064[0].contributorMails[0].contributorMail', '.metadata.item_1617349709064[0].contributorNames[0].contributorName', '.metadata.item_1617349709064[0].contributorNames[0].lang', '.metadata.item_1617349709064[0].contributorType', '.metadata.item_1617349709064[0].familyNames[0].familyName', '.metadata.item_1617349709064[0].familyNames[0].familyNameLang', '.metadata.item_1617349709064[0].givenNames[0].givenName', '.metadata.item_1617349709064[0].givenNames[0].givenNameLang', '.metadata.item_1617349709064[0].nameIdentifiers[0].nameIdentifier', '.metadata.item_1617349709064[0].nameIdentifiers[0].nameIdentifierScheme', '.metadata.item_1617349709064[0].nameIdentifiers[0].nameIdentifierURI', '.metadata.item_1617186476635.subitem_1522299639480', '.metadata.item_1617186476635.subitem_1600958577026', '.metadata.item_1617351524846.subitem_1523260933860', '.metadata.item_1617186499011[0].subitem_1522650717957', '.metadata.item_1617186499011[0].subitem_1522650727486', '.metadata.item_1617186499011[0].subitem_1522651041219', '.metadata.item_1617610673286[0].nameIdentifiers[0].nameIdentifier', '.metadata.item_1617610673286[0].nameIdentifiers[0].nameIdentifierScheme', '.metadata.item_1617610673286[0].nameIdentifiers[0].nameIdentifierURI', '.metadata.item_1617610673286[0].rightHolderNames[0].rightHolderLanguage', '.metadata.item_1617610673286[0].rightHolderNames[0].rightHolderName', '.metadata.item_1617186609386[0].subitem_1522299896455', '.metadata.item_1617186609386[0].subitem_1522300014469', '.metadata.item_1617186609386[0].subitem_1522300048512', '.metadata.item_1617186609386[0].subitem_1523261968819', '.metadata.item_1617186626617[0].subitem_description', '.metadata.item_1617186626617[0].subitem_description_language', '.metadata.item_1617186626617[0].subitem_description_type', '.metadata.item_1617186643794[0].subitem_1522300295150', '.metadata.item_1617186643794[0].subitem_1522300316516', '.metadata.item_1617186660861[0].subitem_1522300695726', '.metadata.item_1617186660861[0].subitem_1522300722591', '.metadata.item_1617186702042[0].subitem_1551255818386', '.metadata.item_1617258105262.resourcetype', '.metadata.item_1617258105262.resourceuri', '.metadata.item_1617349808926.subitem_1523263171732', '.metadata.item_1617265215918.subitem_1522305645492', '.metadata.item_1617265215918.subitem_1600292170262', '.metadata.item_1617186783814[0].subitem_identifier_type', '.metadata.item_1617186783814[0].subitem_identifier_uri', '.metadata.item_1617186819068.subitem_identifier_reg_text', '.metadata.item_1617186819068.subitem_identifier_reg_type', '.metadata.item_1617353299429[0].subitem_1522306207484', '.metadata.item_1617353299429[0].subitem_1522306287251.subitem_1522306382014', '.metadata.item_1617353299429[0].subitem_1522306287251.subitem_1522306436033', '.metadata.item_1617353299429[0].subitem_1523320863692[0].subitem_1523320867455', '.metadata.item_1617353299429[0].subitem_1523320863692[0].subitem_1523320909613', '.metadata.item_1617186859717[0].subitem_1522658018441', '.metadata.item_1617186859717[0].subitem_1522658031721', '.metadata.item_1617186882738[0].subitem_geolocation_box.subitem_east_longitude', '.metadata.item_1617186882738[0].subitem_geolocation_box.subitem_north_latitude', '.metadata.item_1617186882738[0].subitem_geolocation_box.subitem_south_latitude', '.metadata.item_1617186882738[0].subitem_geolocation_box.subitem_west_longitude', '.metadata.item_1617186882738[0].subitem_geolocation_place[0].subitem_geolocation_place_text', '.metadata.item_1617186882738[0].subitem_geolocation_point.subitem_point_latitude', '.metadata.item_1617186882738[0].subitem_geolocation_point.subitem_point_longitude', '.metadata.item_1617186901218[0].subitem_1522399143519.subitem_1522399281603', '.metadata.item_1617186901218[0].subitem_1522399143519.subitem_1522399333375', '.metadata.item_1617186901218[0].subitem_1522399412622[0].subitem_1522399416691', '.metadata.item_1617186901218[0].subitem_1522399412622[0].subitem_1522737543681', '.metadata.item_1617186901218[0].subitem_1522399571623.subitem_1522399585738', '.metadata.item_1617186901218[0].subitem_1522399571623.subitem_1522399628911', '.metadata.item_1617186901218[0].subitem_1522399651758[0].subitem_1522721910626', '.metadata.item_1617186901218[0].subitem_1522399651758[0].subitem_1522721929892', '.metadata.item_1617186920753[0].subitem_1522646500366', '.metadata.item_1617186920753[0].subitem_1522646572813', '.metadata.item_1617186941041[0].subitem_1522650068558', '.metadata.item_1617186941041[0].subitem_1522650091861', '.metadata.item_1617186959569.subitem_1551256328147', '.metadata.item_1617186981471.subitem_1551256294723', '.metadata.item_1617186994930.subitem_1551256248092', '.metadata.item_1617187024783.subitem_1551256198917', '.metadata.item_1617187045071.subitem_1551256185532', '.metadata.item_1617187056579.bibliographicIssueDates.bibliographicIssueDate', '.metadata.item_1617187056579.bibliographicIssueDates.bibliographicIssueDateType', '.metadata.item_1617187056579.bibliographicIssueNumber', '.metadata.item_1617187056579.bibliographicNumberOfPages', '.metadata.item_1617187056579.bibliographicPageEnd', '.metadata.item_1617187056579.bibliographicPageStart', '.metadata.item_1617187056579.bibliographicVolumeNumber', '.metadata.item_1617187056579.bibliographic_titles[0].bibliographic_title', '.metadata.item_1617187056579.bibliographic_titles[0].bibliographic_titleLang', '.metadata.item_1617187087799.subitem_1551256171004', '.metadata.item_1617187112279[0].subitem_1551256126428', '.metadata.item_1617187112279[0].subitem_1551256129013', '.metadata.item_1617187136212.subitem_1551256096004', '.metadata.item_1617944105607[0].subitem_1551256015892[0].subitem_1551256027296', '.metadata.item_1617944105607[0].subitem_1551256015892[0].subitem_1551256029891', '.metadata.item_1617944105607[0].subitem_1551256037922[0].subitem_1551256042287', '.metadata.item_1617944105607[0].subitem_1551256037922[0].subitem_1551256047619', '.metadata.item_1617187187528[0].subitem_1599711633003[0].subitem_1599711636923', '.metadata.item_1617187187528[0].subitem_1599711633003[0].subitem_1599711645590', '.metadata.item_1617187187528[0].subitem_1599711655652', '.metadata.item_1617187187528[0].subitem_1599711660052[0].subitem_1599711680082', '.metadata.item_1617187187528[0].subitem_1599711660052[0].subitem_1599711686511', '.metadata.item_1617187187528[0].subitem_1599711699392.subitem_1599711704251', '.metadata.item_1617187187528[0].subitem_1599711699392.subitem_1599711712451', '.metadata.item_1617187187528[0].subitem_1599711699392.subitem_1599711727603', '.metadata.item_1617187187528[0].subitem_1599711699392.subitem_1599711731891', '.metadata.item_1617187187528[0].subitem_1599711699392.subitem_1599711735410', '.metadata.item_1617187187528[0].subitem_1599711699392.subitem_1599711739022', '.metadata.item_1617187187528[0].subitem_1599711699392.subitem_1599711743722', '.metadata.item_1617187187528[0].subitem_1599711699392.subitem_1599711745532', '.metadata.item_1617187187528[0].subitem_1599711758470[0].subitem_1599711769260', '.metadata.item_1617187187528[0].subitem_1599711758470[0].subitem_1599711775943', '.metadata.item_1617187187528[0].subitem_1599711788485[0].subitem_1599711798761', '.metadata.item_1617187187528[0].subitem_1599711788485[0].subitem_1599711803382', '.metadata.item_1617187187528[0].subitem_1599711813532', '.file_path[0]', '.metadata.item_1617605131499[0].accessrole', '.metadata.item_1617605131499[0].date[0].dateType', '.metadata.item_1617605131499[0].date[0].dateValue', '.metadata.item_1617605131499[0].displaytype', '.metadata.item_1617605131499[0].fileDate[0].fileDateType', '.metadata.item_1617605131499[0].fileDate[0].fileDateValue', '.metadata.item_1617605131499[0].filename', '.metadata.item_1617605131499[0].filesize[0].value', '.metadata.item_1617605131499[0].format', '.metadata.item_1617605131499[0].groups', '.metadata.item_1617605131499[0].licensefree', '.metadata.item_1617605131499[0].licensetype', '.metadata.item_1617605131499[0].url.label', '.metadata.item_1617605131499[0].url.objectType', '.metadata.item_1617605131499[0].url.url', '.metadata.item_1617605131499[0].version', '.metadata.item_1617620223087[0].subitem_1565671149650', '.metadata.item_1617620223087[0].subitem_1565671169640', '.metadata.item_1617620223087[0].subitem_1565671178623', '.thumbnail_path[0]', '.metadata.item_1662046377046[0].subitem_thumbnail[0].thumbnail_label', '.metadata.item_1662046377046[0].subitem_thumbnail[0].thumbnail_url'], ['#ID', 'URI', '.IndexID[0]', '.POS_INDEX[0]', '.PUBLISH_STATUS', '.FEEDBACK_MAIL[0]', '.CNRI', '.DOI_RA', '.DOI', 'Keep/Upgrade Version', 'PubDate', 'Title[0].Title', 'Title[0].Language', 'Alternative Title[0].Alternative Title', 'Alternative Title[0].Language', 'Creator[0].[0].[0].', 'Creator[0].[0].[0].', 'Creator[0].[0].[0].URI', 'Creator[0].[0].[0].', 'Creator[0].[0].[0].', 'Creator[0].[0].', 'Creator[0].[0].', 'Creator[0].[0].', 'Creator[0].[0].', 'Creator[0].[0].', 'Creator[0].[0].', 'Creator[0].[0].', 'Creator[0].[0].', 'Creator[0].[0].', 'Creator[0].[0].', 'Creator[0].[0].Scheme', 'Creator[0].[0].URI', 'Contributor[0].[0].[0].', 'Contributor[0].[0].[0].', 'Contributor[0].[0].[0].URI', 'Contributor[0].[0].[0].', 'Contributor[0].[0].[0].', 'Contributor[0].[0].', 'Contributor[0].[0].', 'Contributor[0].[0].', 'Contributor[0].[0].', 'Contributor[0].[0].', 'Contributor[0].', 'Contributor[0].[0].', 'Contributor[0].[0].', 'Contributor[0].[0].', 'Contributor[0].[0].', 'Contributor[0].[0].', 'Contributor[0].[0].Scheme', 'Contributor[0].[0].URI', 'Access Rights.', 'Access Rights.URI', 'APC.APC', 'Rights[0].', 'Rights[0].Resource', 'Rights[0].', 'Rights Holder[0].[0].', 'Rights Holder[0].[0].Scheme', 'Rights Holder[0].[0].URI', 'Rights Holder[0].[0].', 'Rights Holder[0].[0].', 'Subject[0].', 'Subject[0].Scheme', 'Subject[0].URI', 'Subject[0].', 'Description[0].', 'Description[0].', 'Description[0].', 'Publisher[0].', 'Publisher[0].', 'Date[0].', 'Date[0].', 'Language[0].Language', 'Resource Type.', 'Resource Type.', 'Version.', 'Version Type.', 'Version Type.Resource', 'Identifier[0].', 'Identifier[0].', 'Identifier Registration.ID', 'Identifier Registration.ID', 'Relation[0].', 'Relation[0]..', 'Relation[0]..', 'Relation[0].[0].', 'Relation[0].[0].', 'Temporal[0].', 'Temporal[0].', 'Geo Location[0]..', 'Geo Location[0]..', 'Geo Location[0]..', 'Geo Location[0]..', 'Geo Location[0].[0].', 'Geo Location[0]..', 'Geo Location[0]..', 'Funding Reference[0]..', 'Funding Reference[0]..', 'Funding Reference[0].[0].', 'Funding Reference[0].[0].', 'Funding Reference[0]..URI', 'Funding Reference[0]..', 'Funding Reference[0].[0].', 'Funding Reference[0].[0].', 'Source Identifier[0].', 'Source Identifier[0].', 'Source Title[0].', 'Source Title[0].', 'Volume Number.Volume Number', 'Issue Number.Issue Number', 'Number of Pages.Number of Pages', 'Page Start.Page Start', 'Page End.Page End', 'Bibliographic Information..', 'Bibliographic Information..', 'Bibliographic Information.', 'Bibliographic Information.', 'Bibliographic Information.', 'Bibliographic Information.', 'Bibliographic Information.', 'Bibliographic Information.[0].', 'Bibliographic Information.[0].', 'Dissertation Number.Dissertation Number', 'Degree Name[0].Degree Name', 'Degree Name[0].Language', 'Date Granted.Date Granted', 'Degree Grantor[0].Degree Grantor Name Identifier[0].Degree Grantor Name Identifier', 'Degree Grantor[0].Degree Grantor Name Identifier[0].Degree Grantor Name Identifier Scheme', 'Degree Grantor[0].Degree Grantor Name[0].Degree Grantor Name', 'Degree Grantor[0].Degree Grantor Name[0].Language', 'Conference[0].Conference Name[0].Conference Name', 'Conference[0].Conference Name[0].Language', 'Conference[0].Conference Sequence', 'Conference[0].Conference Sponsor[0].Conference Sponsor', 'Conference[0].Conference Sponsor[0].Language', 'Conference[0].Conference Date.Conference Date', 'Conference[0].Conference Date.Start Day', 'Conference[0].Conference Date.Start Month', 'Conference[0].Conference Date.Start Year', 'Conference[0].Conference Date.End Day', 'Conference[0].Conference Date.End Month', 'Conference[0].Conference Date.End Year', 'Conference[0].Conference Date.Language', 'Conference[0].Conference Venue[0].Conference Venue', 'Conference[0].Conference Venue[0].Language', 'Conference[0].Conference Place[0].Conference Place', 'Conference[0].Conference Place[0].Language', 'Conference[0].Conference Country', '.[0]', 'File[0].', 'File[0].[0].', 'File[0].[0].', 'File[0].', 'File[0].[0].', 'File[0].[0].', 'File[0].', 'File[0].[0].', 'File[0].', 'File[0].', 'File[0].', 'File[0].', 'File[0].URL.', 'File[0].URL.', 'File[0].URL.URL', 'File[0].', 'Heading[0].Language', 'Heading[0].Banner Headline', 'Heading[0].Subheading', '.[0]', '[0].URI[0].', '[0].URI[0].URI'], ['#', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'System', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'System', '', '', 'System', '', '', 'System', 'System', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'System', 'System'], ['#', '', 'Allow Multiple', 'Allow Multiple', 'Required', 'Allow Multiple', '', '', '', 'Required', 'Required', 'Required, Allow Multiple', 'Required, Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', '', '', '', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Required', 'Required', '', '', '', 'Allow Multiple', 'Allow Multiple', '', '', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'Allow Multiple', 'Allow Multiple', '', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple']], {'1': ['1', 'Index(public_state = True,harvest_public_state = True)', 'public', '', '', '', '', 'Keep', '2022-08-20', 'title', 'ja', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'conference paper', 'http://purl.org/coar/resource_type/c_5794', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], '2': ['2', 'Index(public_state = True,harvest_public_state = False)', 'private', '', '', '', '', 'Keep', '2022-08-20', 'title2', 'ja', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'conference paper', 'http://purl.org/coar/resource_type/c_5794', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '']})  )
E               AssertionError: assert ([['#.id', '....'', '', ...]}) == ([['#.id', '....'', '', ...]})
E                 At index 1 diff: {'1': [1, 'Index(public_state = True,harvest_public_state = True)', 'public', '', '', '', '', 'Keep', '2022-08-20', 'title', 'ja', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'conference paper', 'http://purl.org/coar/resource_type/c_5794', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '',...
E                 
E                 ...Full output truncated (1032 lines hidden), use '-vv' to show

tests/test_utils.py:9100: AssertionError
------------------------------ Captured log setup ------------------------------
WARNING  flask.app:ext.py:255 JSONSCHEMAS_HOST is set to localhost
_______________ test_make_stats_file_with_permission_issue33432 ________________

app = <Flask 'testapp'>
users = [{'email': 'contributor@test.org', 'id': 2, 'obj': <User 2>}, {'email': 'repoadmin@test.org', 'id': 4, 'obj': <User 4>...eneraluser@test.org', 'id': 6, 'obj': <User 5>}, {'email': 'originalroleuser@test.org', 'id': 7, 'obj': <User 7>}, ...]
db_itemtype = {'item_type': <ItemType 1>, 'item_type_mapping': <ItemTypeMapping 1>, 'item_type_name': <ItemTypeName 1>}
db_records = [(<PersistentIdentifier depid:1 / rec:55bb1f0d-1be7-4a07-811a-51fb1b03a909 (R)>, <PersistentIdentifier recid:1 / rec:5...617258105262': {'resourceuri': 'http://purl.org/coar/resource_type/c_5794', 'resourcetype': 'conference paper'}}), ...]
db_itemtype2 = {'item_type': <ItemType 2>, 'item_type_mapping': <ItemTypeMapping 2>, 'item_type_name': <ItemTypeName 2>}
db_records2 = [(<PersistentIdentifier depid:7 / rec:96b9c89c-7732-474a-ad93-7956540a142e (R)>, <PersistentIdentifier recid:7 / rec:9...jpn'}, 'item_1569380622649': {'resourceuri': 'http://purl.org/coar/resource_type/c_ddb1', 'resourcetype': 'dataset'}})]

    def test_make_stats_file_with_permission_issue33432(app, users,db_itemtype,db_records,db_itemtype2,db_records2):
        item_type_id = 2
        recids = ["7"]
        record0 = WekoRecord.get_record_by_pid(7)
        records_metadata = {"7": record0}
        permissions = dict(
            permission_show_hide=lambda a: True,
            check_created_id=lambda a: True,
            hide_meta_data_for_role=lambda a: True,
            current_language=lambda: True,
        )
    
        with app.test_request_context():
            with patch("flask_login.utils._get_user", return_value=users[2]["obj"]):
>               assert (
                    make_stats_file_with_permission(
                        item_type_id, recids, records_metadata, permissions
                    )
                    ==([['#.id', '.uri', '.metadata.path[0]', '.pos_index[0]', '.publish_status', '.feedback_mail[0]', '.cnri', '.doi_ra', '.doi', '.edit_mode', '.metadata.pubdate', '.metadata.item_1554883918421.subitem_1551255647225', '.metadata.item_1554883918421.subitem_1551255648112', '.metadata.item_1554883961001.subitem_1551255818386', '.metadata.item_1554884042490.subitem_1522299896455', '.metadata.item_1554884042490.subitem_1522300014469', '.metadata.item_1554884042490.subitem_1522300048512', '.metadata.item_1554884042490.subitem_1523261968819', '.metadata.item_1532070986701.creatorAffiliations[0].affiliationNameIdentifiers[0].affiliationNameIdentifier', '.metadata.item_1532070986701.creatorAffiliations[0].affiliationNameIdentifiers[0].affiliationNameIdentifierScheme', '.metadata.item_1532070986701.creatorAffiliations[0].affiliationNameIdentifiers[0].affiliationNameIdentifierURI', '.metadata.item_1532070986701.creatorAffiliations[0].affiliationNames[0].affiliationName', '.metadata.item_1532070986701.creatorAffiliations[0].affiliationNames[0].affiliationNameLang', '.metadata.item_1532070986701.creatorAlternatives[0].creatorAlternative', '.metadata.item_1532070986701.creatorAlternatives[0].creatorAlternativeLang', '.metadata.item_1532070986701.creatorMails[0].creatorMail', '.metadata.item_1532070986701.creatorNames[0].creatorName', '.metadata.item_1532070986701.creatorNames[0].creatorNameLang', '.metadata.item_1532070986701.familyNames[0].familyName', '.metadata.item_1532070986701.familyNames[0].familyNameLang', '.metadata.item_1532070986701.givenNames[0].givenName', '.metadata.item_1532070986701.givenNames[0].givenNameLang', '.metadata.item_1532070986701.nameIdentifiers[0].nameIdentifier', '.metadata.item_1532070986701.nameIdentifiers[0].nameIdentifierScheme', '.metadata.item_1532070986701.nameIdentifiers[0].nameIdentifierURI', '.metadata.item_1532071014836.contributorAffiliations[0].contributorAffiliationNameIdentifiers[0].contributorAffiliationNameIdentifier', '.metadata.item_1532071014836.contributorAffiliations[0].contributorAffiliationNameIdentifiers[0].contributorAffiliationScheme', '.metadata.item_1532071014836.contributorAffiliations[0].contributorAffiliationNameIdentifiers[0].contributorAffiliationURI', '.metadata.item_1532071014836.contributorAffiliations[0].contributorAffiliationNames[0].contributorAffiliationName', '.metadata.item_1532071014836.contributorAffiliations[0].contributorAffiliationNames[0].contributorAffiliationNameLang', '.metadata.item_1532071014836.contributorAlternatives[0].contributorAlternative', '.metadata.item_1532071014836.contributorAlternatives[0].contributorAlternativeLang', '.metadata.item_1532071014836.contributorMails[0].contributorMail', '.metadata.item_1532071014836.contributorNames[0].contributorName', '.metadata.item_1532071014836.contributorNames[0].lang', '.metadata.item_1532071014836.contributorType', '.metadata.item_1532071014836.familyNames[0].familyName', '.metadata.item_1532071014836.familyNames[0].familyNameLang', '.metadata.item_1532071014836.givenNames[0].givenName', '.metadata.item_1532071014836.givenNames[0].givenNameLang', '.metadata.item_1532071014836.nameIdentifiers[0].nameIdentifier', '.metadata.item_1532071014836.nameIdentifiers[0].nameIdentifierScheme', '.metadata.item_1532071014836.nameIdentifiers[0].nameIdentifierURI', '.metadata.item_1532071031458.subitem_1522299639480', '.metadata.item_1532071031458.subitem_1600958577026', '.metadata.item_1532071039842[0].subitem_1522650717957', '.metadata.item_1532071039842[0].subitem_1522650727486', '.metadata.item_1532071039842[0].subitem_1522651041219', '.metadata.item_1532071057095[0].subitem_1522299896455', '.metadata.item_1532071057095[0].subitem_1522300014469', '.metadata.item_1532071057095[0].subitem_1522300048512', '.metadata.item_1532071057095[0].subitem_1523261968819', '.metadata.item_1532071068215[0].subitem_1522657647525', '.metadata.item_1532071068215[0].subitem_1522657697257', '.metadata.item_1532071068215[0].subitem_1523262169140', '.metadata.item_1532071093517[0].subitem_1522300295150', '.metadata.item_1532071093517[0].subitem_1522300316516', '.metadata.item_1532071103206[0].subitem_1522300695726', '.metadata.item_1532071103206[0].subitem_1522300722591', '.metadata.item_1569380622649.resourcetype', '.metadata.item_1569380622649.resourceuri', '.metadata.item_1581493352241.subitem_1569224170590', '.metadata.item_1581493352241.subitem_1569224172438', '.metadata.item_1532071133483', '.metadata.item_1532071158138[0].subitem_1522306207484', '.metadata.item_1532071158138[0].subitem_1522306287251.subitem_1522306382014', '.metadata.item_1532071158138[0].subitem_1522306287251.subitem_1522306436033', '.metadata.item_1532071158138[0].subitem_1523320863692[0].subitem_1523320867455', '.metadata.item_1532071158138[0].subitem_1523320863692[0].subitem_1523320909613', '.metadata.item_1532071168802[0].subitem_1522658018441', '.metadata.item_1532071168802[0].subitem_1522658031721', '.metadata.item_1532071184504[0].subitem_1522658250154.subitem_1522658252485', '.metadata.item_1532071184504[0].subitem_1522658250154.subitem_1522658264346', '.metadata.item_1532071184504[0].subitem_1522658250154.subitem_1522658270105', '.metadata.item_1532071184504[0].subitem_1522658250154.subitem_1522658274386', '.metadata.item_1532071184504[0].subitem_1523321394401.subitem_1523321400758', '.metadata.item_1532071184504[0].subitem_1523321394401.subitem_1523321450098', '.metadata.item_1532071184504[0].subitem_1523321527273', '.metadata.item_1532071200841[0].subitem_1522399143519.subitem_1522399281603', '.metadata.item_1532071200841[0].subitem_1522399143519.subitem_1522399333375', '.metadata.item_1532071200841[0].subitem_1522399412622[0].subitem_1522399416691', '.metadata.item_1532071200841[0].subitem_1522399412622[0].subitem_1522737543681', '.metadata.item_1532071200841[0].subitem_1522399571623.subitem_1522399585738', '.metadata.item_1532071200841[0].subitem_1522399571623.subitem_1522399628911', '.metadata.item_1532071200841[0].subitem_1522399651758[0].subitem_1522721910626', '.metadata.item_1532071200841[0].subitem_1522399651758[0].subitem_1522721929892', '.metadata.item_1532071216312[0].subitem_1522652546580.subitem_1522652548920', '.metadata.item_1532071216312[0].subitem_1522652546580.subitem_1522652672693', '.metadata.item_1532071216312[0].subitem_1522652546580.subitem_1522652685531', '.metadata.item_1532071216312[0].subitem_1522652734962', '.metadata.item_1532071216312[0].subitem_1522652740098[0].subitem_1522722119299', '.metadata.item_1532071216312[0].subitem_1522652747880[0].subitem_1522722132466', '.metadata.item_1532071216312[0].subitem_1522652747880[0].subitem_1522739295711', '.metadata.item_1532071216312[0].subitem_1523325300505', '.thumbnail_path', '.metadata.item_1568286510993.subitem_thumbnail[0].thumbnail_label', '.metadata.item_1568286510993.subitem_thumbnail[0].thumbnail_url', '.file_path[0]', '.metadata.item_1600165182071[0].accessrole', '.metadata.item_1600165182071[0].date[0].dateType', '.metadata.item_1600165182071[0].date[0].dateValue', '.metadata.item_1600165182071[0].displaytype', '.metadata.item_1600165182071[0].filename', '.metadata.item_1600165182071[0].filesize[0].value', '.metadata.item_1600165182071[0].format', '.metadata.item_1600165182071[0].groupsprice[0].group', '.metadata.item_1600165182071[0].groupsprice[0].price', '.metadata.item_1600165182071[0].is_billing', '.metadata.item_1600165182071[0].licensefree', '.metadata.item_1600165182071[0].licensetype', '.metadata.item_1600165182071[0].url.label', '.metadata.item_1600165182071[0].url.objectType', '.metadata.item_1600165182071[0].url.url', '.metadata.item_1600165182071[0].version'], ['#ID', 'URI', '.IndexID[0]', '.POS_INDEX[0]', '.PUBLISH_STATUS', '.FEEDBACK_MAIL[0]', '.CNRI', '.DOI_RA', '.DOI', 'Keep/Upgrade Version', 'PubDate', 'Title.Title', 'Title.Language', 'Language.Language', 'Keyword.', 'Keyword.Scheme', 'Keyword.URI', 'Keyword.', 'Creator.[0].[0].', 'Creator.[0].[0].', 'Creator.[0].[0].URI', 'Creator.[0].[0].', 'Creator.[0].[0].', 'Creator.[0].', 'Creator.[0].', 'Creator.[0].', 'Creator.[0].', 'Creator.[0].', 'Creator.[0].', 'Creator.[0].', 'Creator.[0].', 'Creator.[0].', 'Creator.[0].', 'Creator.[0].Scheme', 'Creator.[0].URI', 'Contributor.[0].[0].', 'Contributor.[0].[0].', 'Contributor.[0].[0].URI', 'Contributor.[0].[0].', 'Contributor.[0].[0].', 'Contributor.[0].', 'Contributor.[0].', 'Contributor.[0].', 'Contributor.[0].', 'Contributor.[0].', 'Contributor.', 'Contributor.[0].', 'Contributor.[0].', 'Contributor.[0]. ', 'Contributor.[0].', 'Contributor.[0].', 'Contributor.[0].Scheme', 'Contributor.[0].URI', 'Access Rights.', 'Access Rights.URI', 'Rights Information[0].', 'Rights Information[0].Resource', 'Rights Information[0].', 'Subject[0].', 'Subject[0].Scheme', 'Subject[0].URI', 'Subject[0].', 'Content Description[0].', 'Content Description[0].', 'Content Description[0].', 'Publisher[0].', 'Publisher[0].', 'Date[0].', 'Date[0].', 'Resource Type.Type', 'Resource Type.Resource', 'Identifier rRegistration.Identifier Registration', 'Identifier rRegistration.Identifier Registration Type', 'Version information', 'Related information[0].', 'Related information[0]..', 'Related information[0]..', 'Related information[0].[0].', 'Related information[0].[0].', 'Time Range[0].', 'Time Range[0].', 'Location Information[0].. ', 'Location Information[0]..', 'Location Information[0]..', 'Location Information[0]..', 'Location Information[0]..', 'Location Information[0]..', 'Location Information[0].', 'Grant information[0]..', 'Grant information[0]..', 'Grant information[0]. [0].', 'Grant information[0]. [0].', 'Grant information[0]..URI', 'Grant information[0]..', 'Grant information[0].[0].', 'Grant information[0].[0]. ', 'File Information[0].URL.', 'File Information[0].URL.', 'File Information[0].URL.URL', 'File Information[0].', 'File Information[0].[0].', 'File Information[0].[0].', 'File Information[0].[0].', 'File Information[0].', '.', 'Thumbnail.URI[0].URI Label', 'Thumbnail.URI[0].URI', '.[0]', 'Billing File Information[0].', 'Billing File Information[0].[0].', 'Billing File Information[0].[0].', 'Billing File Information[0].', 'Billing File Information[0].', 'Billing File Information[0].[0].', 'Billing File Information[0]. ', 'Billing File Information[0].[0].', 'Billing File Information[0].[0].', 'Billing File Information[0].Is Billing', 'Billing File Information[0].', 'Billing File Information[0].', 'Billing File Information[0].URL.', 'Billing File Information[0].URL. ', 'Billing File Information[0].URL.URL', 'Billing File Information[0].'], ['#', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'System', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'System', 'System', 'System', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'System', 'System', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['#', '', 'Allow Multiple', 'Allow Multiple', 'Required', 'Allow Multiple', '', '', '', 'Required', 'Required', 'Required', 'Required', 'Required', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Required', 'Required', '', '', '', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', '', 'Hide', 'Hide', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple', 'Allow Multiple']], {'7': ['1', 'Index(public_state = True,harvest_public_state = True)', 'public', '', '', '', '', 'Keep', '2022-08-25', '', 'ja', 'jpn', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'A', 'ja', '', '', 'repoadmin@test.org', '', 'ja', 'ContactPerson', '', '', '', '', '', '', '', 'open access', 'http://purl.org/coar/access_right/c_abf2', 'ja', 'CC0', '', 'ja', 'NDC', '', '', 'abstract', '', 'ja', '', '', '', '', 'dataset', 'http://purl.org/coar/resource_type/c_ddb1', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'Crossref Funder', 'https://dx.doi.org/10.13039/501100001863', 'ja', 'NEDO', '', '12345678', 'ja', '', '', '', '', '', '1GB', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '']})
                )
E               AssertionError: assert ([['#.id', '....'', '', ...]}) == ([['#.id', '....'', '', ...]})
E                 At index 1 diff: {'7': [1, 'Index(public_state = True,harvest_public_state = True)', 'public', '', '', '', '', 'Keep', '2022-08-25', '', 'ja', 'jpn', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'A', 'ja', '', '', 'repoadmin@test.org', '', 'ja', 'ContactPerson', '', '', '', '', '', '', '', 'open access', 'http://purl.org/coar/access_right/c_abf2', 'ja', 'CC0', '', 'ja', 'NDC', '', '', 'abstract', '...
E                 
E                 ...Full output truncated (624 lines hidden), use '-vv' to show

tests/test_utils.py:9122: AssertionError
------------------------------ Captured log setup ------------------------------
WARNING  flask.app:ext.py:255 JSONSCHEMAS_HOST is set to localhost
_________________________ test_get_json_schema[0-200] __________________________

client = <FlaskClient <Flask 'testapp'>>
users = [{'email': 'contributor@test.org', 'id': 2, 'obj': <User 2>}, {'email': 'repoadmin@test.org', 'id': 4, 'obj': <User 4>...eneraluser@test.org', 'id': 6, 'obj': <User 5>}, {'email': 'originalroleuser@test.org', 'id': 7, 'obj': <User 7>}, ...]
db_itemtype = {'item_type': <ItemType 1>, 'item_type_mapping': <ItemTypeMapping 1>, 'item_type_name': <ItemTypeName 1>}
db_itemtype5 = {'item_type': <ItemType 5>, 'item_type_mapping': <ItemTypeMapping 5>, 'item_type_name': <ItemTypeName 5>}
id = 0, status_code = 200

    @pytest.mark.parametrize(
        "id, status_code",
        [
            (0, 200),
        ],
    )
    def test_get_json_schema(client, users, db_itemtype, db_itemtype5, id, status_code):
        login_user_via_session(client=client, email=users[id]["email"])
        url = url_for("weko_items_ui.get_json_schema", item_type_id=0, _external=True)
        res = client.get(url)
        assert res.status_code == status_code
        assert json.loads(res.data) == {}
    
        res = None
        url = url_for(
            "weko_items_ui.get_json_schema",
            item_type_id=0,
            activity_id="A-00000000-00000",
            _external=True,
        )
        res = client.get(url)
        assert res.status_code == status_code
        assert json.loads(res.data) == {}
    
        res = None
        url = url_for(
            "weko_items_ui.get_json_schema",
            item_type_id=99,
            activity_id="A-00000000-00000",
            _external=True,
        )
        res = client.get(url)
        assert res.status_code == 400
    
        res = None
        url = url_for("weko_items_ui.get_json_schema", item_type_id=1, _external=True)
        res = client.get(url)
        assert res.status_code == status_code
        assert json.loads(res.data) == {
            "$schema": "http://json-schema.org/draft-04/schema#",
            "description": "",
            "properties": {
                "item_1617186331708": {
                    "items": {
                        "properties": {
                            "subitem_1551255647225": {
                                "format": "text",
                                "title": "Title",
                                "title_i18n": {"en": "Title", "ja": ""},
                                "title_i18n_temp": {"en": "Title", "ja": ""},
                                "type": "string",
                            },
                            "subitem_1551255648112": {
                                "currentEnum": [
                                    "ja",
                                    "ja-Kana",
                                    "en",
                                    "fr",
                                    "it",
                                    "de",
                                    "es",
                                    "zh-cn",
                                    "zh-tw",
                                    "ru",
                                    "la",
                                    "ms",
                                    "eo",
                                    "ar",
                                    "el",
                                    "ko",
                                ],
                                "enum": [
                                    None,
                                    "ja",
                                    "ja-Kana",
                                    "en",
                                    "fr",
                                    "it",
                                    "de",
                                    "es",
                                    "zh-cn",
                                    "zh-tw",
                                    "ru",
                                    "la",
                                    "ms",
                                    "eo",
                                    "ar",
                                    "el",
                                    "ko",
                                ],
                                "format": "select",
                                "title": "Language",
                                "type": ["null", "string"],
                            },
                        },
                        "required": ["subitem_1551255647225", "subitem_1551255648112"],
                        "type": "object",
                    },
                    "maxItems": 9999,
                    "minItems": 1,
                    "title": "Title",
                    "type": "array",
                },
                "item_1617186385884": {
                    "items": {
                        "properties": {
                            "subitem_1551255720400": {
                                "format": "text",
                                "title": "Alternative Title",
                                "title_i18n": {"en": "Alternative Title", "ja": ""},
                                "title_i18n_temp": {
                                    "en": "Alternative Title",
                                    "ja": "",
                                },
                                "type": "string",
                            },
                            "subitem_1551255721061": {
                                "currentEnum": [
                                    "ja",
                                    "ja-Kana",
                                    "en",
                                    "fr",
                                    "it",
                                    "de",
                                    "es",
                                    "zh-cn",
                                    "zh-tw",
                                    "ru",
                                    "la",
                                    "ms",
                                    "eo",
                                    "ar",
                                    "el",
                                    "ko",
                                ],
                                "enum": [
                                    None,
                                    "ja",
                                    "ja-Kana",
                                    "en",
                                    "fr",
                                    "it",
                                    "de",
                                    "es",
                                    "zh-cn",
                                    "zh-tw",
                                    "ru",
                                    "la",
                                    "ms",
                                    "eo",
                                    "ar",
                                    "el",
                                    "ko",
                                ],
                                "format": "select",
                                "title": "Language",
                                "type": ["null", "string"],
                            },
                        },
                        "type": "object",
                    },
                    "maxItems": 9999,
                    "minItems": 1,
                    "title": "Alternative Title",
                    "type": "array",
                },
                "item_1617186419668": {
                    "items": {
                        "properties": {
                            "creatorAffiliations": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "affiliationNameIdentifiers": {
                                            "format": "array",
                                            "items": {
                                                "format": "object",
                                                "properties": {
                                                    "affiliationNameIdentifier": {
                                                        "format": "text",
                                                        "title": "",
                                                        "title_i18n": {
                                                            "en": "Affiliation Name Identifier",
                                                            "ja": "",
                                                        },
                                                        "title_i18n_temp": {
                                                            "en": "Affiliation Name Identifier",
                                                            "ja": "",
                                                        },
                                                        "type": "string",
                                                    },
                                                    "affiliationNameIdentifierScheme": {
                                                        "currentEnum": [
                                                            "kakenhi",
                                                            "ISNI",
                                                            "Ringgold",
                                                            "GRID",
                                                        ],
                                                        "enum": [
                                                            None,
                                                            "kakenhi",
                                                            "ISNI",
                                                            "Ringgold",
                                                            "GRID",
                                                        ],
                                                        "format": "select",
                                                        "title": "",
                                                        "type": ["null", "string"],
                                                    },
                                                    "affiliationNameIdentifierURI": {
                                                        "format": "text",
                                                        "title": "URI",
                                                        "title_i18n": {
                                                            "en": "Affiliation Name Identifier URI",
                                                            "ja": "URI",
                                                        },
                                                        "title_i18n_temp": {
                                                            "en": "Affiliation Name Identifier URI",
                                                            "ja": "URI",
                                                        },
                                                        "type": "string",
                                                    },
                                                },
                                                "type": "object",
                                            },
                                            "title": "",
                                            "type": "array",
                                        },
                                        "affiliationNames": {
                                            "format": "array",
                                            "items": {
                                                "format": "object",
                                                "properties": {
                                                    "affiliationName": {
                                                        "format": "text",
                                                        "title": "",
                                                        "title_i18n": {
                                                            "en": "Affiliation Name",
                                                            "ja": "",
                                                        },
                                                        "title_i18n_temp": {
                                                            "en": "Affiliation Name",
                                                            "ja": "",
                                                        },
                                                        "type": "string",
                                                    },
                                                    "affiliationNameLang": {
                                                        "currentEnum": [
                                                            "ja",
                                                            "ja-Kana",
                                                            "en",
                                                            "fr",
                                                            "it",
                                                            "de",
                                                            "es",
                                                            "zh-cn",
                                                            "zh-tw",
                                                            "ru",
                                                            "la",
                                                            "ms",
                                                            "eo",
                                                            "ar",
                                                            "el",
                                                            "ko",
                                                        ],
                                                        "enum": [
                                                            None,
                                                            "ja",
                                                            "ja-Kana",
                                                            "en",
                                                            "fr",
                                                            "it",
                                                            "de",
                                                            "es",
                                                            "zh-cn",
                                                            "zh-tw",
                                                            "ru",
                                                            "la",
                                                            "ms",
                                                            "eo",
                                                            "ar",
                                                            "el",
                                                            "ko",
                                                        ],
                                                        "format": "select",
                                                        "title": "",
                                                        "type": ["null", "string"],
                                                    },
                                                },
                                                "type": "object",
                                            },
                                            "title": "",
                                            "type": "array",
                                        },
                                    },
                                    "type": "object",
                                },
                                "title": "",
                                "type": "array",
                            },
                            "creatorAlternatives": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "creatorAlternative": {
                                            "format": "text",
                                            "title": "",
                                            "title_i18n": {
                                                "en": "Alternative Name",
                                                "ja": "",
                                            },
                                            "title_i18n_temp": {
                                                "en": "Alternative Name",
                                                "ja": "",
                                            },
                                            "type": "string",
                                        },
                                        "creatorAlternativeLang": {
                                            "currentEnum": [
                                                "ja",
                                                "ja-Kana",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "enum": [
                                                None,
                                                "ja",
                                                "ja-Kana",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "format": "select",
                                            "title": "",
                                            "type": ["null", "string"],
                                        },
                                    },
                                    "type": "object",
                                },
                                "title": "",
                                "type": "array",
                            },
                            "creatorMails": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "creatorMail": {
                                            "format": "text",
                                            "title": "",
                                            "title_i18n": {
                                                "en": "Email Address",
                                                "ja": "",
                                            },
                                            "title_i18n_temp": {
                                                "en": "Email Address",
                                                "ja": "",
                                            },
                                            "type": "string",
                                        }
                                    },
                                    "type": "object",
                                },
                                "title": "",
                                "type": "array",
                            },
                            "creatorNames": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "creatorName": {
                                            "format": "text",
                                            "title": "",
                                            "title_i18n": {"en": "Name", "ja": ""},
                                            "title_i18n_temp": {"en": "Name", "ja": ""},
                                            "type": "string",
                                        },
                                        "creatorNameLang": {
                                            "currentEnum": [
                                                "ja",
                                                "ja-Kana",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "enum": [
                                                None,
                                                "ja",
                                                "ja-Kana",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "format": "select",
                                            "title": "",
                                            "type": ["null", "string"],
                                        },
                                    },
                                    "type": "object",
                                },
                                "title": "",
                                "type": "array",
                            },
                            "familyNames": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "familyName": {
                                            "format": "text",
                                            "title": "",
                                            "title_i18n": {"en": "Family Name", "ja": ""},
                                            "title_i18n_temp": {
                                                "en": "Family Name",
                                                "ja": "",
                                            },
                                            "type": "string",
                                        },
                                        "familyNameLang": {
                                            "currentEnum": [
                                                "ja",
                                                "ja-Kana",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "enum": [
                                                None,
                                                "ja",
                                                "ja-Kana",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "format": "select",
                                            "title": "",
                                            "type": ["null", "string"],
                                        },
                                    },
                                    "type": "object",
                                },
                                "title": "",
                                "type": "array",
                            },
                            "givenNames": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "givenName": {
                                            "format": "text",
                                            "title": "",
                                            "title_i18n": {"en": "Given Name", "ja": ""},
                                            "title_i18n_temp": {
                                                "en": "Given Name",
                                                "ja": "",
                                            },
                                            "type": "string",
                                        },
                                        "givenNameLang": {
                                            "currentEnum": [
                                                "ja",
                                                "ja-Kana",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "enum": [
                                                None,
                                                "ja",
                                                "ja-Kana",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "format": "select",
                                            "title": "",
                                            "type": ["null", "string"],
                                        },
                                    },
                                    "type": "object",
                                },
                                "title": "",
                                "type": "array",
                            },
                            "iscreator": {
                                "format": "text",
                                "title": "iscreator",
                                "title_i18n": {"en": "", "ja": ""},
                                "type": "string",
                                "uniqueKey": "item_1617186419668_iscreator",
                            },
                            "nameIdentifiers": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "nameIdentifier": {
                                            "format": "text",
                                            "title": "",
                                            "title_i18n": {
                                                "en": "Creator Identifier",
                                                "ja": "",
                                            },
                                            "title_i18n_temp": {
                                                "en": "Creator Identifier",
                                                "ja": "",
                                            },
                                            "type": "string",
                                        },
                                        "nameIdentifierScheme": {
                                            "currentEnum": [],
                                            "format": "select",
                                            "title": "Scheme",
                                            "type": ["null", "string"],
                                        },
                                        "nameIdentifierURI": {
                                            "format": "text",
                                            "title": "URI",
                                            "title_i18n": {
                                                "en": "Creator Identifier URI",
                                                "ja": "URI",
                                            },
                                            "title_i18n_temp": {
                                                "en": "Creator Identifier URI",
                                                "ja": "URI",
                                            },
                                            "type": "string",
                                        },
                                    },
                                    "type": "object",
                                },
                                "title": "",
                                "type": "array",
                            },
                        },
                        "type": "object",
                    },
                    "maxItems": 9999,
                    "minItems": 1,
                    "title": "Creator",
                    "type": "array",
                },
                "item_1617186476635": {
                    "properties": {
                        "subitem_1522299639480": {
                            "currentEnum": [
                                "embargoed access",
                                "metadata only access",
                                "open access",
                                "restricted access",
                            ],
                            "enum": [
                                None,
                                "embargoed access",
                                "metadata only access",
                                "open access",
                                "restricted access",
                            ],
                            "format": "select",
                            "title": "",
                            "type": ["null", "string"],
                        },
                        "subitem_1600958577026": {
                            "format": "text",
                            "title": "URI",
                            "title_i18n": {"en": "Access Rights URI", "ja": "URI"},
                            "title_i18n_temp": {
                                "en": "Access Rights URI",
                                "ja": "URI",
                            },
                            "type": "string",
                        },
                    },
                    "title": "Access Rights",
                    "type": "object",
                },
                "item_1617186499011": {
                    "items": {
                        "properties": {
                            "subitem_1522650717957": {
                                "currentEnum": [
                                    "ja",
                                    "en",
                                    "fr",
                                    "it",
                                    "de",
                                    "es",
                                    "zh-cn",
                                    "zh-tw",
                                    "ru",
                                    "la",
                                    "ms",
                                    "eo",
                                    "ar",
                                    "el",
                                    "ko",
                                ],
                                "enum": [
                                    None,
                                    "ja",
                                    "en",
                                    "fr",
                                    "it",
                                    "de",
                                    "es",
                                    "zh-cn",
                                    "zh-tw",
                                    "ru",
                                    "la",
                                    "ms",
                                    "eo",
                                    "ar",
                                    "el",
                                    "ko",
                                ],
                                "format": "select",
                                "title": "",
                                "type": ["null", "string"],
                            },
                            "subitem_1522650727486": {
                                "format": "text",
                                "title": "Resource",
                                "title_i18n": {
                                    "en": "Rights Information Resource",
                                    "ja": "Resource",
                                },
                                "title_i18n_temp": {
                                    "en": "Rights Information Resource",
                                    "ja": "Resource",
                                },
                                "type": "string",
                            },
                            "subitem_1522651041219": {
                                "format": "text",
                                "title": "",
                                "title_i18n": {"en": "Rights Information", "ja": ""},
                                "title_i18n_temp": {
                                    "en": "Rights Information",
                                    "ja": "",
                                },
                                "type": "string",
                            },
                        },
                        "type": "object",
                    },
                    "maxItems": 9999,
                    "minItems": 1,
                    "title": "Rights",
                    "type": "array",
                },
                "item_1617186609386": {
                    "items": {
                        "properties": {
                            "subitem_1522299896455": {
                                "currentEnum": [
                                    "ja",
                                    "ja-Kana",
                                    "en",
                                    "fr",
                                    "it",
                                    "de",
                                    "es",
                                    "zh-cn",
                                    "zh-tw",
                                    "ru",
                                    "la",
                                    "ms",
                                    "eo",
                                    "ar",
                                    "el",
                                    "ko",
                                ],
                                "enum": [
                                    None,
                                    "ja",
                                    "ja-Kana",
                                    "en",
                                    "fr",
                                    "it",
                                    "de",
                                    "es",
                                    "zh-cn",
                                    "zh-tw",
                                    "ru",
                                    "la",
                                    "ms",
                                    "eo",
                                    "ar",
                                    "el",
                                    "ko",
                                ],
                                "format": "select",
                                "title": "",
                                "type": ["null", "string"],
                            },
                            "subitem_1522300014469": {
                                "currentEnum": [
                                    "BSH",
                                    "DDC",
                                    "LCC",
                                    "LCSH",
                                    "MeSH",
                                    "NDC",
                                    "NDLC",
                                    "NDLSH",
                                    "SciVal",
                                    "UDC",
                                    "Other",
                                ],
                                "enum": [
                                    None,
                                    "BSH",
                                    "DDC",
                                    "LCC",
                                    "LCSH",
                                    "MeSH",
                                    "NDC",
                                    "NDLC",
                                    "NDLSH",
                                    "SciVal",
                                    "UDC",
                                    "Other",
                                ],
                                "format": "select",
                                "title": "Scheme",
                                "type": ["null", "string"],
                            },
                            "subitem_1522300048512": {
                                "format": "text",
                                "title": "URI",
                                "title_i18n": {"en": "Subject URI", "ja": "URI"},
                                "title_i18n_temp": {"en": "Subject URI", "ja": "URI"},
                                "type": "string",
                            },
                            "subitem_1523261968819": {
                                "format": "text",
                                "title": "",
                                "title_i18n": {"en": "Subject", "ja": ""},
                                "title_i18n_temp": {"en": "Subject", "ja": ""},
                                "type": "string",
                            },
                        },
                        "type": "object",
                    },
                    "maxItems": 9999,
                    "minItems": 1,
                    "title": "Subject",
                    "type": "array",
                },
                "item_1617186626617": {
                    "items": {
                        "properties": {
                            "subitem_description": {
                                "format": "textarea",
                                "title": "",
                                "title_i18n": {"en": "Description", "ja": ""},
                                "title_i18n_temp": {"en": "Description", "ja": ""},
                                "type": "string",
                            },
                            "subitem_description_language": {
                                "currentEnum": [
                                    "ja",
                                    "en",
                                    "fr",
                                    "it",
                                    "de",
                                    "es",
                                    "zh-cn",
                                    "zh-tw",
                                    "ru",
                                    "la",
                                    "ms",
                                    "eo",
                                    "ar",
                                    "el",
                                    "ko",
                                ],
                                "enum": [
                                    None,
                                    "ja",
                                    "en",
                                    "fr",
                                    "it",
                                    "de",
                                    "es",
                                    "zh-cn",
                                    "zh-tw",
                                    "ru",
                                    "la",
                                    "ms",
                                    "eo",
                                    "ar",
                                    "el",
                                    "ko",
                                ],
                                "format": "select",
                                "title": "",
                                "type": ["null", "string"],
                            },
                            "subitem_description_type": {
                                "currentEnum": [
                                    "Abstract",
                                    "Methods",
                                    "TableOfContents",
                                    "TechnicalInfo",
                                    "Other",
                                ],
                                "enum": [
                                    None,
                                    "Abstract",
                                    "Methods",
                                    "TableOfContents",
                                    "TechnicalInfo",
                                    "Other",
                                ],
                                "format": "select",
                                "title": "",
                                "type": ["null", "string"],
                            },
                        },
                        "type": "object",
                    },
                    "maxItems": 9999,
                    "minItems": 1,
                    "title": "Description",
                    "type": "array",
                },
                "item_1617186643794": {
                    "items": {
                        "properties": {
                            "subitem_1522300295150": {
                                "currentEnum": [
                                    "ja",
                                    "en",
                                    "fr",
                                    "it",
                                    "de",
                                    "es",
                                    "zh-cn",
                                    "zh-tw",
                                    "ru",
                                    "la",
                                    "ms",
                                    "eo",
                                    "ar",
                                    "el",
                                    "ko",
                                ],
                                "enum": [
                                    None,
                                    "ja",
                                    "en",
                                    "fr",
                                    "it",
                                    "de",
                                    "es",
                                    "zh-cn",
                                    "zh-tw",
                                    "ru",
                                    "la",
                                    "ms",
                                    "eo",
                                    "ar",
                                    "el",
                                    "ko",
                                ],
                                "format": "select",
                                "title": "",
                                "type": ["null", "string"],
                            },
                            "subitem_1522300316516": {
                                "format": "text",
                                "title": "",
                                "title_i18n": {"en": "Publisher", "ja": ""},
                                "title_i18n_temp": {"en": "Publisher", "ja": ""},
                                "type": "string",
                            },
                        },
                        "type": "object",
                    },
                    "maxItems": 9999,
                    "minItems": 1,
                    "title": "Publisher",
                    "type": "array",
                },
                "item_1617186660861": {
                    "items": {
                        "properties": {
                            "subitem_1522300695726": {
                                "currentEnum": [
                                    "Accepted",
                                    "Available",
                                    "Collected",
                                    "Copyrighted",
                                    "Created",
                                    "Issued",
                                    "Submitted",
                                    "Updated",
                                    "Valid",
                                ],
                                "enum": [
                                    None,
                                    "Accepted",
                                    "Available",
                                    "Collected",
                                    "Copyrighted",
                                    "Created",
                                    "Issued",
                                    "Submitted",
                                    "Updated",
                                    "Valid",
                                ],
                                "format": "select",
                                "title": "",
                                "type": ["null", "string"],
                            },
                            "subitem_1522300722591": {
                                "format": "datetime",
                                "title": "",
                                "title_i18n": {"en": "Date", "ja": ""},
                                "title_i18n_temp": {"en": "Date", "ja": ""},
                                "type": "string",
                            },
                        },
                        "type": "object",
                    },
                    "maxItems": 9999,
                    "minItems": 1,
                    "title": "Date",
                    "type": "array",
                },
                "item_1617186702042": {
                    "items": {
                        "properties": {
                            "subitem_1551255818386": {
                                "currentEnum": [
                                    "jpn",
                                    "eng",
                                    "fra",
                                    "ita",
                                    "spa",
                                    "zho",
                                    "rus",
                                    "lat",
                                    "msa",
                                    "epo",
                                    "ara",
                                    "ell",
                                    "kor",
                                ],
                                "enum": [
                                    None,
                                    "jpn",
                                    "eng",
                                    "fra",
                                    "ita",
                                    "spa",
                                    "zho",
                                    "rus",
                                    "lat",
                                    "msa",
                                    "epo",
                                    "ara",
                                    "ell",
                                    "kor",
                                ],
                                "format": "select",
                                "title": "Language",
                                "type": ["null", "string"],
                            }
                        },
                        "type": "object",
                    },
                    "maxItems": 9999,
                    "minItems": 1,
                    "title": "Language",
                    "type": "array",
                },
                "item_1617186783814": {
                    "items": {
                        "properties": {
                            "subitem_identifier_type": {
                                "currentEnum": ["DOI", "HDL", "URI"],
                                "enum": [None, "DOI", "HDL", "URI"],
                                "format": "select",
                                "title": "",
                                "type": ["null", "string"],
                            },
                            "subitem_identifier_uri": {
                                "format": "text",
                                "title": "",
                                "title_i18n": {"en": "Identifier", "ja": ""},
                                "title_i18n_temp": {"en": "Identifier", "ja": ""},
                                "type": "string",
                            },
                        },
                        "type": "object",
                    },
                    "maxItems": 9999,
                    "minItems": 1,
                    "title": "Identifier",
                    "type": "array",
                },
                "item_1617186819068": {
                    "properties": {
                        "subitem_identifier_reg_text": {
                            "format": "text",
                            "title": "ID",
                            "title_i18n": {"en": "Identifier Registration", "ja": "ID"},
                            "title_i18n_temp": {
                                "en": "Identifier Registration",
                                "ja": "ID",
                            },
                            "type": "string",
                        },
                        "subitem_identifier_reg_type": {
                            "currentEnum": ["JaLC", "Crossref", "DataCite", "PMID"],
                            "enum": [None, "JaLC", "Crossref", "DataCite", "PMID"],
                            "format": "select",
                            "title": "ID",
                            "type": ["null", "string"],
                        },
                    },
                    "title": "Identifier Registration",
                    "type": "object",
                },
                "item_1617186859717": {
                    "items": {
                        "properties": {
                            "subitem_1522658018441": {
                                "currentEnum": [
                                    "ja",
                                    "en",
                                    "fr",
                                    "it",
                                    "de",
                                    "es",
                                    "zh-cn",
                                    "zh-tw",
                                    "ru",
                                    "la",
                                    "ms",
                                    "eo",
                                    "ar",
                                    "el",
                                    "ko",
                                ],
                                "enum": [
                                    None,
                                    "ja",
                                    "en",
                                    "fr",
                                    "it",
                                    "de",
                                    "es",
                                    "zh-cn",
                                    "zh-tw",
                                    "ru",
                                    "la",
                                    "ms",
                                    "eo",
                                    "ar",
                                    "el",
                                    "ko",
                                ],
                                "format": "select",
                                "title": "",
                                "type": ["null", "string"],
                            },
                            "subitem_1522658031721": {
                                "format": "text",
                                "title": "",
                                "title_i18n": {"en": "Temporal", "ja": ""},
                                "title_i18n_temp": {"en": "Temporal", "ja": ""},
                                "type": "string",
                            },
                        },
                        "type": "object",
                    },
                    "maxItems": 9999,
                    "minItems": 1,
                    "title": "Temporal",
                    "type": "array",
                },
                "item_1617186882738": {
                    "items": {
                        "properties": {
                            "subitem_geolocation_box": {
                                "format": "object",
                                "properties": {
                                    "subitem_east_longitude": {
                                        "format": "text",
                                        "title": "",
                                        "title_i18n": {
                                            "en": "East Bound Longitude",
                                            "ja": "",
                                        },
                                        "title_i18n_temp": {
                                            "en": "East Bound Longitude",
                                            "ja": "",
                                        },
                                        "type": "string",
                                    },
                                    "subitem_north_latitude": {
                                        "format": "text",
                                        "title": "",
                                        "title_i18n": {
                                            "en": "North Bound Latitude",
                                            "ja": "",
                                        },
                                        "title_i18n_temp": {
                                            "en": "North Bound Latitude",
                                            "ja": "",
                                        },
                                        "type": "string",
                                    },
                                    "subitem_south_latitude": {
                                        "format": "text",
                                        "title": "",
                                        "title_i18n": {
                                            "en": "South Bound Latitude",
                                            "ja": "",
                                        },
                                        "title_i18n_temp": {
                                            "en": "South Bound Latitude",
                                            "ja": "",
                                        },
                                        "type": "string",
                                    },
                                    "subitem_west_longitude": {
                                        "format": "text",
                                        "title": "",
                                        "title_i18n": {
                                            "en": "West Bound Longitude",
                                            "ja": "",
                                        },
                                        "title_i18n_temp": {
                                            "en": "West Bound Longitude",
                                            "ja": "",
                                        },
                                        "type": "string",
                                    },
                                },
                                "title": "",
                                "type": "object",
                            },
                            "subitem_geolocation_place": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "subitem_geolocation_place_text": {
                                            "format": "text",
                                            "title": "",
                                            "title_i18n": {
                                                "en": "Geo Location Place",
                                                "ja": "",
                                            },
                                            "title_i18n_temp": {
                                                "en": "Geo Location Place",
                                                "ja": "",
                                            },
                                            "type": "string",
                                        }
                                    },
                                    "type": "object",
                                },
                                "title": "",
                                "type": "array",
                            },
                            "subitem_geolocation_point": {
                                "format": "object",
                                "properties": {
                                    "subitem_point_latitude": {
                                        "format": "text",
                                        "title": "",
                                        "title_i18n": {"en": "Point Latitude", "ja": ""},
                                        "title_i18n_temp": {
                                            "en": "Point Latitude",
                                            "ja": "",
                                        },
                                        "type": "string",
                                    },
                                    "subitem_point_longitude": {
                                        "format": "text",
                                        "title": "",
                                        "title_i18n": {"en": "Point Longitude", "ja": ""},
                                        "title_i18n_temp": {
                                            "en": "Point Longitude",
                                            "ja": "",
                                        },
                                        "type": "string",
                                    },
                                },
                                "title": "",
                                "type": "object",
                            },
                        },
                        "type": "object",
                    },
                    "maxItems": 9999,
                    "minItems": 1,
                    "title": "Geo Location",
                    "type": "array",
                },
                "item_1617186901218": {
                    "items": {
                        "properties": {
                            "subitem_1522399143519": {
                                "format": "object",
                                "properties": {
                                    "subitem_1522399281603": {
                                        "currentEnum": [
                                            "Crossref Funder",
                                            "GRID",
                                            "ISNI",
                                            "Other",
                                            "kakenhi",
                                        ],
                                        "enum": [
                                            None,
                                            "Crossref Funder",
                                            "GRID",
                                            "ISNI",
                                            "Other",
                                            "kakenhi",
                                        ],
                                        "format": "select",
                                        "title": "",
                                        "type": ["null", "string"],
                                    },
                                    "subitem_1522399333375": {
                                        "format": "text",
                                        "title": "",
                                        "title_i18n": {
                                            "en": "Funder Identifier",
                                            "ja": "",
                                        },
                                        "title_i18n_temp": {
                                            "en": "Funder Identifier",
                                            "ja": "",
                                        },
                                        "type": "string",
                                    },
                                },
                                "title": "",
                                "type": "object",
                            },
                            "subitem_1522399412622": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "subitem_1522399416691": {
                                            "currentEnum": [
                                                "ja",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "enum": [
                                                None,
                                                "ja",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "format": "select",
                                            "title": "",
                                            "type": ["null", "string"],
                                        },
                                        "subitem_1522737543681": {
                                            "format": "text",
                                            "title": "",
                                            "title_i18n": {
                                                "en": "Funder Name",
                                                "ja": "",
                                            },
                                            "title_i18n_temp": {
                                                "en": "Funder Name",
                                                "ja": "",
                                            },
                                            "type": "string",
                                        },
                                    },
                                    "type": "object",
                                },
                                "title": "",
                                "type": "array",
                            },
                            "subitem_1522399571623": {
                                "format": "object",
                                "properties": {
                                    "subitem_1522399585738": {
                                        "format": "text",
                                        "title": "URI",
                                        "title_i18n": {"en": "Award URI", "ja": "URI"},
                                        "title_i18n_temp": {
                                            "en": "Award URI",
                                            "ja": "URI",
                                        },
                                        "type": "string",
                                    },
                                    "subitem_1522399628911": {
                                        "format": "text",
                                        "title": "",
                                        "title_i18n": {
                                            "en": "Award Number",
                                            "ja": "",
                                        },
                                        "title_i18n_temp": {
                                            "en": "Award Number",
                                            "ja": "",
                                        },
                                        "type": "string",
                                    },
                                },
                                "title": "",
                                "type": "object",
                            },
                            "subitem_1522399651758": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "subitem_1522721910626": {
                                            "currentEnum": [
                                                "ja",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "enum": [
                                                None,
                                                "ja",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "format": "select",
                                            "title": "",
                                            "type": ["null", "string"],
                                        },
                                        "subitem_1522721929892": {
                                            "format": "text",
                                            "title": "",
                                            "title_i18n": {
                                                "en": "Award Title",
                                                "ja": "",
                                            },
                                            "title_i18n_temp": {
                                                "en": "Award Title",
                                                "ja": "",
                                            },
                                            "type": "string",
                                        },
                                    },
                                    "type": "object",
                                },
                                "title": "",
                                "type": "array",
                            },
                        },
                        "type": "object",
                    },
                    "maxItems": 9999,
                    "minItems": 1,
                    "title": "Funding Reference",
                    "type": "array",
                },
                "item_1617186920753": {
                    "items": {
                        "properties": {
                            "subitem_1522646500366": {
                                "currentEnum": ["PISSN", "EISSN", "ISSN", "NCID"],
                                "enum": [None, "PISSN", "EISSN", "ISSN", "NCID"],
                                "format": "select",
                                "title": "",
                                "type": ["null", "string"],
                            },
                            "subitem_1522646572813": {
                                "format": "text",
                                "title": "",
                                "title_i18n": {"en": "Source Identifier", "ja": ""},
                                "title_i18n_temp": {
                                    "en": "Source Identifier",
                                    "ja": "",
                                },
                                "type": "string",
                            },
                        },
                        "type": "object",
                    },
                    "maxItems": 9999,
                    "minItems": 1,
                    "title": "Source Identifier",
                    "type": "array",
                },
                "item_1617186941041": {
                    "items": {
                        "properties": {
                            "subitem_1522650068558": {
                                "currentEnum": [
                                    "ja",
                                    "en",
                                    "fr",
                                    "it",
                                    "de",
                                    "es",
                                    "zh-cn",
                                    "zh-tw",
                                    "ru",
                                    "la",
                                    "ms",
                                    "eo",
                                    "ar",
                                    "el",
                                    "ko",
                                ],
                                "enum": [
                                    None,
                                    "ja",
                                    "en",
                                    "fr",
                                    "it",
                                    "de",
                                    "es",
                                    "zh-cn",
                                    "zh-tw",
                                    "ru",
                                    "la",
                                    "ms",
                                    "eo",
                                    "ar",
                                    "el",
                                    "ko",
                                ],
                                "format": "select",
                                "title": "",
                                "type": ["null", "string"],
                            },
                            "subitem_1522650091861": {
                                "format": "text",
                                "title": "",
                                "title_i18n": {"en": "Source Title", "ja": ""},
                                "title_i18n_temp": {"en": "Source Title", "ja": ""},
                                "type": "string",
                            },
                        },
                        "type": "object",
                    },
                    "maxItems": 9999,
                    "minItems": 1,
                    "title": "Source Title",
                    "type": "array",
                },
                "item_1617186959569": {
                    "properties": {
                        "subitem_1551256328147": {
                            "format": "text",
                            "title": "Volume Number",
                            "title_i18n": {"en": "Volume Number", "ja": ""},
                            "title_i18n_temp": {"en": "Volume Number", "ja": ""},
                            "type": "string",
                        }
                    },
                    "title": "Volume Number",
                    "type": "object",
                },
                "item_1617186981471": {
                    "properties": {
                        "subitem_1551256294723": {
                            "format": "text",
                            "title": "Issue Number",
                            "title_i18n": {"en": "Issue Number", "ja": ""},
                            "title_i18n_temp": {"en": "Issue Number", "ja": ""},
                            "type": "string",
                        }
                    },
                    "title": "Issue Number",
                    "type": "object",
                },
                "item_1617186994930": {
                    "properties": {
                        "subitem_1551256248092": {
                            "format": "text",
                            "title": "Number of Pages",
                            "title_i18n": {"en": "Number of Pages", "ja": ""},
                            "title_i18n_temp": {"en": "Number of Pages", "ja": ""},
                            "type": "string",
                        }
                    },
                    "title": "Number of Pages",
                    "type": "object",
                },
                "item_1617187024783": {
                    "properties": {
                        "subitem_1551256198917": {
                            "format": "text",
                            "title": "Page Start",
                            "title_i18n": {"en": "Page Start", "ja": ""},
                            "title_i18n_temp": {"en": "Page Start", "ja": ""},
                            "type": "string",
                        }
                    },
                    "title": "Page Start",
                    "type": "object",
                },
                "item_1617187045071": {
                    "properties": {
                        "subitem_1551256185532": {
                            "format": "text",
                            "title": "Page End",
                            "title_i18n": {"en": "Page End", "ja": ""},
                            "title_i18n_temp": {"en": "Page End", "ja": ""},
                            "type": "string",
                        }
                    },
                    "title": "Page End",
                    "type": "object",
                },
                "item_1617187056579": {
                    "properties": {
                        "bibliographicIssueDates": {
                            "format": "object",
                            "properties": {
                                "bibliographicIssueDate": {
                                    "format": "datetime",
                                    "title": "",
                                    "title_i18n": {"en": "Date", "ja": ""},
                                    "title_i18n_temp": {"en": "Date", "ja": ""},
                                    "type": "string",
                                },
                                "bibliographicIssueDateType": {
                                    "currentEnum": ["Issued"],
                                    "enum": [None, "Issued"],
                                    "format": "select",
                                    "title": "",
                                    "type": ["null", "string"],
                                },
                            },
                            "title": "",
                            "type": "object",
                        },
                        "bibliographicIssueNumber": {
                            "format": "text",
                            "title": "",
                            "title_i18n": {"en": "Issue Number", "ja": ""},
                            "title_i18n_temp": {"en": "Issue Number", "ja": ""},
                            "type": "string",
                        },
                        "bibliographicNumberOfPages": {
                            "format": "text",
                            "title": "",
                            "title_i18n": {"en": "Number of Page", "ja": ""},
                            "title_i18n_temp": {"en": "Number of Page", "ja": ""},
                            "type": "string",
                        },
                        "bibliographicPageEnd": {
                            "format": "text",
                            "title": "",
                            "title_i18n": {"en": "Page End", "ja": ""},
                            "title_i18n_temp": {"en": "Page End", "ja": ""},
                            "type": "string",
                        },
                        "bibliographicPageStart": {
                            "format": "text",
                            "title": "",
                            "title_i18n": {"en": "Page Start", "ja": ""},
                            "title_i18n_temp": {"en": "Page Start", "ja": ""},
                            "type": "string",
                        },
                        "bibliographicVolumeNumber": {
                            "format": "text",
                            "title": "",
                            "title_i18n": {"en": "Volume Number", "ja": ""},
                            "title_i18n_temp": {"en": "Volume Number", "ja": ""},
                            "type": "string",
                        },
                        "bibliographic_titles": {
                            "format": "array",
                            "items": {
                                "format": "object",
                                "properties": {
                                    "bibliographic_title": {
                                        "format": "text",
                                        "title": "",
                                        "title_i18n": {"en": "Title", "ja": ""},
                                        "title_i18n_temp": {"en": "Title", "ja": ""},
                                        "type": "string",
                                    },
                                    "bibliographic_titleLang": {
                                        "currentEnum": [
                                            "ja",
                                            "en",
                                            "fr",
                                            "it",
                                            "de",
                                            "es",
                                            "zh-cn",
                                            "zh-tw",
                                            "ru",
                                            "la",
                                            "ms",
                                            "eo",
                                            "ar",
                                            "el",
                                            "ko",
                                        ],
                                        "enum": [
                                            None,
                                            "ja",
                                            "en",
                                            "fr",
                                            "it",
                                            "de",
                                            "es",
                                            "zh-cn",
                                            "zh-tw",
                                            "ru",
                                            "la",
                                            "ms",
                                            "eo",
                                            "ar",
                                            "el",
                                            "ko",
                                        ],
                                        "format": "select",
                                        "title": "",
                                        "type": ["null", "string"],
                                    },
                                },
                                "type": "object",
                            },
                            "title": "",
                            "type": "array",
                        },
                    },
                    "title": "Bibliographic Information",
                    "type": "object",
                },
                "item_1617187087799": {
                    "properties": {
                        "subitem_1551256171004": {
                            "format": "text",
                            "title": "Dissertation Number",
                            "title_i18n": {"en": "Dissertation Number", "ja": ""},
                            "title_i18n_temp": {
                                "en": "Dissertation Number",
                                "ja": "",
                            },
                            "type": "string",
                        }
                    },
                    "title": "Dissertation Number",
                    "type": "object",
                },
                "item_1617187112279": {
                    "items": {
                        "properties": {
                            "subitem_1551256126428": {
                                "format": "text",
                                "title": "Degree Name",
                                "title_i18n": {"en": "Degree Name", "ja": ""},
                                "title_i18n_temp": {"en": "Degree Name", "ja": ""},
                                "type": "string",
                            },
                            "subitem_1551256129013": {
                                "currentEnum": [
                                    "ja",
                                    "en",
                                    "fr",
                                    "it",
                                    "de",
                                    "es",
                                    "zh-cn",
                                    "zh-tw",
                                    "ru",
                                    "la",
                                    "ms",
                                    "eo",
                                    "ar",
                                    "el",
                                    "ko",
                                ],
                                "enum": [
                                    None,
                                    "ja",
                                    "en",
                                    "fr",
                                    "it",
                                    "de",
                                    "es",
                                    "zh-cn",
                                    "zh-tw",
                                    "ru",
                                    "la",
                                    "ms",
                                    "eo",
                                    "ar",
                                    "el",
                                    "ko",
                                ],
                                "format": "select",
                                "title": "Language",
                                "type": ["null", "string"],
                            },
                        },
                        "type": "object",
                    },
                    "maxItems": 9999,
                    "minItems": 1,
                    "title": "Degree Name",
                    "type": "array",
                },
                "item_1617187136212": {
                    "properties": {
                        "subitem_1551256096004": {
                            "format": "datetime",
                            "title": "Date Granted",
                            "title_i18n": {"en": "Date Granted", "ja": ""},
                            "title_i18n_temp": {"en": "Date Granted", "ja": ""},
                            "type": "string",
                        }
                    },
                    "title": "Date Granted",
                    "type": "object",
                },
                "item_1617187187528": {
                    "items": {
                        "properties": {
                            "subitem_1599711633003": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "subitem_1599711636923": {
                                            "format": "text",
                                            "title": "Conference Name",
                                            "title_i18n": {
                                                "en": "Conference Name",
                                                "ja": "",
                                            },
                                            "title_i18n_temp": {
                                                "en": "Conference Name",
                                                "ja": "",
                                            },
                                            "type": "string",
                                        },
                                        "subitem_1599711645590": {
                                            "currentEnum": [
                                                "ja",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "enum": [
                                                None,
                                                "ja",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "format": "select",
                                            "title": "Language",
                                            "type": ["null", "string"],
                                        },
                                    },
                                    "type": "object",
                                },
                                "title": "Conference Name",
                                "type": "array",
                            },
                            "subitem_1599711655652": {
                                "format": "text",
                                "title": "Conference Sequence",
                                "title_i18n": {"en": "Conference Sequence", "ja": ""},
                                "title_i18n_temp": {
                                    "en": "Conference Sequence",
                                    "ja": "",
                                },
                                "type": "string",
                            },
                            "subitem_1599711660052": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "subitem_1599711680082": {
                                            "format": "text",
                                            "title": "Conference Sponsor",
                                            "title_i18n": {
                                                "en": "Conference Sponsor",
                                                "ja": "",
                                            },
                                            "title_i18n_temp": {
                                                "en": "Conference Sponsor",
                                                "ja": "",
                                            },
                                            "type": "string",
                                        },
                                        "subitem_1599711686511": {
                                            "currentEnum": [
                                                "ja",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "enum": [
                                                None,
                                                "ja",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "format": "select",
                                            "title": "Language",
                                            "type": ["null", "string"],
                                        },
                                    },
                                    "type": "object",
                                },
                                "title": "Conference Sponsor",
                                "type": "array",
                            },
                            "subitem_1599711699392": {
                                "format": "object",
                                "properties": {
                                    "subitem_1599711704251": {
                                        "format": "text",
                                        "title": "Conference Date",
                                        "title_i18n": {
                                            "en": "Conference Date",
                                            "ja": "",
                                        },
                                        "title_i18n_temp": {
                                            "en": "Conference Date",
                                            "ja": "",
                                        },
                                        "type": "string",
                                    },
                                    "subitem_1599711712451": {
                                        "format": "text",
                                        "title": "Start Day",
                                        "title_i18n": {"en": "Start Day", "ja": ""},
                                        "title_i18n_temp": {"en": "Start Day", "ja": ""},
                                        "type": "string",
                                    },
                                    "subitem_1599711727603": {
                                        "format": "text",
                                        "title": "Start Month",
                                        "title_i18n": {"en": "Start Month", "ja": ""},
                                        "title_i18n_temp": {
                                            "en": "Start Month",
                                            "ja": "",
                                        },
                                        "type": "string",
                                    },
                                    "subitem_1599711731891": {
                                        "format": "text",
                                        "title": "Start Year",
                                        "title_i18n": {"en": "Start Year", "ja": ""},
                                        "title_i18n_temp": {
                                            "en": "Start Year",
                                            "ja": "",
                                        },
                                        "type": "string",
                                    },
                                    "subitem_1599711735410": {
                                        "format": "text",
                                        "title": "End Day",
                                        "title_i18n": {"en": "End Day", "ja": ""},
                                        "title_i18n_temp": {"en": "End Day", "ja": ""},
                                        "type": "string",
                                    },
                                    "subitem_1599711739022": {
                                        "format": "text",
                                        "title": "End Month",
                                        "title_i18n": {"en": "End Month", "ja": ""},
                                        "title_i18n_temp": {"en": "End Month", "ja": ""},
                                        "type": "string",
                                    },
                                    "subitem_1599711743722": {
                                        "format": "text",
                                        "title": "End Year",
                                        "title_i18n": {"en": "End Year", "ja": ""},
                                        "title_i18n_temp": {"en": "End Year", "ja": ""},
                                        "type": "string",
                                    },
                                    "subitem_1599711745532": {
                                        "currentEnum": [
                                            "ja",
                                            "en",
                                            "fr",
                                            "it",
                                            "de",
                                            "es",
                                            "zh-cn",
                                            "zh-tw",
                                            "ru",
                                            "la",
                                            "ms",
                                            "eo",
                                            "ar",
                                            "el",
                                            "ko",
                                        ],
                                        "enum": [
                                            None,
                                            "ja",
                                            "en",
                                            "fr",
                                            "it",
                                            "de",
                                            "es",
                                            "zh-cn",
                                            "zh-tw",
                                            "ru",
                                            "la",
                                            "ms",
                                            "eo",
                                            "ar",
                                            "el",
                                            "ko",
                                        ],
                                        "format": "select",
                                        "title": "Language",
                                        "type": ["null", "string"],
                                    },
                                },
                                "title": "Conference Date",
                                "type": "object",
                            },
                            "subitem_1599711758470": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "subitem_1599711769260": {
                                            "format": "text",
                                            "title": "Conference Venue",
                                            "title_i18n": {
                                                "en": "Conference Venue",
                                                "ja": "",
                                            },
                                            "title_i18n_temp": {
                                                "en": "Conference Venue",
                                                "ja": "",
                                            },
                                            "type": "string",
                                        },
                                        "subitem_1599711775943": {
                                            "currentEnum": [
                                                "ja",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "enum": [
                                                None,
                                                "ja",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "format": "select",
                                            "title": "Language",
                                            "type": ["null", "string"],
                                        },
                                    },
                                    "type": "object",
                                },
                                "title": "Conference Venue",
                                "type": "array",
                            },
                            "subitem_1599711788485": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "subitem_1599711798761": {
                                            "format": "text",
                                            "title": "Conference Place",
                                            "title_i18n": {
                                                "en": "Conference Place",
                                                "ja": "",
                                            },
                                            "title_i18n_temp": {
                                                "en": "Conference Place",
                                                "ja": "",
                                            },
                                            "type": "string",
                                        },
                                        "subitem_1599711803382": {
                                            "currentEnum": [
                                                "ja",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "enum": [
                                                None,
                                                "ja",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "format": "select",
                                            "title": "Language",
                                            "type": ["null", "string"],
                                        },
                                    },
                                    "type": "object",
                                },
                                "title": "Conference Place",
                                "type": "array",
                            },
                            "subitem_1599711813532": {
                                "currentEnum": [
                                    "JPN",
                                    "ABW",
                                    "AFG",
                                    "AGO",
                                    "AIA",
                                    "ALA",
                                    "ALB",
                                    "AND",
                                    "ARE",
                                    "ARG",
                                    "ARM",
                                    "ASM",
                                    "ATA",
                                    "ATF",
                                    "ATG",
                                    "AUS",
                                    "AUT",
                                    "AZE",
                                    "BDI",
                                    "BEL",
                                    "BEN",
                                    "BES",
                                    "BFA",
                                    "BGD",
                                    "BGR",
                                    "BHR",
                                    "BHS",
                                    "BIH",
                                    "BLM",
                                    "BLR",
                                    "BLZ",
                                    "BMU",
                                    "BOL",
                                    "BRA",
                                    "BRB",
                                    "BRN",
                                    "BTN",
                                    "BVT",
                                    "BWA",
                                    "CAF",
                                    "CAN",
                                    "CCK",
                                    "CHE",
                                    "CHL",
                                    "CHN",
                                    "CIV",
                                    "CMR",
                                    "COD",
                                    "COG",
                                    "COK",
                                    "COL",
                                    "COM",
                                    "CPV",
                                    "CRI",
                                    "CUB",
                                    "CUW",
                                    "CXR",
                                    "CYM",
                                    "CYP",
                                    "CZE",
                                    "DEU",
                                    "DJI",
                                    "DMA",
                                    "DNK",
                                    "DOM",
                                    "DZA",
                                    "ECU",
                                    "EGY",
                                    "ERI",
                                    "ESH",
                                    "ESP",
                                    "EST",
                                    "ETH",
                                    "FIN",
                                    "FJI",
                                    "FLK",
                                    "FRA",
                                    "FRO",
                                    "FSM",
                                    "GAB",
                                    "GBR",
                                    "GEO",
                                    "GGY",
                                    "GHA",
                                    "GIB",
                                    "GIN",
                                    "GLP",
                                    "GMB",
                                    "GNB",
                                    "GNQ",
                                    "GRC",
                                    "GRD",
                                    "GRL",
                                    "GTM",
                                    "GUF",
                                    "GUM",
                                    "GUY",
                                    "HKG",
                                    "HMD",
                                    "HND",
                                    "HRV",
                                    "HTI",
                                    "HUN",
                                    "IDN",
                                    "IMN",
                                    "IND",
                                    "IOT",
                                    "IRL",
                                    "IRN",
                                    "IRQ",
                                    "ISL",
                                    "ISR",
                                    "ITA",
                                    "JAM",
                                    "JEY",
                                    "JOR",
                                    "KAZ",
                                    "KEN",
                                    "KGZ",
                                    "KHM",
                                    "KIR",
                                    "KNA",
                                    "KOR",
                                    "KWT",
                                    "LAO",
                                    "LBN",
                                    "LBR",
                                    "LBY",
                                    "LCA",
                                    "LIE",
                                    "LKA",
                                    "LSO",
                                    "LTU",
                                    "LUX",
                                    "LVA",
                                    "MAC",
                                    "MAF",
                                    "MAR",
                                    "MCO",
                                    "MDA",
                                    "MDG",
                                    "MDV",
                                    "MEX",
                                    "MHL",
                                    "MKD",
                                    "MLI",
                                    "MLT",
                                    "MMR",
                                    "MNE",
                                    "MNG",
                                    "MNP",
                                    "MOZ",
                                    "MRT",
                                    "MSR",
                                    "MTQ",
                                    "MUS",
                                    "MWI",
                                    "MYS",
                                    "MYT",
                                    "NAM",
                                    "NCL",
                                    "NER",
                                    "NFK",
                                    "NGA",
                                    "NIC",
                                    "NIU",
                                    "NLD",
                                    "NOR",
                                    "NPL",
                                    "NRU",
                                    "NZL",
                                    "OMN",
                                    "PAK",
                                    "PAN",
                                    "PCN",
                                    "PER",
                                    "PHL",
                                    "PLW",
                                    "PNG",
                                    "POL",
                                    "PRI",
                                    "PRK",
                                    "PRT",
                                    "PRY",
                                    "PSE",
                                    "PYF",
                                    "QAT",
                                    "REU",
                                    "ROU",
                                    "RUS",
                                    "RWA",
                                    "SAU",
                                    "SDN",
                                    "SEN",
                                    "SGP",
                                    "SGS",
                                    "SHN",
                                    "SJM",
                                    "SLB",
                                    "SLE",
                                    "SLV",
                                    "SMR",
                                    "SOM",
                                    "SPM",
                                    "SRB",
                                    "SSD",
                                    "STP",
                                    "SUR",
                                    "SVK",
                                    "SVN",
                                    "SWE",
                                    "SWZ",
                                    "SXM",
                                    "SYC",
                                    "SYR",
                                    "TCA",
                                    "TCD",
                                    "TGO",
                                    "THA",
                                    "TJK",
                                    "TKL",
                                    "TKM",
                                    "TLS",
                                    "TON",
                                    "TTO",
                                    "TUN",
                                    "TUR",
                                    "TUV",
                                    "TWN",
                                    "TZA",
                                    "UGA",
                                    "UKR",
                                    "UMI",
                                    "URY",
                                    "USA",
                                    "UZB",
                                    "VAT",
                                    "VCT",
                                    "VEN",
                                    "VGB",
                                    "VIR",
                                    "VNM",
                                    "VUT",
                                    "WLF",
                                    "WSM",
                                    "YEM",
                                    "ZAF",
                                    "ZMB",
                                    "ZWE",
                                ],
                                "enum": [
                                    None,
                                    "JPN",
                                    "ABW",
                                    "AFG",
                                    "AGO",
                                    "AIA",
                                    "ALA",
                                    "ALB",
                                    "AND",
                                    "ARE",
                                    "ARG",
                                    "ARM",
                                    "ASM",
                                    "ATA",
                                    "ATF",
                                    "ATG",
                                    "AUS",
                                    "AUT",
                                    "AZE",
                                    "BDI",
                                    "BEL",
                                    "BEN",
                                    "BES",
                                    "BFA",
                                    "BGD",
                                    "BGR",
                                    "BHR",
                                    "BHS",
                                    "BIH",
                                    "BLM",
                                    "BLR",
                                    "BLZ",
                                    "BMU",
                                    "BOL",
                                    "BRA",
                                    "BRB",
                                    "BRN",
                                    "BTN",
                                    "BVT",
                                    "BWA",
                                    "CAF",
                                    "CAN",
                                    "CCK",
                                    "CHE",
                                    "CHL",
                                    "CHN",
                                    "CIV",
                                    "CMR",
                                    "COD",
                                    "COG",
                                    "COK",
                                    "COL",
                                    "COM",
                                    "CPV",
                                    "CRI",
                                    "CUB",
                                    "CUW",
                                    "CXR",
                                    "CYM",
                                    "CYP",
                                    "CZE",
                                    "DEU",
                                    "DJI",
                                    "DMA",
                                    "DNK",
                                    "DOM",
                                    "DZA",
                                    "ECU",
                                    "EGY",
                                    "ERI",
                                    "ESH",
                                    "ESP",
                                    "EST",
                                    "ETH",
                                    "FIN",
                                    "FJI",
                                    "FLK",
                                    "FRA",
                                    "FRO",
                                    "FSM",
                                    "GAB",
                                    "GBR",
                                    "GEO",
                                    "GGY",
                                    "GHA",
                                    "GIB",
                                    "GIN",
                                    "GLP",
                                    "GMB",
                                    "GNB",
                                    "GNQ",
                                    "GRC",
                                    "GRD",
                                    "GRL",
                                    "GTM",
                                    "GUF",
                                    "GUM",
                                    "GUY",
                                    "HKG",
                                    "HMD",
                                    "HND",
                                    "HRV",
                                    "HTI",
                                    "HUN",
                                    "IDN",
                                    "IMN",
                                    "IND",
                                    "IOT",
                                    "IRL",
                                    "IRN",
                                    "IRQ",
                                    "ISL",
                                    "ISR",
                                    "ITA",
                                    "JAM",
                                    "JEY",
                                    "JOR",
                                    "KAZ",
                                    "KEN",
                                    "KGZ",
                                    "KHM",
                                    "KIR",
                                    "KNA",
                                    "KOR",
                                    "KWT",
                                    "LAO",
                                    "LBN",
                                    "LBR",
                                    "LBY",
                                    "LCA",
                                    "LIE",
                                    "LKA",
                                    "LSO",
                                    "LTU",
                                    "LUX",
                                    "LVA",
                                    "MAC",
                                    "MAF",
                                    "MAR",
                                    "MCO",
                                    "MDA",
                                    "MDG",
                                    "MDV",
                                    "MEX",
                                    "MHL",
                                    "MKD",
                                    "MLI",
                                    "MLT",
                                    "MMR",
                                    "MNE",
                                    "MNG",
                                    "MNP",
                                    "MOZ",
                                    "MRT",
                                    "MSR",
                                    "MTQ",
                                    "MUS",
                                    "MWI",
                                    "MYS",
                                    "MYT",
                                    "NAM",
                                    "NCL",
                                    "NER",
                                    "NFK",
                                    "NGA",
                                    "NIC",
                                    "NIU",
                                    "NLD",
                                    "NOR",
                                    "NPL",
                                    "NRU",
                                    "NZL",
                                    "OMN",
                                    "PAK",
                                    "PAN",
                                    "PCN",
                                    "PER",
                                    "PHL",
                                    "PLW",
                                    "PNG",
                                    "POL",
                                    "PRI",
                                    "PRK",
                                    "PRT",
                                    "PRY",
                                    "PSE",
                                    "PYF",
                                    "QAT",
                                    "REU",
                                    "ROU",
                                    "RUS",
                                    "RWA",
                                    "SAU",
                                    "SDN",
                                    "SEN",
                                    "SGP",
                                    "SGS",
                                    "SHN",
                                    "SJM",
                                    "SLB",
                                    "SLE",
                                    "SLV",
                                    "SMR",
                                    "SOM",
                                    "SPM",
                                    "SRB",
                                    "SSD",
                                    "STP",
                                    "SUR",
                                    "SVK",
                                    "SVN",
                                    "SWE",
                                    "SWZ",
                                    "SXM",
                                    "SYC",
                                    "SYR",
                                    "TCA",
                                    "TCD",
                                    "TGO",
                                    "THA",
                                    "TJK",
                                    "TKL",
                                    "TKM",
                                    "TLS",
                                    "TON",
                                    "TTO",
                                    "TUN",
                                    "TUR",
                                    "TUV",
                                    "TWN",
                                    "TZA",
                                    "UGA",
                                    "UKR",
                                    "UMI",
                                    "URY",
                                    "USA",
                                    "UZB",
                                    "VAT",
                                    "VCT",
                                    "VEN",
                                    "VGB",
                                    "VIR",
                                    "VNM",
                                    "VUT",
                                    "WLF",
                                    "WSM",
                                    "YEM",
                                    "ZAF",
                                    "ZMB",
                                    "ZWE",
                                ],
                                "format": "select",
                                "title": "Conference Country",
                                "type": ["null", "string"],
                            },
                        },
                        "type": "object",
                    },
                    "maxItems": 9999,
                    "minItems": 1,
                    "title": "Conference",
                    "type": "array",
                },
                "item_1617258105262": {
                    "properties": {
                        "resourcetype": {
                            "currentEnum": [
                                "conference paper",
                                "data paper",
                                "departmental bulletin paper",
                                "editorial",
                                "journal article",
                                "newspaper",
                                "periodical",
                                "review article",
                                "software paper",
                                "article",
                                "book",
                                "book part",
                                "cartographic material",
                                "map",
                                "conference object",
                                "conference proceedings",
                                "conference poster",
                                "dataset",
                                "interview",
                                "image",
                                "still image",
                                "moving image",
                                "video",
                                "lecture",
                                "patent",
                                "internal report",
                                "report",
                                "research report",
                                "technical report",
                                "policy report",
                                "report part",
                                "working paper",
                                "data management plan",
                                "sound",
                                "thesis",
                                "bachelor thesis",
                                "master thesis",
                                "doctoral thesis",
                                "interactive resource",
                                "learning object",
                                "manuscript",
                                "musical notation",
                                "research proposal",
                                "software",
                                "technical documentation",
                                "workflow",
                                "other",
                            ],
                            "enum": [
                                None,
                                "conference paper",
                                "data paper",
                                "departmental bulletin paper",
                                "editorial",
                                "journal article",
                                "newspaper",
                                "periodical",
                                "review article",
                                "software paper",
                                "article",
                                "book",
                                "book part",
                                "cartographic material",
                                "map",
                                "conference object",
                                "conference proceedings",
                                "conference poster",
                                "dataset",
                                "interview",
                                "image",
                                "still image",
                                "moving image",
                                "video",
                                "lecture",
                                "patent",
                                "internal report",
                                "report",
                                "research report",
                                "technical report",
                                "policy report",
                                "report part",
                                "working paper",
                                "data management plan",
                                "sound",
                                "thesis",
                                "bachelor thesis",
                                "master thesis",
                                "doctoral thesis",
                                "interactive resource",
                                "learning object",
                                "manuscript",
                                "musical notation",
                                "research proposal",
                                "software",
                                "technical documentation",
                                "workflow",
                                "other",
                            ],
                            "format": "select",
                            "title": "",
                            "type": ["null", "string"],
                        },
                        "resourceuri": {
                            "format": "text",
                            "title": "",
                            "title_i18n": {
                                "en": "Resource Type Identifier",
                                "ja": "",
                            },
                            "title_i18n_temp": {
                                "en": "Resource Type Identifier",
                                "ja": "",
                            },
                            "type": "string",
                        },
                    },
                    "required": ["resourcetype", "resourceuri"],
                    "title": "Resource Type",
                    "type": "object",
                },
                "item_1617265215918": {
                    "properties": {
                        "subitem_1522305645492": {
                            "currentEnum": [
                                "AO",
                                "SMUR",
                                "AM",
                                "P",
                                "VoR",
                                "CVoR",
                                "EVoR",
                                "NA",
                            ],
                            "enum": [
                                None,
                                "AO",
                                "SMUR",
                                "AM",
                                "P",
                                "VoR",
                                "CVoR",
                                "EVoR",
                                "NA",
                            ],
                            "format": "select",
                            "title": "",
                            "type": ["null", "string"],
                        },
                        "subitem_1600292170262": {
                            "format": "text",
                            "title": "Resource",
                            "title_i18n": {
                                "en": "Version Type Resource",
                                "ja": "Resource",
                            },
                            "title_i18n_temp": {
                                "en": "Version Type Resource",
                                "ja": "Resource",
                            },
                            "type": "string",
                        },
                    },
                    "title": "Version Type",
                    "type": "object",
                },
                "item_1617349709064": {
                    "items": {
                        "properties": {
                            "contributorAffiliations": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "contributorAffiliationNameIdentifiers": {
                                            "format": "array",
                                            "items": {
                                                "format": "object",
                                                "properties": {
                                                    "contributorAffiliationNameIdentifier": {
                                                        "format": "text",
                                                        "title": "",
                                                        "title_i18n": {
                                                            "en": "Affiliation Name Identifier",
                                                            "ja": "",
                                                        },
                                                        "title_i18n_temp": {
                                                            "en": "Affiliation Name Identifier",
                                                            "ja": "",
                                                        },
                                                        "type": "string",
                                                    },
                                                    "contributorAffiliationScheme": {
                                                        "currentEnum": [
                                                            "kakenhi",
                                                            "ISNI",
                                                            "Ringgold",
                                                            "GRID",
                                                        ],
                                                        "enum": [
                                                            None,
                                                            "kakenhi",
                                                            "ISNI",
                                                            "Ringgold",
                                                            "GRID",
                                                        ],
                                                        "format": "select",
                                                        "title": "",
                                                        "type": ["null", "string"],
                                                    },
                                                    "contributorAffiliationURI": {
                                                        "format": "text",
                                                        "title": "URI",
                                                        "title_i18n": {
                                                            "en": "Affiliation Name Identifier URI",
                                                            "ja": "URI",
                                                        },
                                                        "title_i18n_temp": {
                                                            "en": "Affiliation Name Identifier URI",
                                                            "ja": "URI",
                                                        },
                                                        "type": "string",
                                                    },
                                                },
                                                "type": "object",
                                            },
                                            "title": "",
                                            "type": "array",
                                        },
                                        "contributorAffiliationNames": {
                                            "format": "array",
                                            "items": {
                                                "format": "object",
                                                "properties": {
                                                    "contributorAffiliationName": {
                                                        "format": "text",
                                                        "title": "",
                                                        "title_i18n": {
                                                            "en": "Affiliation Name",
                                                            "ja": "",
                                                        },
                                                        "title_i18n_temp": {
                                                            "en": "Affiliation Name",
                                                            "ja": "",
                                                        },
                                                        "type": "string",
                                                    },
                                                    "contributorAffiliationNameLang": {
                                                        "currentEnum": [
                                                            "ja",
                                                            "ja-Kana",
                                                            "en",
                                                            "fr",
                                                            "it",
                                                            "de",
                                                            "es",
                                                            "zh-cn",
                                                            "zh-tw",
                                                            "ru",
                                                            "la",
                                                            "ms",
                                                            "eo",
                                                            "ar",
                                                            "el",
                                                            "ko",
                                                        ],
                                                        "enum": [
                                                            None,
                                                            "ja",
                                                            "ja-Kana",
                                                            "en",
                                                            "fr",
                                                            "it",
                                                            "de",
                                                            "es",
                                                            "zh-cn",
                                                            "zh-tw",
                                                            "ru",
                                                            "la",
                                                            "ms",
                                                            "eo",
                                                            "ar",
                                                            "el",
                                                            "ko",
                                                        ],
                                                        "format": "select",
                                                        "title": "",
                                                        "type": ["null", "string"],
                                                    },
                                                },
                                                "type": "object",
                                            },
                                            "title": "",
                                            "type": "array",
                                        },
                                    },
                                    "type": "object",
                                },
                                "title": "",
                                "type": "array",
                            },
                            "contributorAlternatives": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "contributorAlternative": {
                                            "format": "text",
                                            "title": "",
                                            "title_i18n": {
                                                "en": "Alternative Name",
                                                "ja": "",
                                            },
                                            "title_i18n_temp": {
                                                "en": "Alternative Name",
                                                "ja": "",
                                            },
                                            "type": "string",
                                        },
                                        "contributorAlternativeLang": {
                                            "currentEnum": [
                                                "ja",
                                                "ja-Kana",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "enum": [
                                                None,
                                                "ja",
                                                "ja-Kana",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "format": "select",
                                            "title": "",
                                            "type": ["null", "string"],
                                        },
                                    },
                                    "type": "object",
                                },
                                "title": "",
                                "type": "array",
                            },
                            "contributorMails": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "contributorMail": {
                                            "format": "text",
                                            "title": "",
                                            "title_i18n": {
                                                "en": "Email Address",
                                                "ja": "",
                                            },
                                            "title_i18n_temp": {
                                                "en": "Email Address",
                                                "ja": "",
                                            },
                                            "type": "string",
                                        }
                                    },
                                    "type": "object",
                                },
                                "title": "",
                                "type": "array",
                            },
                            "contributorNames": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "contributorName": {
                                            "format": "text",
                                            "title": "",
                                            "title_i18n": {"en": "Name", "ja": ""},
                                            "title_i18n_temp": {"en": "Name", "ja": ""},
                                            "type": "string",
                                        },
                                        "lang": {
                                            "currentEnum": [
                                                "ja",
                                                "ja-Kana",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "enum": [
                                                None,
                                                "ja",
                                                "ja-Kana",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "format": "select",
                                            "title": "",
                                            "type": ["null", "string"],
                                        },
                                    },
                                    "type": "object",
                                },
                                "title": "",
                                "type": "array",
                            },
                            "contributorType": {
                                "currentEnum": [
                                    "ContactPerson",
                                    "DataCollector",
                                    "DataCurator",
                                    "DataManager",
                                    "Distributor",
                                    "Editor",
                                    "HostingInstitution",
                                    "Producer",
                                    "ProjectLeader",
                                    "ProjectManager",
                                    "ProjectMember",
                                    "RelatedPerson",
                                    "Researcher",
                                    "ResearchGroup",
                                    "Sponsor",
                                    "Supervisor",
                                    "WorkPackageLeader",
                                    "Other",
                                ],
                                "enum": [
                                    None,
                                    "ContactPerson",
                                    "DataCollector",
                                    "DataCurator",
                                    "DataManager",
                                    "Distributor",
                                    "Editor",
                                    "HostingInstitution",
                                    "Producer",
                                    "ProjectLeader",
                                    "ProjectManager",
                                    "ProjectMember",
                                    "RelatedPerson",
                                    "Researcher",
                                    "ResearchGroup",
                                    "Sponsor",
                                    "Supervisor",
                                    "WorkPackageLeader",
                                    "Other",
                                ],
                                "format": "select",
                                "title": "",
                                "type": ["null", "string"],
                            },
                            "familyNames": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "familyName": {
                                            "format": "text",
                                            "title": "",
                                            "title_i18n": {"en": "Family Name", "ja": ""},
                                            "title_i18n_temp": {
                                                "en": "Family Name",
                                                "ja": "",
                                            },
                                            "type": "string",
                                        },
                                        "familyNameLang": {
                                            "currentEnum": [
                                                "ja",
                                                "ja-Kana",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "enum": [
                                                None,
                                                "ja",
                                                "ja-Kana",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "format": "select",
                                            "title": "",
                                            "type": ["null", "string"],
                                        },
                                    },
                                    "type": "object",
                                },
                                "title": "",
                                "type": "array",
                            },
                            "givenNames": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "givenName": {
                                            "format": "text",
                                            "title": "",
                                            "title_i18n": {"en": "Given Name", "ja": ""},
                                            "title_i18n_temp": {
                                                "en": "Given Name",
                                                "ja": "",
                                            },
                                            "type": "string",
                                        },
                                        "givenNameLang": {
                                            "currentEnum": [
                                                "ja",
                                                "ja-Kana",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "enum": [
                                                None,
                                                "ja",
                                                "ja-Kana",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "format": "select",
                                            "title": "",
                                            "type": ["null", "string"],
                                        },
                                    },
                                    "type": "object",
                                },
                                "title": "",
                                "type": "array",
                            },
                            "nameIdentifiers": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "nameIdentifier": {
                                            "format": "text",
                                            "title": "",
                                            "title_i18n": {
                                                "en": "Contributor Identifier",
                                                "ja": "",
                                            },
                                            "title_i18n_temp": {
                                                "en": "Contributor Identifier",
                                                "ja": "",
                                            },
                                            "type": "string",
                                        },
                                        "nameIdentifierScheme": {
                                            "currentEnum": [],
                                            "format": "select",
                                            "title": "Scheme",
                                            "type": ["null", "string"],
                                        },
                                        "nameIdentifierURI": {
                                            "format": "text",
                                            "title": "URI",
                                            "title_i18n": {
                                                "en": "Contributor Identifier URI",
                                                "ja": "URI",
                                            },
                                            "title_i18n_temp": {
                                                "en": "Contributor Identifier URI",
                                                "ja": "URI",
                                            },
                                            "type": "string",
                                        },
                                    },
                                    "type": "object",
                                },
                                "title": "",
                                "type": "array",
                            },
                        },
                        "type": "object",
                    },
                    "maxItems": 9999,
                    "minItems": 1,
                    "title": "Contributor",
                    "type": "array",
                },
                "item_1617349808926": {
                    "properties": {
                        "subitem_1523263171732": {
                            "format": "text",
                            "title": "",
                            "title_i18n": {"en": "Version", "ja": ""},
                            "title_i18n_temp": {"en": "Version", "ja": ""},
                            "type": "string",
                        }
                    },
                    "title": "Version",
                    "type": "object",
                },
                "item_1617351524846": {
                    "properties": {
                        "subitem_1523260933860": {
                            "currentEnum": [
                                "Paid",
                                "Fully waived",
                                "Not required",
                                "Partially waived",
                                "Not charged",
                                "Unknown",
                            ],
                            "enum": [
                                None,
                                "Paid",
                                "Fully waived",
                                "Not required",
                                "Partially waived",
                                "Not charged",
                                "Unknown",
                            ],
                            "format": "select",
                            "title": "APC",
                            "type": ["null", "string"],
                        }
                    },
                    "title": "APC",
                    "type": "object",
                },
                "item_1617353299429": {
                    "items": {
                        "properties": {
                            "subitem_1522306207484": {
                                "currentEnum": [
                                    "isVersionOf",
                                    "hasVersion",
                                    "isPartOf",
                                    "hasPart",
                                    "isReferencedBy",
                                    "references",
                                    "isFormatOf",
                                    "hasFormat",
                                    "isReplacedBy",
                                    "replaces",
                                    "isRequiredBy",
                                    "requires",
                                    "isSupplementTo",
                                    "isSupplementedBy",
                                    "isIdenticalTo",
                                    "isDerivedFrom",
                                    "isSourceOf",
                                ],
                                "enum": [
                                    None,
                                    "isVersionOf",
                                    "hasVersion",
                                    "isPartOf",
                                    "hasPart",
                                    "isReferencedBy",
                                    "references",
                                    "isFormatOf",
                                    "hasFormat",
                                    "isReplacedBy",
                                    "replaces",
                                    "isRequiredBy",
                                    "requires",
                                    "isSupplementTo",
                                    "isSupplementedBy",
                                    "isIdenticalTo",
                                    "isDerivedFrom",
                                    "isSourceOf",
                                ],
                                "format": "select",
                                "title": "",
                                "type": ["null", "string"],
                            },
                            "subitem_1522306287251": {
                                "format": "object",
                                "properties": {
                                    "subitem_1522306382014": {
                                        "currentEnum": [
                                            "ARK",
                                            "arXiv",
                                            "DOI",
                                            "HDL",
                                            "ICHUSHI",
                                            "ISBN",
                                            "J-GLOBAL",
                                            "Local",
                                            "PISSN",
                                            "EISSN",
                                            "ISSN",
                                            "NAID",
                                            "NCID",
                                            "PMID",
                                            "PURL",
                                            "SCOPUS",
                                            "URI",
                                            "WOS",
                                        ],
                                        "enum": [
                                            None,
                                            "ARK",
                                            "arXiv",
                                            "DOI",
                                            "HDL",
                                            "ICHUSHI",
                                            "ISBN",
                                            "J-GLOBAL",
                                            "Local",
                                            "PISSN",
                                            "EISSN",
                                            "ISSN",
                                            "NAID",
                                            "NCID",
                                            "PMID",
                                            "PURL",
                                            "SCOPUS",
                                            "URI",
                                            "WOS",
                                        ],
                                        "format": "select",
                                        "title": "",
                                        "type": ["null", "string"],
                                    },
                                    "subitem_1522306436033": {
                                        "format": "text",
                                        "title": "",
                                        "title_i18n": {
                                            "en": "Relation Identifier",
                                            "ja": "",
                                        },
                                        "title_i18n_temp": {
                                            "en": "Relation Identifier",
                                            "ja": "",
                                        },
                                        "type": "string",
                                    },
                                },
                                "title": "",
                                "type": "object",
                            },
                            "subitem_1523320863692": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "subitem_1523320867455": {
                                            "currentEnum": [
                                                "ja",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "enum": [
                                                None,
                                                "ja",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "format": "select",
                                            "title": "",
                                            "type": ["null", "string"],
                                        },
                                        "subitem_1523320909613": {
                                            "format": "text",
                                            "title": "",
                                            "title_i18n": {
                                                "en": "Related Title",
                                                "ja": "",
                                            },
                                            "title_i18n_temp": {
                                                "en": "Related Title",
                                                "ja": "",
                                            },
                                            "type": "string",
                                        },
                                    },
                                    "type": "object",
                                },
                                "title": "",
                                "type": "array",
                            },
                        },
                        "type": "object",
                    },
                    "maxItems": 9999,
                    "minItems": 1,
                    "title": "Relation",
                    "type": "array",
                },
                "item_1617605131499": {
                    "items": {
                        "properties": {
                            "accessrole": {
                                "enum": [
                                    "open_access",
                                    "open_date",
                                    "open_login",
                                    "open_no",
                                ],
                                "format": "radios",
                                "title": "",
                                "type": ["null", "string"],
                            },
                            "date": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "dateType": {
                                            "currentEnum": [],
                                            "format": "select",
                                            "title": "",
                                            "type": ["null", "string"],
                                        },
                                        "dateValue": {
                                            "format": "datetime",
                                            "title": "",
                                            "title_i18n": {"en": "", "ja": ""},
                                            "type": "string",
                                        },
                                    },
                                    "type": "object",
                                },
                                "title": "",
                                "type": "array",
                            },
                            "displaytype": {
                                "currentEnum": ["detail", "simple", "preview"],
                                "enum": [None, "detail", "simple", "preview"],
                                "format": "select",
                                "title": "",
                                "type": ["null", "string"],
                            },
                            "fileDate": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "fileDateType": {
                                            "currentEnum": [
                                                "Accepted",
                                                "Collected",
                                                "Copyrighted",
                                                "Created",
                                                "Issued",
                                                "Submitted",
                                                "Updated",
                                                "Valid",
                                            ],
                                            "enum": [
                                                None,
                                                "Accepted",
                                                "Collected",
                                                "Copyrighted",
                                                "Created",
                                                "Issued",
                                                "Submitted",
                                                "Updated",
                                                "Valid",
                                            ],
                                            "format": "select",
                                            "title": "",
                                            "type": ["null", "string"],
                                        },
                                        "fileDateValue": {
                                            "format": "datetime",
                                            "title": "",
                                            "title_i18n": {"en": "Date", "ja": ""},
                                            "title_i18n_temp": {"en": "Date", "ja": ""},
                                            "type": "string",
                                        },
                                    },
                                    "type": "object",
                                },
                                "title": "",
                                "type": "array",
                            },
                            "filename": {
                                "format": "text",
                                "title": "",
                                "title_i18n": {"en": "FileName", "ja": ""},
                                "title_i18n_temp": {"en": "FileName", "ja": ""},
                                "type": ["null", "string"],
                            },
                            "filesize": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "value": {
                                            "format": "text",
                                            "title": "",
                                            "title_i18n": {"en": "Size", "ja": ""},
                                            "title_i18n_temp": {"en": "Size", "ja": ""},
                                            "type": "string",
                                        }
                                    },
                                    "type": "object",
                                },
                                "title": "",
                                "type": "array",
                            },
                            "format": {
                                "format": "text",
                                "title": "",
                                "title_i18n": {"en": "Format", "ja": ""},
                                "title_i18n_temp": {"en": "Format", "ja": ""},
                                "type": "string",
                            },
                            "groups": {
                                "currentEnum": [],
                                "format": "select",
                                "title": "",
                                "type": ["null", "string"],
                            },
                            "licensefree": {
                                "format": "textarea",
                                "title": "",
                                "title_i18n": {"en": "", "ja": ""},
                                "type": "string",
                            },
                            "licensetype": {
                                "currentEnum": [],
                                "format": "select",
                                "title": "",
                                "type": ["null", "string"],
                            },
                            "url": {
                                "format": "object",
                                "properties": {
                                    "label": {
                                        "format": "text",
                                        "title": "",
                                        "title_i18n": {"en": "Label", "ja": ""},
                                        "title_i18n_temp": {"en": "Label", "ja": ""},
                                        "type": "string",
                                    },
                                    "objectType": {
                                        "currentEnum": [
                                            "abstract",
                                            "summary",
                                            "fulltext",
                                            "thumbnail",
                                            "other",
                                        ],
                                        "enum": [
                                            None,
                                            "abstract",
                                            "summary",
                                            "fulltext",
                                            "thumbnail",
                                            "other",
                                        ],
                                        "format": "select",
                                        "title": "",
                                        "type": ["null", "string"],
                                    },
                                    "url": {
                                        "format": "text",
                                        "title": "URL",
                                        "title_i18n": {"en": "Text URL", "ja": "URL"},
                                        "title_i18n_temp": {
                                            "en": "Text URL",
                                            "ja": "URL",
                                        },
                                        "type": "string",
                                    },
                                },
                                "title": "URL",
                                "type": "object",
                            },
                            "version": {
                                "format": "text",
                                "title": "",
                                "title_i18n": {
                                    "en": "Version Information",
                                    "ja": "",
                                },
                                "title_i18n_temp": {
                                    "en": "Version Information",
                                    "ja": "",
                                },
                                "type": "string",
                            },
                        },
                        "type": "object",
                    },
                    "maxItems": 9999,
                    "minItems": 1,
                    "title": "File",
                    "type": "array",
                },
                "item_1617610673286": {
                    "items": {
                        "properties": {
                            "nameIdentifiers": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "nameIdentifier": {
                                            "format": "text",
                                            "title": "",
                                            "title_i18n": {
                                                "en": "Right Holder Identifier",
                                                "ja": "",
                                            },
                                            "title_i18n_temp": {
                                                "en": "Right Holder Identifier",
                                                "ja": "",
                                            },
                                            "type": "string",
                                        },
                                        "nameIdentifierScheme": {
                                            "currentEnum": [],
                                            "format": "select",
                                            "title": "Scheme",
                                            "type": ["null", "string"],
                                        },
                                        "nameIdentifierURI": {
                                            "format": "text",
                                            "title": "URI",
                                            "title_i18n": {
                                                "en": "Right Holder Identifier URI",
                                                "ja": "URI",
                                            },
                                            "title_i18n_temp": {
                                                "en": "Right Holder Identifier URI",
                                                "ja": "URI",
                                            },
                                            "type": "string",
                                        },
                                    },
                                    "type": "object",
                                },
                                "title": "",
                                "type": "array",
                            },
                            "rightHolderNames": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "rightHolderLanguage": {
                                            "currentEnum": [
                                                "ja",
                                                "ja-Kana",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "enum": [
                                                None,
                                                "ja",
                                                "ja-Kana",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "format": "select",
                                            "title": "",
                                            "type": ["null", "string"],
                                        },
                                        "rightHolderName": {
                                            "format": "text",
                                            "title": "",
                                            "title_i18n": {
                                                "en": "Right Holder Name",
                                                "ja": "",
                                            },
                                            "title_i18n_temp": {
                                                "en": "Right Holder Name",
                                                "ja": "",
                                            },
                                            "type": "string",
                                        },
                                    },
                                    "type": "object",
                                },
                                "title": "",
                                "type": "array",
                            },
                        },
                        "type": "object",
                    },
                    "maxItems": 9999,
                    "minItems": 1,
                    "title": "Rights Holder",
                    "type": "array",
                },
                "item_1617620223087": {
                    "items": {
                        "properties": {
                            "subitem_1565671149650": {
                                "currentEnum": [
                                    "ja",
                                    "ja-Kana",
                                    "en",
                                    "fr",
                                    "it",
                                    "de",
                                    "es",
                                    "zh-cn",
                                    "zh-tw",
                                    "ru",
                                    "la",
                                    "ms",
                                    "eo",
                                    "ar",
                                    "el",
                                    "ko",
                                ],
                                "enum": [
                                    None,
                                    "ja",
                                    "ja-Kana",
                                    "en",
                                    "fr",
                                    "it",
                                    "de",
                                    "es",
                                    "zh-cn",
                                    "zh-tw",
                                    "ru",
                                    "la",
                                    "ms",
                                    "eo",
                                    "ar",
                                    "el",
                                    "ko",
                                ],
                                "format": "select",
                                "title": "Language",
                                "type": ["null", "string"],
                            },
                            "subitem_1565671169640": {
                                "format": "text",
                                "title": "Banner Headline",
                                "title_i18n": {"en": "Banner Headline", "ja": ""},
                                "title_i18n_temp": {"en": "Banner Headline", "ja": ""},
                                "type": "string",
                            },
                            "subitem_1565671178623": {
                                "format": "text",
                                "title": "Subheading",
                                "title_i18n": {"en": "Subheading", "ja": ""},
                                "title_i18n_temp": {"en": "Subheading", "ja": ""},
                                "type": "string",
                            },
                        },
                        "type": "object",
                    },
                    "maxItems": 9999,
                    "minItems": 1,
                    "title": "Heading",
                    "type": "array",
                },
                "item_1617944105607": {
                    "items": {
                        "properties": {
                            "subitem_1551256015892": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "subitem_1551256027296": {
                                            "format": "text",
                                            "title": "Degree Grantor Name Identifier",
                                            "title_i18n": {
                                                "en": "Degree Grantor Name Identifier",
                                                "ja": "",
                                            },
                                            "title_i18n_temp": {
                                                "en": "Degree Grantor Name Identifier",
                                                "ja": "",
                                            },
                                            "type": "string",
                                        },
                                        "subitem_1551256029891": {
                                            "currentEnum": ["kakenhi"],
                                            "enum": [None, "kakenhi"],
                                            "format": "select",
                                            "title": "Degree Grantor Name Identifier Scheme",
                                            "type": ["null", "string"],
                                        },
                                    },
                                    "type": "object",
                                },
                                "title": "Degree Grantor Name Identifier",
                                "type": "array",
                            },
                            "subitem_1551256037922": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "subitem_1551256042287": {
                                            "format": "text",
                                            "title": "Degree Grantor Name",
                                            "title_i18n": {
                                                "en": "Degree Grantor Name",
                                                "ja": "",
                                            },
                                            "title_i18n_temp": {
                                                "en": "Degree Grantor Name",
                                                "ja": "",
                                            },
                                            "type": "string",
                                        },
                                        "subitem_1551256047619": {
                                            "currentEnum": [
                                                "ja",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "enum": [
                                                None,
                                                "ja",
                                                "en",
                                                "fr",
                                                "it",
                                                "de",
                                                "es",
                                                "zh-cn",
                                                "zh-tw",
                                                "ru",
                                                "la",
                                                "ms",
                                                "eo",
                                                "ar",
                                                "el",
                                                "ko",
                                            ],
                                            "format": "select",
                                            "title": "Language",
                                            "type": ["null", "string"],
                                        },
                                    },
                                    "type": "object",
                                },
                                "title": "Degree Grantor Name",
                                "type": "array",
                            },
                        },
                        "type": "object",
                    },
                    "maxItems": 9999,
                    "minItems": 1,
                    "title": "Degree Grantor",
                    "type": "array",
                },
                "item_1662046377046": {
                    "items": {
                        "properties": {
                            "subitem_thumbnail": {
                                "format": "array",
                                "items": {
                                    "format": "object",
                                    "properties": {
                                        "thumbnail_label": {
                                            "format": "text",
                                            "title": "",
                                            "title_i18n": {"en": "Label", "ja": ""},
                                            "title_i18n_temp": {"en": "Label", "ja": ""},
                                            "type": "string",
                                        },
                                        "thumbnail_url": {
                                            "format": "text",
                                            "title": "URI",
                                            "title_i18n": {"en": "URI", "ja": "URI"},
                                            "title_i18n_temp": {"en": "URI", "ja": "URI"},
                                            "type": "string",
                                        },
                                    },
                                    "type": "object",
                                },
                                "title": "URI",
                                "type": "array",
                            }
                        },
                        "type": "object",
                    },
                    "maxItems": 9999,
                    "minItems": 1,
                    "title": "",
                    "type": "array",
                },
                "pubdate": {"format": "datetime", "title": "PubDate", "type": "string"},
                "system_file": {
                    "format": "object",
                    "properties": {
                        "subitem_systemfile_datetime": {
                            "format": "array",
                            "items": {
                                "format": "object",
                                "properties": {
                                    "subitem_systemfile_datetime_date": {
                                        "format": "datetime",
                                        "title": "SYSTEMFILE DateTime Date",
                                        "type": "string",
                                    },
                                    "subitem_systemfile_datetime_type": {
                                        "enum": [
                                            "Accepted",
                                            "Available",
                                            "Collected",
                                            "Copyrighted",
                                            "Created",
                                            "Issued",
                                            "Submitted",
                                            "Updated",
                                            "Valid",
                                        ],
                                        "format": "select",
                                        "title": "SYSTEMFILE DateTime Type",
                                        "type": "string",
                                    },
                                },
                                "type": "object",
                            },
                            "title": "SYSTEMFILE DateTime",
                            "type": "array",
                        },
                        "subitem_systemfile_filename": {
                            "format": "array",
                            "items": {
                                "format": "object",
                                "properties": {
                                    "subitem_systemfile_filename_label": {
                                        "format": "text",
                                        "title": "SYSTEMFILE Filename Label",
                                        "type": "string",
                                    },
                                    "subitem_systemfile_filename_type": {
                                        "enum": [
                                            "Abstract",
                                            "Fulltext",
                                            "Summary",
                                            "Thumbnail",
                                            "Other",
                                        ],
                                        "format": "select",
                                        "title": "SYSTEMFILE Filename Type",
                                        "type": "string",
                                    },
                                    "subitem_systemfile_filename_uri": {
                                        "format": "text",
                                        "title": "SYSTEMFILE Filename URI",
                                        "type": "string",
                                    },
                                },
                                "type": "object",
                            },
                            "title": "SYSTEMFILE Filename",
                            "type": "array",
                        },
                        "subitem_systemfile_mimetype": {
                            "format": "text",
                            "title": "SYSTEMFILE MimeType",
                            "type": "string",
                        },
                        "subitem_systemfile_size": {
                            "format": "text",
                            "title": "SYSTEMFILE Size",
                            "type": "string",
                        },
                        "subitem_systemfile_version": {
                            "format": "text",
                            "title": "SYSTEMFILE Version",
                            "type": "string",
                        },
                    },
                    "system_prop": True,
                    "title": "File Information",
                    "type": "object",
                },
                "system_identifier_doi": {
                    "format": "object",
                    "properties": {
                        "subitem_systemidt_identifier": {
                            "format": "text",
                            "title": "SYSTEMIDT Identifier",
                            "type": "string",
                        },
                        "subitem_systemidt_identifier_type": {
                            "enum": ["DOI", "HDL", "URI"],
                            "format": "select",
                            "title": "SYSTEMIDT Identifier Type",
                            "type": "string",
                        },
                    },
                    "system_prop": True,
                    "title": "Persistent Identifier(DOI)",
                    "type": "object",
                },
                "system_identifier_hdl": {
                    "format": "object",
                    "properties": {
                        "subitem_systemidt_identifier": {
                            "format": "text",
                            "title": "SYSTEMIDT Identifier",
                            "type": "string",
                        },
                        "subitem_systemidt_identifier_type": {
                            "enum": ["DOI", "HDL", "URI"],
                            "format": "select",
                            "title": "SYSTEMIDT Identifier Type",
                            "type": "string",
                        },
                    },
                    "system_prop": True,
                    "title": "Persistent Identifier(HDL)",
                    "type": "object",
                },
                "system_identifier_uri": {
                    "format": "object",
                    "properties": {
                        "subitem_systemidt_identifier": {
                            "format": "text",
                            "title": "SYSTEMIDT Identifier",
                            "type": "string",
                        },
                        "subitem_systemidt_identifier_type": {
                            "enum": ["DOI", "HDL", "URI"],
                            "format": "select",
                            "title": "SYSTEMIDT Identifier Type",
                            "type": "string",
                        },
                    },
                    "system_prop": True,
                    "title": "Persistent Identifier(URI)",
                    "type": "object",
                },
            },
            "required": ["pubdate", "item_1617186331708", "item_1617258105262"],
            "type": "object",
        }
    
        url = url_for(
            "weko_items_ui.get_json_schema",
            item_type_id=1,
            activity_id="A-00000000-00000",
            _external=True,
        )
        res = client.get(url)
>       assert res.status_code == status_code
E       assert 400 == 200
E         +400
E         -200

tests/test_views.py:4868: AssertionError
------------------------------ Captured log setup ------------------------------
WARNING  flask.app:ext.py:255 JSONSCHEMAS_HOST is set to localhost
------------------------------ Captured log call -------------------------------
ERROR    flask.app:views.py:309 Unexpected error: <class 'AttributeError'>
ERROR    flask.app:views.py:309 Unexpected error: <class 'TypeError'>
___________________________ test_ranking_acl_nologin ___________________________

client = <FlaskClient <Flask 'testapp'>>, db_sessionlifetime = None

    def test_ranking_acl_nologin(client, db_sessionlifetime):
        url = url_for("weko_items_ui.ranking", _external=True)
        with patch("flask.templating._render", return_value=""):
>           res = client.get(url)

tests/test_views.py:20653: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.tox/c1/lib/python3.6/site-packages/werkzeug/test.py:1029: in get
    return self.open(*args, **kw)
.tox/c1/lib/python3.6/site-packages/flask/testing.py:196: in open
    follow_redirects=follow_redirects
.tox/c1/lib/python3.6/site-packages/werkzeug/test.py:993: in open
    response = self.run_wsgi_app(environ.copy(), buffered=buffered)
.tox/c1/lib/python3.6/site-packages/werkzeug/test.py:884: in run_wsgi_app
    rv = run_wsgi_app(self.application, environ, buffered=buffered)
.tox/c1/lib/python3.6/site-packages/werkzeug/test.py:1119: in run_wsgi_app
    app_rv = app(environ, start_response)
.tox/c1/lib/python3.6/site-packages/flask/app.py:2334: in __call__
    return self.wsgi_app(environ, start_response)
.tox/c1/lib/python3.6/site-packages/flask/app.py:2320: in wsgi_app
    response = self.handle_exception(e)
.tox/c1/lib/python3.6/site-packages/flask/app.py:1766: in handle_exception
    reraise(exc_type, exc_value, tb)
.tox/c1/lib/python3.6/site-packages/flask/_compat.py:36: in reraise
    raise value
.tox/c1/lib/python3.6/site-packages/flask/app.py:2317: in wsgi_app
    response = self.full_dispatch_request()
.tox/c1/lib/python3.6/site-packages/flask/app.py:1840: in full_dispatch_request
    rv = self.handle_user_exception(e)
.tox/c1/lib/python3.6/site-packages/flask/app.py:1743: in handle_user_exception
    reraise(exc_type, exc_value, tb)
.tox/c1/lib/python3.6/site-packages/flask/_compat.py:36: in reraise
    raise value
.tox/c1/lib/python3.6/site-packages/flask/app.py:1838: in full_dispatch_request
    rv = self.dispatch_request()
.tox/c1/lib/python3.6/site-packages/flask/app.py:1824: in dispatch_request
    return self.view_functions[rule.endpoint](**req.view_args)
weko_items_ui/views.py:1003: in ranking
    rankings = get_ranking(settings)
weko_items_ui/utils.py:2470: in get_ranking
    index_json = Indexes.get_browsing_tree_ignore_more()
../weko-index-tree/weko_index_tree/api.py:598: in get_browsing_tree_ignore_more
    datastore = redis_connection.connection(db=current_app.config['CACHE_REDIS_DB'], kv = True)
../weko-redis/weko_redis/redis.py:40: in connection
    raise ex
../weko-redis/weko_redis/redis.py:36: in connection
    store = self.redis_connection(db)
../weko-redis/weko_redis/redis.py:55: in redis_connection
    raise ex
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <weko_redis.redis.RedisConnection object at 0x7fde34f86860>, db = 0

    def redis_connection(self, db):
        store = None
        try:
>           redis_url = 'redis://' + current_app.config['CACHE_REDIS_HOST'] + ':' + current_app.config['REDIS_PORT'] + '/' + str(db)
E           TypeError: must be str, not NoneType

../weko-redis/weko_redis/redis.py:52: TypeError
------------------------------ Captured log setup ------------------------------
WARNING  flask.app:ext.py:255 JSONSCHEMAS_HOST is set to localhost
___________________ test_validate_bibtex_export_acl_nologin ____________________

app = <Flask 'testapp'>, client = <FlaskClient <Flask 'testapp'>>
users = [{'email': 'contributor@test.org', 'id': 2, 'obj': <User 2>}, {'email': 'repoadmin@test.org', 'id': 4, 'obj': <User 4>...eneraluser@test.org', 'id': 6, 'obj': <User 5>}, {'email': 'originalroleuser@test.org', 'id': 7, 'obj': <User 7>}, ...]
db_records = [(<PersistentIdentifier depid:1 / rec:d9d73630-a1b5-4cb8-b137-6b993f0d40d1 (R)>, <PersistentIdentifier recid:1 / rec:d...617258105262': {'resourceuri': 'http://purl.org/coar/resource_type/c_5794', 'resourcetype': 'conference paper'}}), ...]
db_oaischema = None

    def test_validate_bibtex_export_acl_nologin(
        app, client, users, db_records, db_oaischema
    ):
        url = url_for("weko_items_ui.validate_bibtex_export", _external=True)
        res = client.post(
>           url, data=json.dumps({"record_ids": [1]}), content_type="application/json"
        )

tests/test_views.py:20736: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.tox/c1/lib/python3.6/site-packages/werkzeug/test.py:1039: in post
    return self.open(*args, **kw)
.tox/c1/lib/python3.6/site-packages/flask/testing.py:196: in open
    follow_redirects=follow_redirects
.tox/c1/lib/python3.6/site-packages/werkzeug/test.py:993: in open
    response = self.run_wsgi_app(environ.copy(), buffered=buffered)
.tox/c1/lib/python3.6/site-packages/werkzeug/test.py:884: in run_wsgi_app
    rv = run_wsgi_app(self.application, environ, buffered=buffered)
.tox/c1/lib/python3.6/site-packages/werkzeug/test.py:1119: in run_wsgi_app
    app_rv = app(environ, start_response)
.tox/c1/lib/python3.6/site-packages/flask/app.py:2334: in __call__
    return self.wsgi_app(environ, start_response)
.tox/c1/lib/python3.6/site-packages/flask/app.py:2320: in wsgi_app
    response = self.handle_exception(e)
.tox/c1/lib/python3.6/site-packages/flask/app.py:1766: in handle_exception
    reraise(exc_type, exc_value, tb)
.tox/c1/lib/python3.6/site-packages/flask/_compat.py:36: in reraise
    raise value
.tox/c1/lib/python3.6/site-packages/flask/app.py:2317: in wsgi_app
    response = self.full_dispatch_request()
.tox/c1/lib/python3.6/site-packages/flask/app.py:1840: in full_dispatch_request
    rv = self.handle_user_exception(e)
.tox/c1/lib/python3.6/site-packages/flask/app.py:1743: in handle_user_exception
    reraise(exc_type, exc_value, tb)
.tox/c1/lib/python3.6/site-packages/flask/_compat.py:36: in reraise
    raise value
.tox/c1/lib/python3.6/site-packages/flask/app.py:1838: in full_dispatch_request
    rv = self.dispatch_request()
.tox/c1/lib/python3.6/site-packages/flask/app.py:1824: in dispatch_request
    return self.view_functions[rule.endpoint](**req.view_args)
weko_items_ui/views.py:1064: in validate_bibtex_export
    invalid_record_ids = validate_bibtex(record_ids)
weko_items_ui/utils.py:2383: in validate_bibtex
    from weko_schema_ui.serializers import WekoBibTexSerializer
../weko-schema-ui/weko_schema_ui/serializers/__init__.py:62: in <module>
    BibTexSerializer = WekoBibTexSerializer()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <weko_schema_ui.serializers.WekoBibTexSerializer.WekoBibTexSerializer object at 0x7fde358109b0>

    def __init__(self):
        """Init."""
        # Load namespace
        self.__ns = cache_schema('jpcoar_mapping').get('namespaces')
        self.__lst_identifier_type = ['doi', 'hdl', 'url']
        # JPCOAR elements
>       jp_jp = '{' + self.__ns['jpcoar'] + '}'
E       KeyError: 'jpcoar'

../weko-schema-ui/weko_schema_ui/serializers/WekoBibTexSerializer.py:133: KeyError
------------------------------ Captured log setup ------------------------------
WARNING  flask.app:ext.py:255 JSONSCHEMAS_HOST is set to localhost
=============================== warnings summary ===============================
../invenio-indexer/invenio_indexer/cli.py:108
  /code/modules/invenio-indexer/invenio_indexer/cli.py:108: DeprecationWarning: 'resultcallback' has been renamed to 'result_callback'. The old name will be removed in Click 8.1.
    @queue.resultcallback()

.tox/c1/lib/python3.6/site-packages/flask_oauthlib/contrib/cache.py:3
  /code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/flask_oauthlib/contrib/cache.py:3: DeprecationWarning: 'werkzeug.contrib.cache' is deprecated as of version 0.15 and will be removed in version 1.0. It has moved to https://github.com/pallets/cachelib.
    from werkzeug.contrib.cache import NullCache, SimpleCache, FileSystemCache

.tox/c1/lib/python3.6/site-packages/past/translation/__init__.py:35
  /code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/past/translation/__init__.py:35: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
    import imp

.tox/c1/src/pypdf2/PyPDF2/generic.py:348
  /code/modules/weko-items-ui/.tox/c1/src/pypdf2/PyPDF2/generic.py:348: DeprecationWarning: invalid escape sequence \c
    b_("c") : b_("\c"),

tests/test_api.py: 1 warning
tests/test_views.py: 154 warnings
tests/test_weko_items_ui.py: 1 warning
  /code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/flask/sessions.py:208: UserWarning: "test_server" is not a valid cookie domain, it must contain a ".". Add an entry to your hosts file, for example "test_server.localdomain", and use that instead.
    ' "{rv}.localdomain", and use that instead.'.format(rv=rv)

tests/test_views.py::test_index_acl[0-302]
tests/test_views.py::test_index_acl[1-302]
tests/test_views.py::test_index_acl[2-302]
tests/test_views.py::test_index_acl[3-302]
tests/test_views.py::test_index_acl[6-302]
tests/test_views.py::test_index[0-200]
  /code/modules/weko-items-ui/.tox/c1/lib/python3.6/site-packages/sqlalchemy/sql/compiler.py:763: SAWarning: Can't resolve label reference 'item_type.tag'; converting to text() (this warning may be suppressed after 10 occurrences)
    util.ellipses_string(element.element),

-- Docs: https://docs.pytest.org/en/stable/warnings.html

---------- coverage: platform linux, python 3.6.15-final-0 -----------
Name                           Stmts   Miss Branch BrPart  Cover
----------------------------------------------------------------
weko_items_ui/__init__.py          5      0      0      0   100%
weko_items_ui/api.py              50      0     20      0   100%
weko_items_ui/bundles.py          14      0      0      0   100%
weko_items_ui/config.py           65      0      0      0   100%
weko_items_ui/ext.py              24      0     12      0   100%
weko_items_ui/permissions.py       9      0      0      0   100%
weko_items_ui/proxies.py           5      0      2      0   100%
weko_items_ui/utils.py          1768    412    878    118    72%
weko_items_ui/version.py           2      0      0      0   100%
weko_items_ui/views.py           618    243    210     29    56%
----------------------------------------------------------------
TOTAL                           2560    655   1122    147    70%
Coverage XML written to file coverage.xml

=========================== short test summary info ============================
FAILED tests/test_utils.py::test_update_json_schema_by_activity_id - TypeErro...
FAILED tests/test_utils.py::test_update_schema_form_by_activity_id - TypeErro...
FAILED tests/test_utils.py::test_make_stats_file - AssertionError: assert ([[...
FAILED tests/test_utils.py::test_make_stats_file_issue33432 - AssertionError:...
FAILED tests/test_utils.py::test_write_bibtex_files - KeyError: 'jpcoar'
FAILED tests/test_utils.py::test_get_new_items_by_date - elasticsearch.except...
FAILED tests/test_utils.py::test_update_schema_remove_hidden_item - KeyError: 39
FAILED tests/test_utils.py::test_validate_bibtex - KeyError: 'jpcoar'
FAILED tests/test_utils.py::test_make_bibtex_data - AttributeError: 'NoneType...
FAILED tests/test_utils.py::test_get_ranking - TypeError: must be str, not No...
FAILED tests/test_utils.py::test_make_stats_file_with_permission - AssertionE...
FAILED tests/test_utils.py::test_make_stats_file_with_permission_issue33432
FAILED tests/test_views.py::test_get_json_schema[0-200] - assert 400 == 200
FAILED tests/test_views.py::test_ranking_acl_nologin - TypeError: must be str...
FAILED tests/test_views.py::test_validate_bibtex_export_acl_nologin - KeyErro...
ERROR tests/test_utils.py::test_get_list_file_by_record_id - elasticsearch.ex...
ERROR tests/test_utils.py::test_update_index_tree_for_record - elasticsearch....
===== 15 failed, 268 passed, 166 warnings, 2 errors in 2186.73s (0:36:26) ======
ERROR: InvocationError for command /code/modules/weko-items-ui/.tox/c1/bin/pytest --cov=weko_items_ui tests -v --cov-branch --cov-report=xml --cov-report=term --basetemp=/code/modules/weko-items-ui/.tox/c1/tmp (exited with code 1)
___________________________________ summary ____________________________________
ERROR:   c1: commands failed
